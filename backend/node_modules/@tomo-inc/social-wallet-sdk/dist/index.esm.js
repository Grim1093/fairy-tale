import e from"eventemitter3";import{v4 as t}from"uuid";import n from"axios";import s from"loglevel";import r from"json-bigint";import a from"@walletconnect/jsonrpc-http-connection";import{JsonRpcProvider as i}from"@walletconnect/jsonrpc-provider";import{recoverMessageAddress as o}from"viem";import{PublicKey as c,Connection as u,Transaction as l,SystemProgram as d}from"@solana/web3.js";import{Transaction as h}from"@mysten/sui/transactions";import p from"querystring";import*as m from"@tomo-inc/shared-type";import{WebWalletInvokeType as g}from"@tomo-inc/shared-type";import{getAssociatedTokenAddress as f,getAccount as y,TokenAccountNotFoundError as b,TokenInvalidAccountOwnerError as w,createAssociatedTokenAccountInstruction as v,createTransferInstruction as x,TOKEN_PROGRAM_ID as k,ASSOCIATED_TOKEN_PROGRAM_ID as I}from"@solana/spl-token";import E from"bn.js";function P(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const T="2.30.6";let S=({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?"#"+n:""}`:void 0,C="viem@"+T;class O extends Error{constructor(e,t={}){const n=t.cause instanceof O?t.cause.details:t.cause?.message?t.cause.message:t.details,s=t.cause instanceof O&&t.cause.docsPath||t.docsPath,r=S?.({...t,docsPath:s});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...r?["Docs: "+r]:[],...n?["Details: "+n]:[],...C?["Version: "+C]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=T}walk(e){return j(this,e)}}function j(e,t){return t?.(e)?e:e&&"object"==typeof e&&"cause"in e&&void 0!==e.cause?j(e.cause,t):t?null:e}class A extends O{constructor({max:e,min:t,signed:n,size:s,value:r}){super(`Number "${r}" is not in safe ${s?`${8*s}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class B extends O{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function U(e,{strict:t=!0}={}){return!!e&&("string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")))}function M(e){return U(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function $(e,{dir:t="left"}={}){let n="string"==typeof e?e.replace("0x",""):e,s=0;for(let e=0;n.length-1>e&&""+n["left"===t?e:n.length-e-1]=="0";e++)s++;return n="left"===t?n.slice(s):n.slice(0,n.length-s),"string"==typeof e?(1===n.length&&"right"===t&&(n+="0"),"0x"+(n.length%2==1?"0"+n:n)):n}class z extends O{constructor({offset:e,position:t,size:n}){super(`Slice ${"start"===t?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${n}).`,{name:"SliceOffsetOutOfBoundsError"})}}class D extends O{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function R(e,{dir:t,size:n=32}={}){return"string"==typeof e?function(e,{dir:t,size:n=32}={}){if(null===n)return e;const s=e.replace("0x","");if(s.length>2*n)throw new D({size:Math.ceil(s.length/2),targetSize:n,type:"hex"});return"0x"+s["right"===t?"padEnd":"padStart"](2*n,"0")}(e,{dir:t,size:n}):function(e,{dir:t,size:n=32}={}){if(null===n)return e;if(e.length>n)throw new D({size:e.length,targetSize:n,type:"bytes"});const s=new Uint8Array(n);for(let r=0;n>r;r++){const a="right"===t;s[a?r:n-r-1]=e[a?r:e.length-r-1]}return s}(e,{dir:t,size:n})}const F=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function L(e,t={}){return"number"==typeof e||"bigint"==typeof e?G(e,t):"string"==typeof e?function(e,t={}){const n=_.encode(e);return N(n,t)}(e,t):"boolean"==typeof e?function(e,t={}){const n="0x"+Number(e);if("number"==typeof t.size)return Z(n,{size:t.size}),R(n,{size:t.size});return n}(e,t):N(e,t)}function N(e,t={}){let n="";for(let t=0;e.length>t;t++)n+=F[e[t]];const s="0x"+n;return"number"==typeof t.size?(Z(s,{size:t.size}),R(s,{dir:"right",size:t.size})):s}function G(e,t={}){const{signed:n,size:s}=t,r=BigInt(e);let a;s?a=n?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(a=BigInt(Number.MAX_SAFE_INTEGER));const i="bigint"==typeof a&&n?-a-1n:0;if(a&&r>a||i>r){const t="bigint"==typeof e?"n":"";throw new A({max:a?`${a}${t}`:void 0,min:`${i}${t}`,signed:n,size:s,value:`${e}${t}`})}const o="0x"+(n&&0>r?(1n<<BigInt(8*s))+BigInt(r):r).toString(16);return s?R(o,{size:s}):o}const _=new TextEncoder;const V=new TextEncoder;function q(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t){const n=G(e,t);return K(n)}(e,t):"boolean"==typeof e?function(e,t={}){const n=new Uint8Array(1);if(n[0]=Number(e),"number"==typeof t.size)return Z(n,{size:t.size}),R(n,{size:t.size});return n}(e,t):U(e)?K(e,t):J(e,t)}const W={zero:48,nine:57,A:65,F:70,a:97,f:102};function H(e){return W.zero>e||e>W.nine?W.A>e||e>W.F?W.a>e||e>W.f?void 0:e-(W.a-10):e-(W.A-10):e-W.zero}function K(e,t={}){let n=e;t.size&&(Z(n,{size:t.size}),n=R(n,{dir:"right",size:t.size}));let s=n.slice(2);s.length%2&&(s="0"+s);const r=s.length/2,a=new Uint8Array(r);for(let e=0,t=0;r>e;e++){const n=H(s.charCodeAt(t++)),r=H(s.charCodeAt(t++));if(void 0===n||void 0===r)throw new O(`Invalid byte sequence ("${s[t-2]}${s[t-1]}" in "${s}").`);a[e]=16*n+r}return a}function J(e,t={}){const n=V.encode(e);return"number"==typeof t.size?(Z(n,{size:t.size}),R(n,{dir:"right",size:t.size})):n}function Z(e,{size:t}){if(M(e)>t)throw new B({givenSize:M(e),maxSize:t})}function X(e,t={}){const{signed:n}=t;t.size&&Z(e,{size:t.size});const s=BigInt(e);if(!n)return s;const r=(e.length-2)/2;return s>(1n<<8n*BigInt(r)-1n)-1n?s-BigInt("0x"+"f".padStart(2*r,"f"))-1n:s}function Y(e,t={}){return Number(X(e,t))}function Q(e,t){return({exclude:n,format:s})=>({exclude:n,format:e=>{const r=t(e);if(n)for(const e of n)delete r[e];return{...r,...s(e)}},type:e})}const ee={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function te(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?Y(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?Y(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?ee[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=e.authorizationList.map((e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)})))),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if("bigint"==typeof t.v){if(0n===t.v||27n===t.v)return 0;if(1n===t.v||28n===t.v)return 1;if(t.v>=35n)return t.v%2n==0n?1:0}})(),"legacy"===t.type&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),"eip2930"===t.type&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),"eip1559"===t.type&&delete t.maxFeePerBlobGas,t}const ne=Q("transaction",te);function se(e){const t=(e.transactions??[]).map((e=>"string"==typeof e?e:te(e)));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}const re=Q("block",se);function ae(e,{args:t,eventName:n}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...n?{args:t,eventName:n}:{}}}const ie={"0x0":"reverted","0x1":"success"};function oe(e){const t={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map((e=>ae(e))):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Y(e.transactionIndex):null,status:e.status?ie[e.status]:null,type:e.type?ee[e.type]||e.type:null};return e.blobGasPrice&&(t.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(t.blobGasUsed=BigInt(e.blobGasUsed)),t}const ce=Q("transactionReceipt",oe),ue={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function le(e){const t={};return void 0!==e.authorizationList&&(t.authorizationList=e.authorizationList.map((e=>({address:e.address,r:e.r?G(BigInt(e.r)):e.r,s:e.s?G(BigInt(e.s)):e.s,chainId:G(e.chainId),nonce:G(e.nonce),...void 0!==e.yParity?{yParity:G(e.yParity)}:{},...void 0!==e.v&&void 0===e.yParity?{v:G(e.v)}:{}})))),void 0!==e.accessList&&(t.accessList=e.accessList),void 0!==e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes),void 0!==e.blobs&&(t.blobs="string"!=typeof e.blobs[0]?e.blobs.map((e=>N(e))):e.blobs),void 0!==e.data&&(t.data=e.data),void 0!==e.from&&(t.from=e.from),void 0!==e.gas&&(t.gas=G(e.gas)),void 0!==e.gasPrice&&(t.gasPrice=G(e.gasPrice)),void 0!==e.maxFeePerBlobGas&&(t.maxFeePerBlobGas=G(e.maxFeePerBlobGas)),void 0!==e.maxFeePerGas&&(t.maxFeePerGas=G(e.maxFeePerGas)),void 0!==e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=G(e.maxPriorityFeePerGas)),void 0!==e.nonce&&(t.nonce=G(e.nonce)),void 0!==e.to&&(t.to=e.to),void 0!==e.type&&(t.type=ue[e.type]),void 0!==e.value&&(t.value=G(e.value)),t}const de=Q("transactionRequest",le);const he=2n**256n-1n,pe=50000n,me=2097120n,ge={block:re({format(e){const t=e.transactions?.map((e=>{if("string"==typeof e)return e;const t=ge.transaction?.format(e);return"0x71"===t.typeHex?t.type="eip712":"0xff"===t.typeHex&&(t.type="priority"),t}));return{l1BatchNumber:e.l1BatchNumber?X(e.l1BatchNumber):null,l1BatchTimestamp:e.l1BatchTimestamp?X(e.l1BatchTimestamp):null,transactions:t}}}),transaction:ne({format(e){const t={};return"0x71"===e.type?t.type="eip712":"0xff"===e.type&&(t.type="priority"),{...t,l1BatchNumber:e.l1BatchNumber?X(e.l1BatchNumber):null,l1BatchTxIndex:e.l1BatchTxIndex?X(e.l1BatchTxIndex):null}}}),transactionReceipt:ce({format:e=>({l1BatchNumber:e.l1BatchNumber?X(e.l1BatchNumber):null,l1BatchTxIndex:e.l1BatchTxIndex?X(e.l1BatchTxIndex):null,logs:e.logs.map((e=>({...ae(e),l1BatchNumber:e.l1BatchNumber?X(e.l1BatchNumber):null,transactionLogIndex:Y(e.transactionLogIndex),logType:e.logType}))),l2ToL1Logs:e.l2ToL1Logs.map((e=>({blockNumber:X(e.blockHash),blockHash:e.blockHash,l1BatchNumber:e.l1BatchNumber?X(e.l1BatchNumber):null,transactionIndex:X(e.transactionIndex),shardId:X(e.shardId),isService:e.isService,sender:e.sender,key:e.key,value:e.value,transactionHash:e.transactionHash,logIndex:X(e.logIndex)})))})}),transactionRequest:de({exclude:["customSignature","factoryDeps","gasPerPubdata","paymaster","paymasterInput"],format:e=>e.gasPerPubdata||e.paymaster&&e.paymasterInput||e.factoryDeps||e.customSignature?{eip712Meta:{...e.gasPerPubdata?{gasPerPubdata:L(e.gasPerPubdata)}:{gasPerPubdata:L(pe)},...e.paymaster&&e.paymasterInput?{paymasterParams:{paymaster:e.paymaster,paymasterInput:Array.from(K(e.paymasterInput))}}:{},...e.factoryDeps?{factoryDeps:e.factoryDeps.map((e=>Array.from(K(e))))}:{},...e.customSignature?{customSignature:Array.from(K(e.customSignature))}:{}},type:"0x71"}:{}})};function fe(e){return"0x"+e.reduce(((e,t)=>e+t.replace("0x","")),"")}class ye extends O{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class be extends O{constructor({length:e,position:t}){super(`Position \`${t}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class we extends O{constructor({count:e,limit:t}){super(`Recursive read limit of \`${t}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const ve={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:1/0,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new we({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(e){if(0>e||e>this.bytes.length-1)throw new be({length:this.bytes.length,position:e})},decrementPosition(e){if(0>e)throw new ye({offset:e});const t=this.position-e;this.assertPosition(t),this.position=t},getReadCount(e){return this.positionReadCount.get(e||this.position)||0},incrementPosition(e){if(0>e)throw new ye({offset:e});const t=this.position+e;this.assertPosition(t),this.position=t},inspectByte(e){const t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectBytes(e,t){const n=t??this.position;return this.assertPosition(n+e-1),this.bytes.subarray(n,n+e)},inspectUint8(e){const t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectUint16(e){const t=e??this.position;return this.assertPosition(t+1),this.dataView.getUint16(t)},inspectUint24(e){const t=e??this.position;return this.assertPosition(t+2),(this.dataView.getUint16(t)<<8)+this.dataView.getUint8(t+2)},inspectUint32(e){const t=e??this.position;return this.assertPosition(t+3),this.dataView.getUint32(t)},pushByte(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushBytes(e){this.assertPosition(this.position+e.length-1),this.bytes.set(e,this.position),this.position+=e.length},pushUint8(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushUint16(e){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,e),this.position+=2},pushUint24(e){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,e>>8),this.dataView.setUint8(this.position+2,255&e),this.position+=3},pushUint32(e){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,e),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const e=this.inspectByte();return this.position++,e},readBytes(e,t){this.assertReadLimit(),this._touch();const n=this.inspectBytes(e);return this.position+=t??e,n},readUint8(){this.assertReadLimit(),this._touch();const e=this.inspectUint8();return this.position+=1,e},readUint16(){this.assertReadLimit(),this._touch();const e=this.inspectUint16();return this.position+=2,e},readUint24(){this.assertReadLimit(),this._touch();const e=this.inspectUint24();return this.position+=3,e},readUint32(){this.assertReadLimit(),this._touch();const e=this.inspectUint32();return this.position+=4,e},get remaining(){return this.bytes.length-this.position},setPosition(e){const t=this.position;return this.assertPosition(e),this.position=e,()=>this.position=t},_touch(){if(this.recursiveReadLimit===1/0)return;const e=this.getReadCount();this.positionReadCount.set(this.position,e+1),e>0&&this.recursiveReadCount++}};function xe(e,{recursiveReadLimit:t=8192}={}){const n=Object.create(ve);return n.bytes=e,n.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=t,n}function ke(e,t="hex"){const n=Ie(e),s=xe(new Uint8Array(n.length));return n.encode(s),"hex"===t?N(s.bytes):s.bytes}function Ie(e){return Array.isArray(e)?function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=Ee(t);return{length:t>55?1+n+t:1+t,encode(s){t>55?(s.pushByte(247+n),1===n?s.pushUint8(t):2===n?s.pushUint16(t):3===n?s.pushUint24(t):s.pushUint32(t)):s.pushByte(192+t);for(const{encode:t}of e)t(s)}}}(e.map((e=>Ie(e)))):function(e){const t="string"==typeof e?K(e):e,n=Ee(t.length),s=1===t.length&&128>t[0]?1:t.length>55?1+n+t.length:1+t.length;return{length:s,encode(e){1===t.length&&128>t[0]?e.pushBytes(t):t.length>55?(e.pushByte(183+n),1===n?e.pushUint8(t.length):2===n?e.pushUint16(t.length):3===n?e.pushUint24(t.length):e.pushUint32(t.length),e.pushBytes(t)):(e.pushByte(128+t.length),e.pushBytes(t))}}}(e)}function Ee(e){if(256>e)return 1;if(65536>e)return 2;if(2**24>e)return 3;if(2**32>e)return 4;throw new O("Length is too large.")}const Pe={gwei:9,wei:18},Te={ether:-9,wei:9};function Se(e,t){let n=""+e;const s=n.startsWith("-");s&&(n=n.slice(1)),n=n.padStart(t,"0");let[r,a]=[n.slice(0,n.length-t),n.slice(n.length-t)];return a=a.replace(/(0+)$/,""),`${s?"-":""}${r||"0"}${a?"."+a:""}`}function Ce(e,t="wei"){return Se(e,Pe[t])}function Oe(e,t="wei"){return Se(e,Te[t])}function je(e){const t=Object.entries(e).map((([e,t])=>void 0===t||!1===t?null:[e,t])).filter(Boolean),n=t.reduce(((e,[t])=>Math.max(e,t.length)),0);return t.map((([e,t])=>`  ${(e+":").padEnd(n+1)}  ${t}`)).join("\n")}class Ae extends O{constructor(){super("Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.\nUse `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others.",{name:"FeeConflictError"})}}class Be extends O{constructor({v:e}){super(`Invalid \`v\` value "${e}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}}class Ue extends O{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",je(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class Me extends O{constructor({storageKey:e}){super(`Size for storage key "${e}" is invalid. Expected 32 bytes. Got ${Math.floor((e.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}}function $e(e){const{kzg:t}=e,n=e.to??("string"==typeof e.blobs[0]?"hex":"bytes"),s="string"==typeof e.blobs[0]?e.blobs.map((e=>K(e))):e.blobs,r=[];for(const e of s)r.push(Uint8Array.from(t.blobToKzgCommitment(e)));return"bytes"===n?r:r.map((e=>N(e)))}function ze(e){const{kzg:t}=e,n=e.to??("string"==typeof e.blobs[0]?"hex":"bytes"),s="string"==typeof e.blobs[0]?e.blobs.map((e=>K(e))):e.blobs,r="string"==typeof e.commitments[0]?e.commitments.map((e=>K(e))):e.commitments,a=[];for(let e=0;s.length>e;e++){a.push(Uint8Array.from(t.computeBlobKzgProof(s[e],r[e])))}return"bytes"===n?a:a.map((e=>N(e)))}
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function De(e){if(!Number.isSafeInteger(e)||0>e)throw Error("positive integer expected, got "+e)}function Re(e,...t){if(!((n=e)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function Fe(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function Le(e,t){Re(e);const n=t.outputLen;if(n>e.length)throw Error("digestInto() expects output buffer of length at least "+n)}function Ne(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Ge(...e){for(let t=0;e.length>t;t++)e[t].fill(0)}function _e(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ve(e,t){return e<<32-t|e>>>t}const qe=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function We(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const He=qe?e=>e:e=>We(e);const Ke=qe?e=>e:function(e){for(let t=0;e.length>t;t++)e[t]=We(e[t]);return e};function Je(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),Re(e),e}class Ze{}function Xe(e){const t=t=>e().update(Je(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ye(e){const t=(t,n)=>e(n).update(Je(t)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}function Qe(e,t,n){return e&t^e&n^t&n}class et extends Ze{constructor(e,t,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=_e(this.buffer)}update(e){Fe(this),Re(e=Je(e));const{view:t,buffer:n,blockLen:s}=this,r=e.length;for(let a=0;r>a;){const i=Math.min(s-this.pos,r-a);if(i!==s)n.set(e.subarray(a,a+i),this.pos),this.pos+=i,a+=i,this.pos===s&&(this.process(t,0),this.pos=0);else{const t=_e(e);for(;r-a>=s;a+=s)this.process(t,a)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Fe(this),Le(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:r}=this;let{pos:a}=this;t[a++]=128,Ge(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(n,0),a=0);for(let e=a;s>e;e++)t[e]=0;!function(e,t,n,s){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,s);const r=BigInt(32),a=BigInt(4294967295),i=Number(n>>r&a),o=Number(n&a),c=s?0:4;e.setUint32(t+(s?4:0),i,s),e.setUint32(t+c,o,s)}(n,s-8,BigInt(8*this.length),r),this.process(n,0);const i=_e(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,u=this.get();if(c>u.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;c>e;e++)i.setUint32(4*e,u[e],r)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:r,destroyed:a,pos:i}=this;return e.destroyed=a,e.finished=r,e.length=s,e.pos=i,s%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const tt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),nt=BigInt(2**32-1),st=BigInt(32);function rt(e,t=!1){return t?{h:Number(e&nt),l:Number(e>>st&nt)}:{h:0|Number(e>>st&nt),l:0|Number(e&nt)}}const at=(e,t,n)=>e>>>n|t<<32-n,it=(e,t,n)=>e<<32-n|t>>>n,ot=(e,t,n)=>e>>>n-32|t<<64-n;function ct(e,t,n,s){const r=(t>>>0)+(s>>>0);return{h:e+n+(r/2**32|0)|0,l:0|r}}const ut=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),lt=(e,t,n,s)=>t+n+s+(e/2**32|0)|0,dt=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ht=new Uint32Array(64);class pt extends et{constructor(e=32){super(64,e,8,!1),this.A=0|tt[0],this.B=0|tt[1],this.C=0|tt[2],this.D=0|tt[3],this.E=0|tt[4],this.F=0|tt[5],this.G=0|tt[6],this.H=0|tt[7]}get(){const{A:e,B:t,C:n,D:s,E:r,F:a,G:i,H:o}=this;return[e,t,n,s,r,a,i,o]}set(e,t,n,s,r,a,i,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|s,this.E=0|r,this.F=0|a,this.G=0|i,this.H=0|o}process(e,t){for(let n=0;16>n;n++,t+=4)ht[n]=e.getUint32(t,!1);for(let e=16;64>e;e++){const t=ht[e-15],n=ht[e-2],s=Ve(t,7)^Ve(t,18)^t>>>3,r=Ve(n,17)^Ve(n,19)^n>>>10;ht[e]=r+ht[e-7]+s+ht[e-16]|0}let{A:n,B:s,C:r,D:a,E:i,F:o,G:c,H:u}=this;for(let e=0;64>e;e++){const t=u+(Ve(i,6)^Ve(i,11)^Ve(i,25))+((l=i)&o^~l&c)+dt[e]+ht[e]|0,d=(Ve(n,2)^Ve(n,13)^Ve(n,22))+Qe(n,s,r)|0;u=c,c=o,o=i,i=a+t|0,a=r,r=s,s=n,n=t+d|0}var l;n=n+this.A|0,s=s+this.B|0,r=r+this.C|0,a=a+this.D|0,i=i+this.E|0,o=o+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,s,r,a,i,o,c,u)}roundClean(){Ge(ht)}destroy(){this.set(0,0,0,0,0,0,0,0),Ge(this.buffer)}}const mt=Xe((()=>new pt));function gt(e,t){const n=t||"hex",s=mt(U(e,{strict:!1})?q(e):e);return"bytes"===n?s:L(s)}function ft(e){const{commitment:t,version:n=1}=e,s=e.to??("string"==typeof t?"hex":"bytes"),r=gt(t,"bytes");return r.set([n],0),"bytes"===s?r:N(r)}const yt=4096,bt=131072,wt=761855;class vt extends O{constructor({maxSize:e,size:t}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${t} bytes`],name:"BlobSizeTooLargeError"})}}class xt extends O{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}class kt extends O{constructor({hash:e,size:t}){super(`Versioned hash "${e}" size is invalid.`,{metaMessages:["Expected: 32","Received: "+t],name:"InvalidVersionedHashSizeError"})}}class It extends O{constructor({hash:e,version:t}){super(`Versioned hash "${e}" version is invalid.`,{metaMessages:["Expected: 1","Received: "+t],name:"InvalidVersionedHashVersionError"})}}function Et(e){const{data:t,kzg:n,to:s}=e,r=e.blobs??function(e){const t=e.to??("string"==typeof e.data?"hex":"bytes"),n="string"==typeof e.data?K(e.data):e.data,s=M(n);if(!s)throw new xt;if(s>wt)throw new vt({maxSize:wt,size:s});const r=[];let a=!0,i=0;for(;a;){const e=xe(new Uint8Array(bt));let t=0;for(;yt>t;){const s=n.slice(i,i+31);if(e.pushByte(0),e.pushBytes(s),31>s.length){e.pushByte(128),a=!1;break}t++,i+=31}r.push(e)}return r.map("bytes"===t?e=>e.bytes:e=>N(e.bytes))}({data:t,to:s}),a=e.commitments??$e({blobs:r,kzg:n,to:s}),i=e.proofs??ze({blobs:r,commitments:a,kzg:n,to:s}),o=[];for(let e=0;r.length>e;e++)o.push({blob:r[e],commitment:a[e],proof:i[e]});return o}class Pt extends O{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class Tt extends O{constructor({chainId:e}){super("number"==typeof e?`Chain ID "${e}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}class St extends O{constructor({cause:e,message:t}={}){const n=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${n?"with reason: "+n:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(St,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(St,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Ct extends O{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${Oe(t)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(Ct,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Ot extends O{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?" = "+Oe(t):""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(Ot,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class jt extends O{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(jt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class At extends O{constructor({cause:e,nonce:t}={}){super([`Nonce provided for the transaction ${t?`(${t}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join("\n"),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(At,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class Bt extends O{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(Bt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class Ut extends O{constructor({cause:e}={}){super("The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account.",{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(Ut,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Mt extends O{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Mt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class $t extends O{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty($t,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class zt extends O{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(zt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class Dt extends O{constructor({cause:e,maxPriorityFeePerGas:t,maxFeePerGas:n}={}){super(`The provided tip (\`maxPriorityFeePerGas\`${t?` = ${Oe(t)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${n?` = ${Oe(n)} gwei`:""}).`,{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(Dt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class Rt extends O{constructor({cause:e}){super("An error occurred while executing: "+e?.shortMessage,{cause:e,name:"UnknownNodeError"})}}class Ft extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}const Lt=BigInt(0),Nt=BigInt(1),Gt=BigInt(2),_t=BigInt(7),Vt=BigInt(256),qt=BigInt(113),Wt=[],Ht=[],Kt=[];for(let e=0,t=Nt,n=1,s=0;24>e;e++){[n,s]=[s,(2*n+3*s)%5],Wt.push(2*(5*s+n)),Ht.push((e+1)*(e+2)/2%64);let r=Lt;for(let e=0;7>e;e++)t=(t<<Nt^(t>>_t)*qt)%Vt,t&Gt&&(r^=Nt<<(Nt<<BigInt(e))-Nt);Kt.push(r)}const Jt=function(e,t=!1){const n=e.length;let s=new Uint32Array(n),r=new Uint32Array(n);for(let a=0;n>a;a++){const{h:n,l:i}=rt(e[a],t);[s[a],r[a]]=[n,i]}return[s,r]}(Kt,!0),Zt=Jt[0],Xt=Jt[1],Yt=(e,t,n)=>n>32?((e,t,n)=>t<<n-32|e>>>64-n)(e,t,n):((e,t,n)=>e<<n|t>>>32-n)(e,t,n),Qt=(e,t,n)=>n>32?((e,t,n)=>e<<n-32|t>>>64-n)(e,t,n):((e,t,n)=>t<<n|e>>>32-n)(e,t,n);class en extends Ze{constructor(e,t,n,s=!1,r=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=r,De(n),0>=e||e>=200)throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Ne(this.state)}clone(){return this._cloneInto()}keccak(){Ke(this.state32),function(e,t=24){const n=new Uint32Array(10);for(let s=24-t;24>s;s++){for(let t=0;10>t;t++)n[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;10>t;t+=2){const s=(t+8)%10,r=(t+2)%10,a=n[r],i=n[r+1],o=Yt(a,i,1)^n[s],c=Qt(a,i,1)^n[s+1];for(let n=0;50>n;n+=10)e[t+n]^=o,e[t+n+1]^=c}let t=e[2],r=e[3];for(let n=0;24>n;n++){const s=Ht[n],a=Yt(t,r,s),i=Qt(t,r,s),o=Wt[n];t=e[o],r=e[o+1],e[o]=a,e[o+1]=i}for(let t=0;50>t;t+=10){for(let s=0;10>s;s++)n[s]=e[t+s];for(let s=0;10>s;s++)e[t+s]^=~n[(s+2)%10]&n[(s+4)%10]}e[0]^=Zt[s],e[1]^=Xt[s]}Ge(n)}(this.state32,this.rounds),Ke(this.state32),this.posOut=0,this.pos=0}update(e){Fe(this),Re(e=Je(e));const{blockLen:t,state:n}=this,s=e.length;for(let r=0;s>r;){const a=Math.min(t-this.pos,s-r);for(let t=0;a>t;t++)n[this.pos++]^=e[r++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,128&t&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Fe(this,!1),Re(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,r=e.length;r>s;){n>this.posOut||this.keccak();const a=Math.min(n-this.posOut,r-s);e.set(t.subarray(this.posOut,this.posOut+a),s),this.posOut+=a,s+=a}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return De(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Le(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Ge(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:r,enableXOF:a}=this;return e||(e=new en(t,n,s,a,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=s,e.enableXOF=a,e.destroyed=this.destroyed,e}}const tn=(()=>{return e=1,t=136,n=32,Xe((()=>new en(t,e,n)));var e,t,n})();const nn=new Ft(8192);function sn(e,t){if(nn.has(`${e}.${t}`))return nn.get(`${e}.${t}`);const n=e.substring(2).toLowerCase(),s=(r=J(n),tn(U(r,{strict:!1})?q(r):r));var r;const a=n.split("");for(let e=0;40>e;e+=2)s[e>>1]>>4>=8&&a[e]&&(a[e]=a[e].toUpperCase()),(15&s[e>>1])>=8&&a[e+1]&&(a[e+1]=a[e+1].toUpperCase());const i="0x"+a.join("");return nn.set(`${e}.${t}`,i),i}const rn=/^0x[a-fA-F0-9]{40}$/,an=new Ft(8192);function on(e,t){const{strict:n=!0}=t??{},s=`${e}.${n}`;if(an.has(s))return an.get(s);const r=!(!rn.test(e)||e.toLowerCase()!==e&&n&&sn(e)!==e);return an.set(s,r),r}function cn(e,t,n,{strict:s}={}){return U(e,{strict:!1})?function(e,t,n,{strict:s}={}){const r="0x"+e.replace("0x","").slice(2*t,2*n);s&&un(r,t,n);return r}(e,t,n,{strict:s}):function(e,t,n,{strict:s}={}){const r=e.slice(t,n);s&&un(r,t,n);return r}(e,t,n,{strict:s})}function un(e,t,n){if(M(e)!==n-t)throw new z({offset:n,position:"end",size:M(e)})}function ln(e){const{chainId:t,maxPriorityFeePerGas:n,maxFeePerGas:s,to:r}=e;if(0>=t)throw new Tt({chainId:t});if(r&&!on(r))throw new Pt({address:r});if(s&&s>he)throw new Ct({maxFeePerGas:s});if(n&&s&&n>s)throw new Dt({maxFeePerGas:s,maxPriorityFeePerGas:n})}function dn(e){if(!e||0===e.length)return[];const t=[];for(let n=0;e.length>n;n++){const{address:s,storageKeys:r}=e[n];for(let e=0;r.length>e;e++)if(r[e].length-2!=64)throw new Me({storageKey:r[e]});if(!on(s,{strict:!1}))throw new Pt({address:s});t.push([s,r])}return t}function hn(e,t){const n=function(e){if(e.type)return e.type;if(void 0!==e.authorizationList)return"eip7702";if(void 0!==e.blobs||void 0!==e.blobVersionedHashes||void 0!==e.maxFeePerBlobGas||void 0!==e.sidecars)return"eip4844";if(void 0!==e.maxFeePerGas||void 0!==e.maxPriorityFeePerGas)return"eip1559";if(void 0!==e.gasPrice)return void 0!==e.accessList?"eip2930":"legacy";throw new Ue({transaction:e})}(e);return"eip1559"===n?function(e,t){const{chainId:n,gas:s,nonce:r,to:a,value:i,maxFeePerGas:o,maxPriorityFeePerGas:c,accessList:u,data:l}=e;ln(e);const d=dn(u),h=[L(n),r?L(r):"0x",c?L(c):"0x",o?L(o):"0x",s?L(s):"0x",a??"0x",i?L(i):"0x",l??"0x",d,...pn(e,t)];return fe(["0x02",ke(h)])}(e,t):"eip2930"===n?function(e,t){const{chainId:n,gas:s,data:r,nonce:a,to:i,value:o,accessList:c,gasPrice:u}=e;!function(e){const{chainId:t,maxPriorityFeePerGas:n,gasPrice:s,maxFeePerGas:r,to:a}=e;if(0>=t)throw new Tt({chainId:t});if(a&&!on(a))throw new Pt({address:a});if(n||r)throw new O("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(s&&s>he)throw new Ct({maxFeePerGas:s})}(e);const l=dn(c),d=[L(n),a?L(a):"0x",u?L(u):"0x",s?L(s):"0x",i??"0x",o?L(o):"0x",r??"0x",l,...pn(e,t)];return fe(["0x01",ke(d)])}(e,t):"eip4844"===n?function(e,t){const{chainId:n,gas:s,nonce:r,to:a,value:i,maxFeePerBlobGas:o,maxFeePerGas:c,maxPriorityFeePerGas:u,accessList:l,data:d}=e;!function(e){const{blobVersionedHashes:t}=e;if(t){if(0===t.length)throw new xt;for(const e of t){const t=M(e),n=Y(cn(e,0,1));if(32!==t)throw new kt({hash:e,size:t});if(1!==n)throw new It({hash:e,version:n})}}ln(e)}(e);let h=e.blobVersionedHashes,p=e.sidecars;if(e.blobs&&(void 0===h||void 0===p)){const t="string"==typeof e.blobs[0]?e.blobs:e.blobs.map((e=>N(e))),n=e.kzg,s=$e({blobs:t,kzg:n});if(void 0===h&&(h=function(e){const{commitments:t,version:n}=e,s=e.to??("string"==typeof t[0]?"hex":"bytes"),r=[];for(const e of t)r.push(ft({commitment:e,to:s,version:n}));return r}({commitments:s})),void 0===p){p=Et({blobs:t,commitments:s,proofs:ze({blobs:t,commitments:s,kzg:n})})}}const m=dn(l),g=[L(n),r?L(r):"0x",u?L(u):"0x",c?L(c):"0x",s?L(s):"0x",a??"0x",i?L(i):"0x",d??"0x",m,o?L(o):"0x",h??[],...pn(e,t)],f=[],y=[],b=[];if(p)for(let e=0;p.length>e;e++){const{blob:t,commitment:n,proof:s}=p[e];f.push(t),y.push(n),b.push(s)}return fe(["0x03",ke(p?[g,f,y,b]:g)])}(e,t):"eip7702"===n?function(e,t){const{authorizationList:n,chainId:s,gas:r,nonce:a,to:i,value:o,maxFeePerGas:c,maxPriorityFeePerGas:u,accessList:l,data:d}=e;!function(e){const{authorizationList:t}=e;if(t)for(const e of t){const{chainId:t}=e,n=e.address;if(!on(n))throw new Pt({address:n});if(0>t)throw new Tt({chainId:t})}ln(e)}(e);const h=dn(l),p=function(e){if(!e||0===e.length)return[];const t=[];for(const n of e){const{chainId:e,nonce:s,...r}=n,a=n.address;t.push([e?L(e):"0x",a,s?L(s):"0x",...pn({},r)])}return t}(n);return fe(["0x04",ke([L(s),a?L(a):"0x",u?L(u):"0x",c?L(c):"0x",r?L(r):"0x",i??"0x",o?L(o):"0x",d??"0x",h,p,...pn(e,t)])])}(e,t):function(e,t){const{chainId:n=0,gas:s,data:r,nonce:a,to:i,value:o,gasPrice:c}=e;!function(e){const{chainId:t,maxPriorityFeePerGas:n,gasPrice:s,maxFeePerGas:r,to:a}=e;if(a&&!on(a))throw new Pt({address:a});if(void 0!==t&&0>=t)throw new Tt({chainId:t});if(n||r)throw new O("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(s&&s>he)throw new Ct({maxFeePerGas:s})}(e);let u=[a?L(a):"0x",c?L(c):"0x",s?L(s):"0x",i??"0x",o?L(o):"0x",r??"0x"];if(t){const e=(()=>{if(t.v>=35n){return(t.v-35n)/2n>0?t.v:27n+(35n===t.v?0n:1n)}if(n>0)return BigInt(2*n)+BigInt(35n+t.v-27n);const e=27n+(27n===t.v?0n:1n);if(t.v!==e)throw new Be({v:t.v});return e})(),s=$(t.r),r=$(t.s);u=[...u,L(e),"0x00"===s?"0x":s,"0x00"===r?"0x":r]}else n>0&&(u=[...u,L(n),"0x","0x"]);return ke(u)}(e,t)}function pn(e,t){const n=t??e,{v:s,yParity:r}=n;if(void 0===n.r)return[];if(void 0===n.s)return[];if(void 0===s&&void 0===r)return[];const a=$(n.r),i=$(n.s);return["number"==typeof r?r?L(1):"0x":0n===s?"0x":1n===s?L(1):27n===s?"0x":L(1),"0x00"===a?"0x":a,"0x00"===i?"0x":i]}class mn extends O{constructor(){super('Transaction is not an EIP712 transaction.\n\nTransaction must:\n  - include `type: "eip712"`\n  - include one of the following: `customSignature`, `paymaster`, `paymasterInput`, `gasPerPubdata`, `factoryDeps`',{name:"InvalidEip712TransactionError"})}}function gn(e){return"eip712"===e.type||!!("customSignature"in e&&e.customSignature||"paymaster"in e&&e.paymaster||"paymasterInput"in e&&e.paymasterInput||"gasPerPubdata"in e&&"bigint"==typeof e.gasPerPubdata||"factoryDeps"in e&&e.factoryDeps)}function fn(e){const{chainId:t,to:n,from:s,paymaster:r,paymasterInput:a}=e;if(!gn(e))throw new mn;if(!t||0>=t)throw new Tt({chainId:t});if(n&&!on(n))throw new Pt({address:n});if(s&&!on(s))throw new Pt({address:s});if(r&&!on(r))throw new Pt({address:r});if(r&&!a)throw new O("`paymasterInput` must be provided when `paymaster` is defined");if(!r&&a)throw new O("`paymaster` must be provided when `paymasterInput` is defined")}const yn={transaction:function(e,t){return gn(e)?function(e){const{chainId:t,gas:n,nonce:s,to:r,from:a,value:i,maxFeePerGas:o,maxPriorityFeePerGas:c,customSignature:u,factoryDeps:l,paymaster:d,paymasterInput:h,gasPerPubdata:p,data:m}=e;fn(e);return fe(["0x71",ke([s?L(s):"0x",c?L(c):"0x",o?L(o):"0x",n?L(n):"0x",r??"0x",i?L(i):"0x",m??"0x",L(t),L(""),L(""),L(t),a??"0x",L(p||pe),l??[],u??"0x",d&&h?[d,h]:[]])])}(e):hn(e,t)}};class bn extends O{constructor({givenLength:e,maxBytecodeSize:t}){super(`Bytecode cannot be longer than ${t} bytes. Given length: ${e}`,{name:"BytecodeLengthExceedsMaxSizeError"})}}class wn extends O{constructor({givenLengthInWords:e}){super("Bytecode length in 32-byte words must be odd. Given length in words: "+e,{name:"BytecodeLengthInWordsMustBeOddError"})}}class vn extends O{constructor({givenLength:e}){super("The bytecode length in bytes must be divisible by 32. Given length: "+e,{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}const xn={formatters:ge,serializers:yn,custom:{getEip712Domain:e=>{fn(e);const t=function(e){const{gas:t,nonce:n,to:s,from:r,value:a,maxFeePerGas:i,maxPriorityFeePerGas:o,factoryDeps:c,paymaster:u,paymasterInput:l,gasPerPubdata:d,data:h}=e;return{txType:113n,from:BigInt(r),to:s?BigInt(s):0n,gasLimit:t??0n,gasPerPubdataByteLimit:d??pe,maxFeePerGas:i??0n,maxPriorityFeePerGas:o??0n,paymaster:u?BigInt(u):0n,nonce:n?BigInt(n):0n,value:a??0n,data:h??"0x",factoryDeps:c?.map((e=>L(function(e){const t=q(e);if(t.length%32!=0)throw new vn({givenLength:t.length});if(t.length>me)throw new bn({givenLength:t.length,maxBytecodeSize:me});const n=q(gt(t)),s=t.length/32;if(s%2==0)throw new wn({givenLengthInWords:s});const r=R(q(s),{size:2}),a=new Uint8Array([1,0]);return n.set(a,0),n.set(r,2),n}(e))))??[],paymasterInput:l||"0x"}}(e);return{domain:{name:"zkSync",version:"2",chainId:e.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:t}}}};const kn={contracts:{gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},formatters:{block:re({format(e){const t=e.transactions?.map((e=>{if("string"==typeof e)return e;const t=te(e);return"0x7e"===t.typeHex&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?X(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}));return{transactions:t,stateRoot:e.stateRoot}}}),transaction:ne({format(e){const t={};return"0x7e"===e.type&&(t.isSystemTx=e.isSystemTx,t.mint=e.mint?X(e.mint):void 0,t.sourceHash=e.sourceHash,t.type="deposit"),t}}),transactionReceipt:ce({format:e=>({l1GasPrice:e.l1GasPrice?X(e.l1GasPrice):null,l1GasUsed:e.l1GasUsed?X(e.l1GasUsed):null,l1Fee:e.l1Fee?X(e.l1Fee):null,l1FeeScalar:e.l1FeeScalar?Number(e.l1FeeScalar):null})})},serializers:{transaction:function(e,t){return function(e){return"deposit"===e.type||void 0!==e.sourceHash}(e)?function(e){!function(e){const{from:t,to:n}=e;if(t&&!on(t))throw new Pt({address:t});if(n&&!on(n))throw new Pt({address:n})}(e);const{sourceHash:t,data:n,from:s,gas:r,isSystemTx:a,mint:i,to:o,value:c}=e;return fe(["0x7e",ke([t,s,o??"0x",i?L(i):"0x",c?L(c):"0x",r?L(r):"0x",a?"0x1":"0x",n??"0x"])])}(e):hn(e,t)}}},In=P({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),En=P({id:1313161554,name:"Aurora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://mainnet.aurora.dev"]}},blockExplorers:{default:{name:"Aurorascan",url:"https://aurorascan.dev",apiUrl:"https://aurorascan.dev/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:62907816}}}),Pn=P({id:43114,name:"Avalanche",nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:11907934}}}),Tn=1,Sn=P({...kn,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...kn.contracts,disputeGameFactory:{[Tn]:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{[Tn]:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{[Tn]:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:17482143}},l1StandardBridge:{[Tn]:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:17482143}}},sourceId:1}),Cn=11155111,On=P({...kn,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...kn.contracts,disputeGameFactory:{[Cn]:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{[Cn]:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{[Cn]:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{[Cn]:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:Cn}),jn=P({id:80084,name:"Berachain bArtio",nativeCurrency:{decimals:18,name:"BERA Token",symbol:"BERA"},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:109269},ensRegistry:{address:"0xB0eef18971290b333450586D33dcA6cE122651D2",blockCreated:7736794},ensUniversalResolver:{address:"0x41692Ef1EA0C79E6b73077E4A67572D2BDbD7057",blockCreated:7736795}},ensTlds:[".bera"],rpcUrls:{default:{http:["https://bartio.rpc.berachain.com"]}},blockExplorers:{default:{name:"Berachain bArtio Beratrail",url:"https://bartio.beratrail.io"}},testnet:!0}),An=P({id:11501,name:"BEVM Mainnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:18},rpcUrls:{default:{http:["https://rpc-mainnet-1.bevm.io"]}},blockExplorers:{default:{name:"Bevmscan",url:"https://scan-mainnet.bevm.io",apiUrl:"https://scan-mainnet-api.bevm.io/api"}}}),Bn=P({...kn,id:81457,name:"Blast",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.blast.io"]}},blockExplorers:{default:{name:"Blastscan",url:"https://blastscan.io",apiUrl:"https://api.blastscan.io/api"}},contracts:{...kn.contracts,multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:212929}},sourceId:1}),Un=1,Mn=P({...kn,id:60808,name:"BOB",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.gobob.xyz"],webSocket:["wss://rpc.gobob.xyz"]}},blockExplorers:{default:{name:"BOB Explorer",url:"https://explorer.gobob.xyz"}},contracts:{...kn.contracts,multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:23131},l2OutputOracle:{[Un]:{address:"0xdDa53E23f8a32640b04D7256e651C1db98dB11C1",blockCreated:4462615}},portal:{[Un]:{address:"0x8AdeE124447435fE03e3CD24dF3f4cAE32E65a3E",blockCreated:4462615}}},sourceId:1}),$n=P({id:56,name:"BNB Smart Chain",nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}}),zn=P({id:97,name:"Binance Smart Chain Testnet",nativeCurrency:{decimals:18,name:"BNB",symbol:"tBNB"},rpcUrls:{default:{http:["https://data-seed-prebsc-1-s1.bnbchain.org:8545"]}},blockExplorers:{default:{name:"BscScan",url:"https://testnet.bscscan.com",apiUrl:"https://api-testnet.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:17422483}},testnet:!0}),Dn=P({id:88888,name:"Chiliz Chain",network:"chiliz-chain",nativeCurrency:{decimals:18,name:"CHZ",symbol:"CHZ"},rpcUrls:{default:{http:["https://rpc.chiliz.com"]}},blockExplorers:{default:{name:"Chiliz Explorer",url:"https://scan.chiliz.com",apiUrl:"https://scan.chiliz.com/api"}}}),Rn=P({id:25,name:"Cronos Mainnet",nativeCurrency:{decimals:18,name:"Cronos",symbol:"CRO"},rpcUrls:{default:{http:["https://evm.cronos.org"]}},blockExplorers:{default:{name:"Cronos Explorer",url:"https://explorer.cronos.org",apiUrl:"https://explorer-api.cronos.org/mainnet/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:1963112}}}),Fn=P({id:250,name:"Fantom",nativeCurrency:{decimals:18,name:"Fantom",symbol:"FTM"},rpcUrls:{default:{http:["https://250.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"FTMScan",url:"https://ftmscan.com",apiUrl:"https://api.ftmscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:33001987}}}),Ln=P({id:100,name:"Gnosis",nativeCurrency:{decimals:18,name:"xDAI",symbol:"XDAI"},rpcUrls:{default:{http:["https://rpc.gnosischain.com"],webSocket:["wss://rpc.gnosischain.com/wss"]}},blockExplorers:{default:{name:"Gnosisscan",url:"https://gnosisscan.io",apiUrl:"https://api.gnosisscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:21022491}}});function Nn(e){return"string"==typeof e?{address:e,type:"json-rpc"}:e}class Gn extends O{constructor({docsPath:e}={}){super("Could not find an Account to execute with this Action.\nPlease provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client.",{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}function _n(e){return e.reduce(((e,{slot:t,value:n})=>`${e}        ${t}: ${n}\n`),"")}class Vn extends O{constructor(e,{account:t,docsPath:n,chain:s,data:r,gas:a,gasPrice:i,maxFeePerGas:o,maxPriorityFeePerGas:c,nonce:u,to:l,value:d,stateOverride:h}){const p=t?Nn(t):void 0;let m=je({from:p?.address,to:l,value:void 0!==d&&`${Ce(d)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:r,gas:a,gasPrice:void 0!==i&&Oe(i)+" gwei",maxFeePerGas:void 0!==o&&Oe(o)+" gwei",maxPriorityFeePerGas:void 0!==c&&Oe(c)+" gwei",nonce:u});h&&(m+="\n"+function(e){return e.reduce(((e,{address:t,...n})=>{let s=`${e}    ${t}:\n`;return n.nonce&&(s+=`      nonce: ${n.nonce}\n`),n.balance&&(s+=`      balance: ${n.balance}\n`),n.code&&(s+=`      code: ${n.code}\n`),n.state&&(s+="      state:\n",s+=_n(n.state)),n.stateDiff&&(s+="      stateDiff:\n",s+=_n(n.stateDiff)),s}),"  State Override:\n").slice(0,-1)}(h)),super(e.shortMessage,{cause:e,docsPath:n,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",m].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}function qn(e,{docsPath:t,...n}){const s=(()=>{const t=function(e,t){const n=(e.details||"").toLowerCase(),s=e instanceof O?e.walk((e=>e?.code===St.code)):e;return s instanceof O?new St({cause:e,message:s.details}):St.nodeMessage.test(n)?new St({cause:e,message:e.details}):Ct.nodeMessage.test(n)?new Ct({cause:e,maxFeePerGas:t?.maxFeePerGas}):Ot.nodeMessage.test(n)?new Ot({cause:e,maxFeePerGas:t?.maxFeePerGas}):jt.nodeMessage.test(n)?new jt({cause:e,nonce:t?.nonce}):At.nodeMessage.test(n)?new At({cause:e,nonce:t?.nonce}):Bt.nodeMessage.test(n)?new Bt({cause:e,nonce:t?.nonce}):Ut.nodeMessage.test(n)?new Ut({cause:e}):Mt.nodeMessage.test(n)?new Mt({cause:e,gas:t?.gas}):$t.nodeMessage.test(n)?new $t({cause:e,gas:t?.gas}):zt.nodeMessage.test(n)?new zt({cause:e}):Dt.nodeMessage.test(n)?new Dt({cause:e,maxFeePerGas:t?.maxFeePerGas,maxPriorityFeePerGas:t?.maxPriorityFeePerGas}):new Rt({cause:e})}(e,n);return t instanceof Rt?e:t})();return new Vn(s,{docsPath:t,...n})}function Wn(e,{format:t}){if(!t)return{};const n={};return function t(s){const r=Object.keys(s);for(const a of r)a in e&&(n[a]=e[a]),s[a]&&"object"==typeof s[a]&&!Array.isArray(s[a])&&t(s[a])}(t(e||{})),n}async function Hn(e,t){const{account:n=e.account}=t;if(!n)throw new Gn;const s=Nn(n);try{const{accessList:n,blockNumber:r,blockTag:a,data:i,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:l,nonce:d,to:h,value:p,...m}=t,g=("bigint"==typeof r?G(r):void 0)||a;!function(e){const{account:t,gasPrice:n,maxFeePerGas:s,maxPriorityFeePerGas:r,to:a}=e,i=t?Nn(t):void 0;if(i&&!on(i.address))throw new Pt({address:i.address});if(a&&!on(a))throw new Pt({address:a});if(void 0!==n&&(void 0!==s||void 0!==r))throw new Ae;if(s&&s>he)throw new Ct({maxFeePerGas:s});if(r&&s&&r>s)throw new Dt({maxFeePerGas:s,maxPriorityFeePerGas:r})}(t);const f=e.chain?.formatters?.transactionRequest?.format,y=(f||le)({...Wn(m,{format:f}),from:s?.address,accessList:n,data:i,gas:o,gasPrice:c,maxFeePerGas:u,maxPriorityFeePerGas:l,nonce:d,to:h,value:p}),{baseFeePerGas:b,gasLimit:w,priorityFeePerGas:v}=await e.request({method:"linea_estimateGas",params:g?[y,g]:[y]});return{baseFeePerGas:BigInt(b),gasLimit:BigInt(w),priorityFeePerGas:BigInt(v)}}catch(n){throw qn(n,{...t,account:s,chain:e.chain})}}async function Kn({client:e,multiply:t,request:n,type:s}){try{const r=await Hn(e,{...n,account:n?.account}),{priorityFeePerGas:a}=r,i=t(BigInt(r.baseFeePerGas))+a;return"legacy"===s?{gasPrice:i}:{maxFeePerGas:i,maxPriorityFeePerGas:a}}catch{return null}}const Jn=P({...{fees:{estimateFeesPerGas:Kn,async maxPriorityFeePerGas({block:e,client:t,request:n}){const s=await Kn({block:e,client:t,multiply:e=>e,request:n,type:"eip1559"});return s?.maxPriorityFeePerGas?s.maxPriorityFeePerGas:null}}},id:59144,name:"Linea Mainnet",nativeCurrency:{name:"Linea Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://rpc.linea.build"],webSocket:["wss://rpc.linea.build"]}},blockExplorers:{default:{name:"Etherscan",url:"https://lineascan.build",apiUrl:"https://api.lineascan.build/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:42},ensRegistry:{address:"0x50130b669B28C339991d8676FA73CF122a121267",blockCreated:6682888},ensUniversalResolver:{address:"0x3aA974fb3f8C1E02796048BDCdeD79e9D53a6965",blockCreated:6683e3}},ensTlds:[".linea.eth"],testnet:!1}),Zn=P({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),Xn=P({id:169,name:"Manta Pacific Mainnet",network:"manta",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://pacific-rpc.manta.network/http"]}},blockExplorers:{default:{name:"Manta Explorer",url:"https://pacific-explorer.manta.network",apiUrl:"https://pacific-explorer.manta.network/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:332890}}}),Yn=P({id:3441005,name:"Manta Pacific Testnet",network:"manta-testnet",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://manta-testnet.calderachain.xyz/http"]}},blockExplorers:{default:{name:"Manta Testnet Explorer",url:"https://pacific-explorer.testnet.manta.network",apiUrl:"https://pacific-explorer.testnet.manta.network/api"}},contracts:{multicall3:{address:"0x211B1643b95Fe76f11eD8880EE810ABD9A4cf56C",blockCreated:419915}},testnet:!0}),Qn=P({id:5e3,name:"Mantle",nativeCurrency:{decimals:18,name:"MNT",symbol:"MNT"},rpcUrls:{default:{http:["https://rpc.mantle.xyz"]}},blockExplorers:{default:{name:"Mantle Explorer",url:"https://mantlescan.xyz/",apiUrl:"https://api.mantlescan.xyz/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:304717}}}),es=P({id:4200,name:"Merlin",nativeCurrency:{name:"BTC",symbol:"BTC",decimals:18},rpcUrls:{default:{http:["https://rpc.merlinchain.io"]}},blockExplorers:{default:{name:"blockscout",url:"https://scan.merlinchain.io",apiUrl:"https://scan.merlinchain.io/api"}}}),ts=1,ns=P({...kn,id:34443,name:"Mode Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.mode.network"]}},blockExplorers:{default:{name:"Modescan",url:"https://modescan.io"}},contracts:{...kn.contracts,multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:2465882},l2OutputOracle:{[ts]:{address:"0x4317ba146D4933D889518a3e5E11Fe7a53199b04"}},portal:{[ts]:{address:"0x8B34b14c7c7123459Cf3076b8Cb929BE097d0C07"}},l1StandardBridge:{[ts]:{address:"0x735aDBbE72226BD52e818E7181953f42E3b0FF21"}}},sourceId:1}),ss=56,rs=P({id:204,name:"opBNB",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:{default:{http:["https://opbnb-mainnet-rpc.bnbchain.org"]}},blockExplorers:{default:{name:"opBNB (BSCScan)",url:"https://opbnb.bscscan.com",apiUrl:"https://api-opbnb.bscscan.com/api"}},contracts:{...kn.contracts,multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:512881},l2OutputOracle:{[ss]:{address:"0x153CAB79f4767E2ff862C94aa49573294B13D169"}},portal:{[ss]:{address:"0x1876EA7702C0ad0C6A2ae6036DE7733edfBca519"}},l1StandardBridge:{[ss]:{address:"0xF05F0e4362859c3331Cb9395CBC201E3Fa6757Ea"}}},sourceId:56}),as=1,is=P({...kn,id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.optimism.io"]}},blockExplorers:{default:{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io/api"}},contracts:{...kn.contracts,disputeGameFactory:{[as]:{address:"0xe5965Ab5962eDc7477C8520243A95517CD252fA9"}},l2OutputOracle:{[as]:{address:"0xdfe97868233d1aa22e815a266982f2cf17685a27"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:4286263},portal:{[as]:{address:"0xbEb5Fc579115071764c7423A4f12eDde41f106Ed"}},l1StandardBridge:{[as]:{address:"0x99C9fc46f92E8a1c0deC1b1747d010903E884bE1"}}},sourceId:1}),os=P({id:11297108109,name:"Palm",nativeCurrency:{decimals:18,name:"PALM",symbol:"PALM"},rpcUrls:{default:{http:["https://palm-mainnet.public.blastapi.io"],webSocket:["wss://palm-mainnet.public.blastapi.io"]}},blockExplorers:{default:{name:"Chainlens",url:"https://palm.chainlens.com"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15429248}}}),cs=P({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:25770160}}}),us=P({id:1101,name:"Polygon zkEVM",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://zkevm-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://zkevm.polygonscan.com",apiUrl:"https://api-zkevm.polygonscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:57746}}}),ls=P({id:3109,name:"SatoshiVM Alpha Mainnet",nativeCurrency:{name:"BTC",symbol:"BTC",decimals:18},rpcUrls:{default:{http:["https://alpha-rpc-node-http.svmscan.io"]}},blockExplorers:{default:{name:"blockscout",url:"https://svmscan.io",apiUrl:"https://svmscan.io/api"}}}),ds=P({id:534352,name:"Scroll",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://rpc.scroll.io"],webSocket:["wss://wss-rpc.scroll.io/ws"]}},blockExplorers:{default:{name:"Scrollscan",url:"https://scrollscan.com",apiUrl:"https://api.scrollscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14}},testnet:!1}),hs=P({id:1329,name:"Sei Network",nativeCurrency:{name:"Sei",symbol:"SEI",decimals:18},rpcUrls:{default:{http:["https://evm-rpc.sei-apis.com/"],webSocket:["wss://evm-ws.sei-apis.com/"]}},blockExplorers:{default:{name:"Seitrace",url:"https://seitrace.com",apiUrl:"https://seitrace.com/pacific-1/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11"}}}),ps=P({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xc8Af999e38273D658BE1b921b88A9Ddf005769cC",blockCreated:5317080}},testnet:!0}),ms=P({id:1315,name:"Story Aeneid",network:"story-aeneid",nativeCurrency:{decimals:18,name:"IP",symbol:"IP"},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1792},ensRegistry:{address:"0x5dC881dDA4e4a8d312be3544AD13118D1a04Cb17",blockCreated:1322033},ensUniversalResolver:{address:"0x6D3B3F99177FB2A5de7F9E928a9BD807bF7b5BAD",blockCreated:1322097}},rpcUrls:{default:{http:["https://aeneid.storyrpc.io"]}},blockExplorers:{default:{name:"Story Aeneid Explorer",url:"https://aeneid.storyscan.xyz",apiUrl:"https://aeneid.storyscan.xyz/api/v2"}},ensTlds:[".ip"],testnet:!0}),gs=P({id:167e3,name:"Taiko Mainnet",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.mainnet.taiko.xyz"],webSocket:["wss://ws.mainnet.taiko.xyz"]}},blockExplorers:{default:{name:"Taikoscan",url:"https://taikoscan.io",apiUrl:"https://api.taikoscan.io/api"}},contracts:{multicall3:{address:"0xcb2436774C3e191c85056d248EF4260ce5f27A9D"}}}),fs=P({id:196,name:"X Layer Mainnet",nativeCurrency:{decimals:18,name:"OKB",symbol:"OKB"},rpcUrls:{default:{http:["https://rpc.xlayer.tech"]}},blockExplorers:{default:{name:"OKLink",url:"https://www.oklink.com/xlayer",apiUrl:"https://www.oklink.com/api/v5/explorer/xlayer/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:47416}}}),ys=P({id:7e3,name:"ZetaChain",nativeCurrency:{decimals:18,name:"Zeta",symbol:"ZETA"},rpcUrls:{default:{http:["https://zetachain-evm.blockpi.network/v1/rpc/public"]}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:1632781}},blockExplorers:{default:{name:"ZetaScan",url:"https://explorer.zetachain.com"}},testnet:!1}),bs=P({id:810180,name:"zkLink Nova",nativeCurrency:{decimals:18,name:"ETH",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.zklink.io"]}},blockExplorers:{default:{name:"zkLink Nova Block Explorer",url:"https://explorer.zklink.io"}}}),ws=P({...xn,id:324,name:"ZKsync Era",network:"zksync-era",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://mainnet.era.zksync.io"],webSocket:["wss://mainnet.era.zksync.io/ws"]}},blockExplorers:{default:{name:"Etherscan",url:"https://era.zksync.network/",apiUrl:"https://api-era.zksync.network/api"},native:{name:"ZKsync Explorer",url:"https://explorer.zksync.io/",apiUrl:"https://block-explorer-api.mainnet.zksync.io/api"}},contracts:{multicall3:{address:"0xF9cda624FBC7e059355ce98a31693d299FACd963"},universalSignatureVerifier:{address:"0xfB688330379976DA81eB64Fe4BF50d7401763B9C",blockCreated:45659388}}}),vs=1,xs=P({...kn,id:7777777,name:"Zora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.zora.energy"],webSocket:["wss://rpc.zora.energy"]}},blockExplorers:{default:{name:"Explorer",url:"https://explorer.zora.energy",apiUrl:"https://explorer.zora.energy/api"}},contracts:{...kn.contracts,l2OutputOracle:{[vs]:{address:"0x9E6204F750cD866b299594e2aC9eA824E2e5f95c"}},multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:5882},portal:{[vs]:{address:"0x1a0ad011913A150f69f6A19DF447A0CfD9551054"}},l1StandardBridge:{[vs]:{address:"0x3e2Ea9B92B7E48A52296fD261dc26fd995284631"}}},sourceId:1}),ks="https://social-relay.tomo.inc",Is=ks+"/x",Es=ks+"/x/loader",Ps="06226ae2a1e8d0727c60dd2e6c874a63",Ts=ks+"/kakao",Ss=ks+"/google",Cs={googleAuth:"tomo-google-authorized",xAuth:"tomo-twitter-authorized",signReq:"tomo-response",normalReq:"normal-response",mfaCreate:"tomo-mfa-authorized",kakaoAuth:"tomo-kakao-authorized",telegramAuth:"tomo-telegram-authorized"},Os="googleAuth",js="xAuth",As="signReq",Bs="normalReq",Us="mfaReq",Ms="kakaoAuth",$s="telegramAuth",zs="signMessage",Ds="signTypedMessage",Rs="sendTx",Fs="signTx",Ls="signTxs";let Ns=[];const Gs=s.getLogger("TomoSDK"),_s="local-email-login-req",Vs="tomo-cache",qs=()=>{try{const e=localStorage.getItem(Vs);return JSON.parse(e??"")}catch(e){return null}},Ws=(e,t,n)=>{let s=qs();s?s[e]?s[e][t]=n:s[e]={[t]:n}:s={[e]:{[t]:n}},(e=>{try{localStorage.setItem(Vs,JSON.stringify(e))}catch(e){Gs.error("save cache failed")}})(s)},Hs={},Ks=e=>{try{return Hs[e]||null}catch(e){return null}},Js=(e,t)=>{Hs[e]=t},Zs=e=>{try{const t=qs();return t?.[e]?.userId}catch(e){return null}},Xs=(e,t)=>{Ws(e,"userId",t)},Ys=e=>{try{const t=qs();return t?.[e]?.loginType}catch(e){return null}},Qs=(e,t)=>{Ws(e,"loginType",t)},er=(e,t)=>{Ws(e,"localPasskey",t)},tr=()=>{try{const e=localStorage.getItem(_s);return JSON.parse(e??"")}catch(e){return null}},nr=e=>{try{localStorage.setItem(_s,e)}catch(e){return null}},sr=()=>{try{localStorage.removeItem(_s)}catch(e){}};let rr=null;const ar=async e=>rr?(Gs.debug("cache data:",rr),rr):(rr=await Sr(e),rr),ir=()=>{rr=null},or=e=>{const t=(new TextEncoder).encode(e),n=Array.from(t,(e=>String.fromCodePoint(e))).join("");return btoa(n)},cr=(e,n)=>{const{reqType:s,chainType:r,address:a,addressType:i,network:o,message:c,signMessageType:u}=n;return{eventId:t(),chainType:r,origin:window.location.origin,accessToken:Ks(e),reqType:s,signInfo:{message:c,address:a,addressType:i,network:o,signMessageType:u}}},ur=(e,n)=>{const{reqType:s,address:r,network:a,addressType:i}=n;return{eventId:t(),chainType:"bitcoin",origin:window.location.origin,accessToken:Ks(e),reqType:s,txMeta:{txParams:n.params,address:r,addressType:i,network:a}}},lr=(e,n)=>{const{reqType:s,address:r}=n;return{eventId:t(),chainType:"solana",origin:window.location.origin,accessToken:Ks(e),address:r,reqType:s,txMeta:n.params}};const dr=[],hr=({url:e,name:t,width:n,height:s})=>{const r=(window.innerHeight-(s||400))/2+window.screenY,a=(window.innerWidth-(n||400))/2+window.screenX;if(dr.length){const t=dr[dr.length-1];return t.location.href=e,t}try{const i=window.open(e,t,`dialog=yes,top=${r}px,left=${a},width=${void 0!==n?n:400}px,height=${void 0!==s?s:600}px`);return i?(dr.push(i),i):mr({url:e,width:n})}catch(t){return mr({url:e,width:n})}},pr={closed:!1},mr=({url:e,width:t=400})=>{const n="tomo-social-iframe-modal",s=document.getElementById(n);s&&s.remove();const r=document.querySelector('meta[name="viewport"]'),a=r?.getAttribute("content"),i={overflow:document.body.style.overflow,position:document.body.style.position,width:document.body.style.width,height:document.body.style.height},o=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator?.userAgent||""),c=document.createElement("div");c.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    width: 100%;\n    height: 100%;\n    background: transparent;\n    z-index: 999999;\n    -webkit-overflow-scrolling: touch;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  ";const u=document.createElement("div");u.style.cssText=`\n    ${o?"\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    max-width: 100%;\n    max-height: 100%;\n  ":`\n    width: ${t||400}px;\n    height: ${o?"100%":"600px"};\n    border-radius: 16px;\n  `}\n    background: white;\n    overflow: hidden;\n    z-index: 1000000;\n    display: flex;\n    flex-direction: column;\n    margin: 0;\n    padding: 0;\n    border: none;\n    box-shadow: ${o?"none":"0 4px 24px rgba(0, 0, 0, 0.1)"};\n    opacity: 0;\n    transition: opacity 0.3s;\n  `;const l=document.createElement("iframe");if(l.id=n,l.setAttribute("loading","eager"),l.setAttribute("importance","high"),l.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-modals allow-storage-access-by-user-activation"),l.setAttribute("referrerpolicy","strict-origin"),l.allow="publickey-credentials-create; clipboard-write",l.src=e,l.style.cssText="\n    width: 100%;\n    height: 100%;\n    border: none;\n    margin: 0;\n    padding: 0;\n    flex: 1;\n    display: block;\n    background: white;\n    -webkit-overflow-scrolling: touch;\n  ",l.onload=()=>{u.style.opacity="1"},o){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover",document.head.appendChild(e),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100%"}u.appendChild(l),c.appendChild(u),document.body.appendChild(c);const d=()=>{if(c.remove(),o){const e=document.querySelector('meta[name="viewport"]');e&&(r&&a?r.setAttribute("content",a):e.remove()),document.body.style.overflow=i.overflow,document.body.style.position=i.position,document.body.style.width=i.width,document.body.style.height=i.height}},h=e=>{Object.values(Cs).includes(e.data.type)&&(d(),window.removeEventListener("message",h))};return window.addEventListener("message",h),c.addEventListener("click",(e=>{e.target===c&&(pr.closed=!0,d(),window.removeEventListener("message",h))})),pr.closed=!1,pr};async function gr(e,t,n,s){const r=await e,a=setInterval((()=>{if(r&&r.closed){const e=dr.findIndex((e=>e==r));-1!==e&&dr.splice(e,1),Gs.debug("Popup window closed"),Ns.find((e=>e===s))||(t.emit(`${n}#${s}`,!1),Gs.debug("events:",t.eventNames(),`${n}#${s}`)),clearInterval(a)}else Gs.debug("Popup window is still open")}),1e3);return a}const fr=async(e,t)=>{if(!e)throw Error("Invalid request");if(!t)throw Error("Invalid sdk status");const n=or(r.stringify({...e,userId:Zs(t.clientId),loginType:Ys(t.clientId)}));return await Or({eventId:e.eventId,value:n}),new Promise(((n,s)=>{gr(hr({url:`${t.relayBase}/request?eventId=${e.eventId}`,name:"Sign Request"}),t.events,As,e.eventId),t.events.once(`${As}#${e.eventId}`,(e=>{Gs.debug("result:",e),e.error?s(e.error):n(e.result||e.response||e)}))}))};function yr(e){if("READY"!==e.data.status)e.data.isSuccess&&e.data.result?this.onSuccess(e.data):e.data.isError?this.onError(e.data):e.data.isReject?this.onReject(e.data):e.data.setAuth&&Js(this.clientId,e.data.jwt);else{const e={type:this.reqType,auth:{jwt:Ks(this.clientId),userId:Zs(this.clientId),clientId:this.clientId},...this.params||{},reqString:this.reqString};this.postMessage?.(e,"*")}}const br=async(e,t)=>{const n=Ys(t.clientId);e.loginType=n;const s=or(r.stringify(e)),a=hr({url:t.relayBase+"/normal",name:"normal Request"});return new Promise(((n,r)=>{const i=yr.bind({clientId:t.clientId,core:t,reqString:s,postMessage:(e,...t)=>a.postMessage?.(e,...t),onSuccess:e=>{n(e.result)},onError:e=>{r(e.error)},onReject:e=>{r(e.result)}});window.addEventListener("message",i);gr(a,t.events,Bs,e.eventId),t.events.once(`${Bs}#${e.eventId}`,(e=>{e.result?n(e.result):r(e.error),window.removeEventListener("message",i)}))}))},wr=async(e,n,s)=>{const r=n.walletDomain,a=t(),i=hr({url:""+r,name:"wallet Request",height:740,width:400});return new Promise(((t,r)=>{const o=yr.bind({clientId:n.clientId,core:n,reqType:e,params:s,postMessage:(e,...t)=>i.postMessage?.(e,...t),onSuccess:e=>{t(e.result)},onError:e=>{r(e.error)},onReject:e=>{r(e.result)}});window.addEventListener("message",o);gr(i,n.events,Bs,a),n.events.once(`${Bs}#${a}`,(e=>{e.result?t(e.result):r(e.error),window.removeEventListener("message",o)}))}))},vr="https://fans-tech-backend.tomo.services/api/",xr="https://apps-prod.tomo.inc/api/";let kr,Ir=xr;const Er=e=>{const{connectUrl:t}=e;Ir=t,kr=n.create({baseURL:t}),kr.interceptors.request.use((async t=>{const n=await async function(e){const t=Ks(e.clientId);if(t)return t;const n=document.createElement("iframe");n.style.display="none",n.src=e.relayBase+"/normal",document.body.appendChild(n);try{return await new Promise((t=>{const s=r=>{if("READY"===r.data.status){const t={auth:{clientId:e.clientId}};n.contentWindow?.postMessage(t,"*")}else r.data.setAuth&&r.data.jwt?(window.removeEventListener("message",s),t(r.data.jwt),Js(e.clientId,r.data.jwt)):r.data.isFail&&(window.removeEventListener("message",s),t(""))};window.addEventListener("message",s)}))}catch(e){}finally{document.body.removeChild(n)}}(e);return n&&(t.headers=t.headers||{},t.headers.Authorization="Bearer "+n),t.headers["Tomo-Sdk-Version"]="1.1.22",t}),(e=>{if(401===e?.response?.status)return Promise.reject(e)}))};function Pr(e){if(!kr)throw"api not initialized yet";kr.interceptors.request.use((t=>(Object.entries(e).forEach((([e,n])=>{t.headers[e]=n})),t)))}const Tr=async e=>{const{data:t}=await kr.post("socialLogin/projectUser/bound",{...e});return t},Sr=async e=>{try{const{data:t}=await kr.get("socialLogin/projectUser/info?clientId="+e);return t}catch(e){}},Cr=async e=>{const{data:t}=await kr.get("socialLogin/projectUser/customization",{params:{clientId:e}});return t},Or=async e=>{const{data:t}=await kr.post("socialLogin/projectUser/setTemporaryData",e).catch((e=>{const t=e?.response?.data?.message;return Promise.reject(t||"Failed to sign message")}));return t},jr={mainnet:{ticker:"BTC",apiBlockstream:"https://btc-rpc.lorenzo-protocol.xyz"},testnet:{ticker:"BTC",apiBlockstream:"https://btc-rpc-testnet.lorenzo-protocol.xyz/testnet"},signet:{ticker:"sBTC",apiBlockstream:"https://btc-rpc-signet.lorenzo-protocol.xyz/signet"}};var Ar;!function(e){e[e.P2PKH=0]="P2PKH",e[e.P2WPKH=1]="P2WPKH",e[e.P2TR=2]="P2TR",e[e.P2SH_P2WPKH=3]="P2SH_P2WPKH",e[e.M44_P2WPKH=4]="M44_P2WPKH",e[e.M44_P2TR=5]="M44_P2TR"}(Ar||(Ar={}));const Br={P2PKH:"P2PKH",P2WPKH:"P2WPKH",P2TR:"P2TR",P2SH:"P2SH"},Ur="mainnet",Mr=[{value:Ar.P2PKH,label:"P2PKH",name:"Legacy (P2PKH)",displayName:"Legacy",hdPath:"m/44'/0'/0'/0"},{value:Ar.P2WPKH,label:"P2WPKH",name:"Native Segwit (P2WPKH)",displayName:"Native Segwit",hdPath:"m/84'/0'/0'/0"},{value:Ar.P2TR,label:"P2TR",name:"Taproot (P2TR)",displayName:"Taproot",hdPath:"m/86'/0'/0'/0"},{value:Ar.P2SH_P2WPKH,label:"P2SH",name:"Nested Segwit (P2SH-P2WPKH)",displayName:"Nested Segwit",hdPath:"m/49'/0'/0'/0"}];class $r{network=Ur;event=new e;addressType=Br.P2TR;address="";pubKey="";core;setCore(e){this.core=e}async getAccounts(){return[await this.getAddress()]}async getAddress(){const e=await ar(this.core.clientId);if(!e.result)throw Error("Get address failed.");return this.network===Ur?(this.address=e.result.btcMainnetAddressInfo[this.addressType.toLowerCase()],this.address):(this.address=e.result.btcTestnetAddressInfo[this.addressType.toLowerCase()],this.address)}async getPublicKey(){return this.getPublicKeyHex()}async getPublicKeyHex(){const e=await ar(this.core.clientId);if(!e.result)throw Error("Get public key failed.");const t=this.addressType.toLowerCase()+"PubKey";return this.network===Ur?e.result.btcMainnetAddressInfo[t]:e.result.btcTestnetAddressInfo[t]}async getAllAddresses(){const e=await ar(this.core.clientId);if(!e.result)throw Error("Get address failed.");let t;t=this.network===Ur?e.result.btcMainnetAddressInfo:e.result.btcTestnetAddressInfo;return Object.entries(t).map((([e,t])=>{const n=Mr.find((t=>t.label===e.toUpperCase()));return n?{...n,address:t}:null})).filter((e=>null!==e))}async sendBitcoin(e,t,n){const s=ur(this.core.clientId,{reqType:Rs,network:this.network,address:this.address,addressType:this.addressType,params:{to:e,amount:t,feeRate:n,fromAddress:await this.getAddress(),pubKey:await this.getPublicKeyHex()}});return await fr(s,this.core)}async signPsbt(e){const t=ur(this.core.clientId,{reqType:Fs,network:this.network,address:this.address,addressType:this.addressType,params:{psbtHex:e}});return await fr(t,this.core)}async signPsbts(e){const t=ur(this.core.clientId,{reqType:Ls,network:this.network,address:this.address,addressType:this.addressType,params:{psbtHexs:e}}),n=await fr(t,this.core);return n?n.split(","):""}async signMessageBIP322(e){const t=cr(this.core.clientId,{chainType:"bitcoin",reqType:zs,address:this.address,addressType:this.addressType,network:this.network,message:e,signMessageType:"bip322-simple"});return await fr(t,this.core)}async signMessageEcdsa(e){const t=cr(this.core.clientId,{chainType:"bitcoin",reqType:zs,address:this.address,addressType:this.addressType,network:this.network,message:e,signMessageType:"ecdsa"});return await fr(t,this.core)}async signMessage(e,t="ecdsa"){return"ecdsa"===t?this.signMessageEcdsa(e):this.signMessageBIP322(e)}getNetwork(){return this.network}getAddressType(){return this.addressType}async switchNetwork(e){if("mainnet"!==e&&"testnet"!==e&&"signet"!==e)throw Error("Invalid network, only support mainnet, testnet, signet");this.network=e,await this.getAddress(),this.event.emit("networkChanged",e)}async changeAddressType(e){if(!Br[e])throw Error("Invalid address type, only support P2PKH, P2WPKH, P2TR, P2SH");this.addressType=Br[e],await this.getAddress(),this.event.emit("addressTypeChanged",e)}on(e,t){this.event.on(e,t)}off(e,t){this.event.off(e,t)}async getBalance(e){try{const t=e||await this.getAddress(),s=await(async(e,t)=>(await n.get(`${e}/api/address/${t}`,{maxRedirects:1})).data)(jr[this.network].apiBlockstream,t),r=s?.chain_stats,a=s?.mempool_stats;return r.funded_txo_sum-r.spent_txo_sum+(a.funded_txo_sum-a.spent_txo_sum)}catch(e){return 0}}async getFeeRate(){try{return(await(async e=>{const{data:t}=await kr.get("socialLogin/projectWallet/bitcoin/getFeeRate?networkType="+e);return t})(this.network.toUpperCase())).result}catch(e){throw Gs.debug("Get fee rate failed:",e),Error("Get fee rate failed.")}}async pushTx(e){try{const t=await(async(e,t)=>{const{data:n}=await kr.post("socialLogin/projectWallet/bitcoin/pushTx",{rawTransaction:e,networkType:t});return n})(e,this.network.toUpperCase());return t.result}catch(e){throw Gs.debug("Get fee rate failed:",e),Error("Get fee rate failed.")}}async getInscriptionData(e,t=this.network){try{const n=await(async(e,t)=>{const{data:n}=await kr.get(`socialLogin/projectWallet/bitcoin/getInscriptionData?address=${e}&networkType=${t}`);return n})(e,t.toUpperCase());return n.result}catch(e){throw Gs.debug("GetInscriptionData failed:",e),Error("GetInscriptionData failed.")}}async getInscriptionInfo(e,t=this.network){try{const n=await(async(e,t)=>{const{data:n}=await kr.get(`socialLogin/projectWallet/bitcoin/getInscriptionInfo?insId=${e}&networkType=${t}`);return n})(e,t.toUpperCase());return n.result}catch(e){throw Gs.debug("GetInscriptionInfo failed:",e),Error("GetInscriptionInfo failed.")}}}const zr=[In,Pn,Sn,On,jn,An,Bn,Mn,$n,zn,Rn,Fn,Ln,Jn,Zn,Xn,Qn,es,ns,rs,is,cs,us,ls,ds,hs,gs,fs,ys,bs,ws,xs,ps,Yn,Dn,os,En,{id:80094,name:"Berachain Mainnet",nativeCurrency:{name:"BERA Token",symbol:"BERA",decimals:18},rpcUrls:{default:{http:["https://rpc.berachain.com"]}},blockExplorers:{default:{name:"Berachain Scan",url:"https://berascan.com"}},logo:"/images/chain/Berachain bArtio.png",chainName:"Berachain Mainnet",nativeCurrencyName:"BERA Token",nativeCurrencySymbol:"BERA",nativeCurrencyDecimals:18,blockExplorerUrl:"https://berascan.com",platformType:"EVM",icon:"https://static.tomo.inc/token/berachain.svg",supportSwap:!1,supportGift:!1,supportHistory:!1},ms];zr.reduce(((e,t)=>(e[t.id]=t,e)),{});const Dr={eth_requestAccounts:"eth_requestAccounts",eth_accounts:"eth_accounts",wallet_watchAsset:"wallet_watchAsset",eth_addEthereumChain:"eth_addEthereumChain",eth_switchEthereumChain:"eth_switchEthereumChain",wallet_switchEthereumChain:"wallet_switchEthereumChain",personal_sign:"personal_sign",eth_signTypedData_v4:"eth_signTypedData_v4",wallet_getPermissions:"wallet_getPermissions",wallet_requestPermissions:"wallet_requestPermissions",eth_sendTransaction:"eth_sendTransaction",eth_sendRawTransaction:"eth_sendRawTransaction",personal_ecRecover:"personal_ecRecover",eth_swapTransaction:"eth_swapTransaction",eth_approveTransaction:"eth_approveTransaction",eth_chainId:"eth_chainId"},Rr="TOMO_WALLET_EVM_CHAIN_ID";class Fr extends e{jsonRpcProvider;chainConfig;core;chainList;chainListFromCDN;instanceId;initialPromise;connectUrl;constructor(e){super(),this.connectUrl=e?.connectUrl||"",this.instanceId=(""+Date.now()).slice(0,-2),this.chainList=zr,this.chainListFromCDN=[];this.initialPromise=this.initial(this.chainIdDecimal)}async initial(e){const t=await this.getChainConfig(e).catch((e=>{throw e}));this.chainConfig=t,this.jsonRpcProvider=new i(new a(t.rpcUrl)),this.connect()}async getChainConfig(e){const t=this.getChain(e),n={chainId:e,rpcUrl:""};if(t)n.rpcUrl=t.rpcUrls.default.http[0];else{let t=this.chainListFromCDN;0!==t.length&&t.find((t=>t.id===e))||(t=await this.getChainListFromCDN());const s=t.find((t=>t.id===e));if(!s)throw Error("Unsupported chain");n.rpcUrl=s.rpcUrl}return n}async getChainListFromCDN(){const e=(await(async e=>(await n.get((e||Ir)+"chain/chain_info?platform=SDK")).data)(this.connectUrl).catch((()=>[]))).filter((e=>"EVM"===e.platformType)).map((e=>({...e,rpcUrl:e.rpcUrls[0],id:e.chainId})));return this.chainListFromCDN=e,e}getChain(e){return this.chainList.find((t=>t.id===e))}async connect(){await this.jsonRpcProvider.connect(),this.jsonRpcProvider.connection.on("error",(e=>Gs.error(e)))}async request(e,t){return Gs.debug(e,this.instanceId),await this.initialPromise,Dr[e.method]?await this.processWalletAction(e):await this.jsonRpcProvider.request(e,t)}get chainIdDecimal(){let e=localStorage.getItem(Rr)??1;return e=isNaN(Number(e))?1:Number(e),e}get chainIdHex(){return"0x"+this.chainIdDecimal.toString(16)}async processWalletAction(e){switch(e.method){case"eth_requestAccounts":return await this.requestAddresses();case"eth_accounts":return await this.getAddresses();case"personal_sign":return await this.signMessage(e.params[0],e.params[1]);case"eth_signTypedData_v4":return await this.signTypedData(e.params[0],e.params[1]);case"eth_sendTransaction":return await this.sendTransaction(e.params[0]);case"eth_sendRawTransaction":return await this.sendRawTransaction();case"wallet_switchEthereumChain":return await this.switchChain(e.params[0].chainId);case"eth_chainId":return this.chainIdHex;case"personal_ecRecover":return await this.recoverMessageAddress(e.params[0],e.params[1]);case"eth_swapTransaction":return await this.swapTransaction(e.params[0]);case"eth_approveTransaction":return await this.approveTransaction(e.params[0]);default:throw Error("Unsupported wallet action")}}sendAsync(e,t){this.request(e).then((e=>t(null,e))).catch((e=>t(e,null)))}async getChainId(){return this.chainIdDecimal}setCore(e){this.core=e}async switchChain(e){const t=Number(e);if(t===this.chainIdDecimal)return;const n=await this.getChainConfig(t).catch((()=>{throw Error("Unsupported chain")}));await this.setChainConfig(n),this.emit("networkChanged",e)}async setChainConfig(e){localStorage.setItem(Rr,e.chainId+""),this.chainConfig=e,this.jsonRpcProvider=new i(new a(e.rpcUrl)),await this.connect()}async getAddresses(){return await this.requestAddresses()}async requestAddresses(){if(this.core){return[await this.core.getEthAddress()]}return[]}async signMessage(e,t){const n=cr(this.core.clientId,{reqType:zs,address:t,message:e,chainType:"evm"});return await fr(n,this.core)}async signTypedData(e,t){const n=cr(this.core.clientId,{reqType:Ds,address:e,message:t,chainType:"evm"});return await fr(n,this.core)}async sendTransaction(e){await this.core.getEthAddress();const n=((e,n)=>{const{reqType:s,chainId:r,rpcUrl:a}=n;return{eventId:t(),chainType:"evm",origin:window.location.origin,accessToken:Ks(e),reqType:s,txMeta:{txParams:n.params,chainId:r,rpcUrl:a}}})(this.core.clientId,{reqType:Rs,chainId:this.chainIdDecimal,rpcUrl:this.chainConfig.rpcUrl,params:e});return await fr(n,this.core)}async recoverMessageAddress(e,t){return await o({message:e,signature:t})}async sendRawTransaction(){throw Error("Not supported yet")}}class Lr{publicKey=null;connected=!1;isConnected=!1;connection;endpoint="https://rpc.ankr.com/solana/c2d7e8a3db5dce62e202db3d28cca25e74da5028abbf20764e2961918ba34dfc";core=null;constructor(e){e&&(this.endpoint=e)}async getPublicKey(){const e=await ar(this.core.clientId);if(!e.result||!e.result.solAddress)throw Error("Get public key failed.");return this.publicKey=new c(e.result.solAddress),this.publicKey.toBase58()}async getAddress(){return await this.getPublicKey()}async getBalance(){await this.connect();const e=await this.getPublicKey();return await(this.connection?.getBalance?.(new c(e)))}setCore(e){this.core=e}async signTransaction(e){await this.getPublicKey();const t=await this.getTransactionHex(e),n=lr(this.core.clientId,{reqType:Rs,address:this.publicKey.toBase58(),params:{type:"sign",transaction:t}});return await fr(n,this.core)}async sendTransaction(e,t){await this.getPublicKey();const n=await this.getTransactionHex(e,t),s=lr(this.core.clientId,{reqType:Rs,address:this.publicKey.toBase58(),params:{type:"send",transaction:n}});return await fr(s,this.core)}async signMessage(e){await this.getPublicKey();const t=(new TextDecoder).decode(e),n=cr(this.core.clientId,{chainType:"solana",reqType:zs,address:this.publicKey.toBase58(),message:t});return await fr(n,this.core)}async connect(){this.connection=new u(this.endpoint,"confirmed"),this.connected=!0,this.connected=!0}async disconnect(){this.connection=null,this.isConnected=!1,this.isConnected=!1}async getTransactionHex(e,t){let n;if(!e.serializeMessage)throw Error("Unsupported transaction type, only support Transaction");{const s=e;s.feePayer||(this.publicKey||(this.publicKey=new c(await this.getPublicKey())),s.feePayer=this.publicKey),this.isConnected||await this.connect();const r=t||this.connection;s.recentBlockhash=r.getLatestBlockhash?(await r.getLatestBlockhash())?.blockhash:(await r.getRecentBlockhash("max"))?.blockhash,n=s.serialize({requireAllSignatures:!1,verifySignatures:!1}).toString("hex")}return n}}
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Nr(e,t){return!!Array.isArray(t)&&(0===t.length||t.every(e?e=>"string"==typeof e:e=>Number.isSafeInteger(e)))}function Gr(e,t){if("string"!=typeof t)throw Error(e+": string expected");return!0}function _r(e){if(!Number.isSafeInteger(e))throw Error("invalid integer: "+e)}function Vr(e){if(!Array.isArray(e))throw Error("array expected")}function qr(e,t){if(!Nr(!0,t))throw Error(e+": array of strings expected")}function Wr(e,t,n){if(2>t)throw Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(2>n)throw Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(Vr(e),!e.length)return[];let s=0;const r=[],a=Array.from(e,(e=>{if(_r(e),0>e||e>=t)throw Error("invalid integer: "+e);return e})),i=a.length;for(;;){let e=0,o=!0;for(let r=s;i>r;r++){const i=a[r],c=t*e,u=c+i;if(!Number.isSafeInteger(u)||c/t!==e||u-i!==c)throw Error("convertRadix: carry overflow");e=u%n;const l=Math.floor(u/n);if(a[r]=l,!Number.isSafeInteger(l)||l*n+e!==u)throw Error("convertRadix: carry overflow");o&&(l?o=!1:s=r)}if(r.push(e),o)break}for(let t=0;e.length-1>t&&0===e[t];t++)r.push(0);return r.reverse()}function Hr(e){_r(e);return{encode:t=>{if(!((n=t)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw Error("radix.encode input should be Uint8Array");var n;return Wr(Array.from(t),256,e)},decode:t=>(function(e,t){if(!Nr(!1,t))throw Error(e+": array of numbers expected")}("radix.decode",t),Uint8Array.from(Wr(t,e,256)))}}const Kr=(Jr="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",function(...e){const t=e=>e,n=(e,t)=>n=>e(t(n));return{encode:e.map((e=>e.encode)).reduceRight(n,t),decode:e.map((e=>e.decode)).reduce(n,t)}}(Hr(58),function(e){const t="string"==typeof e?e.split(""):e,n=t.length;qr("alphabet",t);const s=new Map(t.map(((e,t)=>[e,t])));return{encode:s=>(Vr(s),s.map((s=>{if(!Number.isSafeInteger(s)||0>s||s>=n)throw Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${e}`);return t[s]}))),decode:t=>(Vr(t),t.map((t=>{Gr("alphabet.decode",t);const n=s.get(t);if(void 0===n)throw Error(`Unknown letter: "${t}". Allowed: ${e}`);return n})))}}(Jr),function(e=""){return Gr("join",e),{encode:t=>(qr("join.decode",t),t.join(e)),decode:t=>(Gr("join.decode",t),t.split(e))}}("")));var Jr;const Zr=e=>Kr.encode(e),Xr=e=>Kr.decode(e);function Yr(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}const Qr=8192;function ea(e){if(Qr>e.length)return btoa(String.fromCharCode(...e));let t="";for(var n=0;e.length>n;n+=Qr){const s=e.slice(n,n+Qr);t+=String.fromCharCode(...s)}return btoa(t)}function ta(e){const t=e.startsWith("0x")?e.slice(2):e,n=t.length%2==0?t:"0"+t,s=n.match(/[0-9a-fA-F]{2}/g)?.map((e=>parseInt(e,16)))??[];if(s.length!==n.length/2)throw Error("Invalid hex string "+e);return Uint8Array.from(s)}function na(e){return e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")}function sa(e){const t=[];let n=0;if(0===e)return[0];for(;e>0;)t[n]=127&e,(e>>=7)&&(t[n]|=128),n+=1;return t}class ra{constructor(e){this.bytePosition=0,this.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength)}shift(e){return this.bytePosition+=e,this}read8(){const e=this.dataView.getUint8(this.bytePosition);return this.shift(1),e}read16(){const e=this.dataView.getUint16(this.bytePosition,!0);return this.shift(2),e}read32(){const e=this.dataView.getUint32(this.bytePosition,!0);return this.shift(4),e}read64(){const e=this.read32(),t=this.read32().toString(16)+e.toString(16).padStart(8,"0");return BigInt("0x"+t).toString(10)}read128(){const e=BigInt(this.read64()),t=BigInt(this.read64()).toString(16)+e.toString(16).padStart(16,"0");return BigInt("0x"+t).toString(10)}read256(){const e=BigInt(this.read128()),t=BigInt(this.read128()).toString(16)+e.toString(16).padStart(32,"0");return BigInt("0x"+t).toString(10)}readBytes(e){const t=new Uint8Array(this.dataView.buffer,this.bytePosition+this.dataView.byteOffset,e);return this.shift(e),t}readULEB(){const e=new Uint8Array(this.dataView.buffer,this.bytePosition+this.dataView.byteOffset),{value:t,length:n}=function(e){let t=0,n=0,s=0;for(;;){const r=e[s];if(s+=1,t|=(127&r)<<n,!(128&r))break;n+=7}return{value:t,length:s}}(e);return this.shift(n),t}readVec(e){const t=this.readULEB(),n=[];for(let s=0;t>s;s++)n.push(e(this,s,t));return n}}function aa(e,t=["<",">"]){const[n,s]=t,r=[];let a="",i=0;for(let t=0;e.length>t;t++){const o=e[t];o===n&&i++,o===s&&i--,0!==i||","!==o?a+=o:(r.push(a.trim()),a="")}return r.push(a.trim()),r}class ia{constructor({initialSize:e=1024,maxSize:t=1/0,allocateSize:n=1024}={}){this.bytePosition=0,this.size=e,this.maxSize=t,this.allocateSize=n,this.dataView=new DataView(new ArrayBuffer(e))}ensureSizeOrGrow(e){const t=this.bytePosition+e;if(t>this.size){const e=Math.min(this.maxSize,this.size+this.allocateSize);if(t>e)throw Error(`Attempting to serialize to BCS, but buffer does not have enough size. Allocated size: ${this.size}, Max size: ${this.maxSize}, Required size: ${t}`);this.size=e;const n=new ArrayBuffer(this.size);new Uint8Array(n).set(new Uint8Array(this.dataView.buffer)),this.dataView=new DataView(n)}}shift(e){return this.bytePosition+=e,this}write8(e){return this.ensureSizeOrGrow(1),this.dataView.setUint8(this.bytePosition,Number(e)),this.shift(1)}write16(e){return this.ensureSizeOrGrow(2),this.dataView.setUint16(this.bytePosition,Number(e),!0),this.shift(2)}write32(e){return this.ensureSizeOrGrow(4),this.dataView.setUint32(this.bytePosition,Number(e),!0),this.shift(4)}write64(e){return oa(BigInt(e),8).forEach((e=>this.write8(e))),this}write128(e){return oa(BigInt(e),16).forEach((e=>this.write8(e))),this}write256(e){return oa(BigInt(e),32).forEach((e=>this.write8(e))),this}writeULEB(e){return sa(e).forEach((e=>this.write8(e))),this}writeVec(e,t){return this.writeULEB(e.length),Array.from(e).forEach(((n,s)=>t(this,n,s,e.length))),this}*[Symbol.iterator](){for(let e=0;this.bytePosition>e;e++)yield this.dataView.getUint8(e);return this.toBytes()}toBytes(){return new Uint8Array(this.dataView.buffer.slice(0,this.bytePosition))}toString(e){return function(e,t){switch(t){case"base58":return Zr(e);case"base64":return ea(e);case"hex":return na(e);default:throw Error("Unsupported encoding, supported values are: base64, hex")}}(this.toBytes(),e)}}function oa(e,t){const n=new Uint8Array(t);let s=0;for(;e>0;)n[s]=Number(e%BigInt(256)),e/=BigInt(256),s+=1;return n}var ca,ua,la,da,ha=e=>{throw TypeError(e)},pa=(e,t,n)=>t.has(e)||ha("Cannot "+n),ma=(e,t,n)=>(pa(e,t,"read from private field"),n?n.call(e):t.get(e)),ga=(e,t,n)=>t.has(e)?ha("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),fa=(e,t,n,s)=>(pa(e,t,"write to private field"),t.set(e,n),n);ca=new WeakMap,ua=new WeakMap;let ya=class e{constructor(e){ga(this,ca),ga(this,ua),this.name=e.name,this.read=e.read,this.serializedSize=e.serializedSize??(()=>null),fa(this,ca,e.write),fa(this,ua,e.serialize??((e,t)=>{const n=new ia({initialSize:this.serializedSize(e)??void 0,...t});return ma(this,ca).call(this,e,n),n.toBytes()})),this.validate=e.validate??(()=>{})}write(e,t){this.validate(e),ma(this,ca).call(this,e,t)}serialize(e,t){return this.validate(e),new va(this,ma(this,ua).call(this,e,t))}parse(e){const t=new ra(e);return this.read(t)}fromHex(e){return this.parse(ta(e))}fromBase58(e){return this.parse(Xr(e))}fromBase64(e){return this.parse(Yr(e))}transform({name:t,input:n,output:s,validate:r}){return new e({name:t??this.name,read:e=>s?s(this.read(e)):this.read(e),write:(e,t)=>ma(this,ca).call(this,n?n(e):e,t),serializedSize:e=>this.serializedSize(n?n(e):e),serialize:(e,t)=>ma(this,ua).call(this,n?n(e):e,t),validate:e=>{r?.(e),this.validate(n?n(e):e)}})}};const ba=Symbol.for("@mysten/serialized-bcs");function wa(e){return!!e&&"object"==typeof e&&!0===e[ba]}class va{constructor(e,t){ga(this,la),ga(this,da),fa(this,la,e),fa(this,da,t)}get[ba](){return!0}toBytes(){return ma(this,da)}toHex(){return na(ma(this,da))}toBase64(){return ea(ma(this,da))}toBase58(){return Zr(ma(this,da))}parse(){return ma(this,la).parse(ma(this,da))}}function xa({size:e,...t}){return new ya({...t,serializedSize:()=>e})}function ka({readMethod:e,writeMethod:t,...n}){return xa({...n,read:t=>t[e](),write:(e,n)=>n[t](e),validate:e=>{if(0>e||e>n.maxValue)throw new TypeError(`Invalid ${n.name} value: ${e}. Expected value in range 0-${n.maxValue}`);n.validate?.(e)}})}function Ia({readMethod:e,writeMethod:t,...n}){return xa({...n,read:t=>t[e](),write:(e,n)=>n[t](BigInt(e)),validate:e=>{const t=BigInt(e);if(0>t||t>n.maxValue)throw new TypeError(`Invalid ${n.name} value: ${t}. Expected value in range 0-${n.maxValue}`);n.validate?.(t)}})}la=new WeakMap,da=new WeakMap;const Ea={u8:e=>ka({name:"u8",readMethod:"read8",writeMethod:"write8",size:1,maxValue:255,...e}),u16:e=>ka({name:"u16",readMethod:"read16",writeMethod:"write16",size:2,maxValue:65535,...e}),u32:e=>ka({name:"u32",readMethod:"read32",writeMethod:"write32",size:4,maxValue:2**32-1,...e}),u64:e=>Ia({name:"u64",readMethod:"read64",writeMethod:"write64",size:8,maxValue:2n**64n-1n,...e}),u128:e=>Ia({name:"u128",readMethod:"read128",writeMethod:"write128",size:16,maxValue:2n**128n-1n,...e}),u256:e=>Ia({name:"u256",readMethod:"read256",writeMethod:"write256",size:32,maxValue:2n**256n-1n,...e}),bool:e=>xa({name:"bool",size:1,read:e=>1===e.read8(),write:(e,t)=>t.write8(e?1:0),...e,validate:t=>{if(e?.validate?.(t),"boolean"!=typeof t)throw new TypeError("Expected boolean, found "+typeof t)}}),uleb128:e=>function({serialize:e,...t}){const n=new ya({...t,serialize:e,write:(e,t)=>{for(const s of n.serialize(e).toBytes())t.write8(s)}});return n}({name:"uleb128",read:e=>e.readULEB(),serialize:e=>Uint8Array.from(sa(e)),...e}),bytes:(e,t)=>xa({name:`bytes[${e}]`,size:e,read:t=>t.readBytes(e),write:(t,n)=>{const s=new Uint8Array(t);for(let t=0;e>t;t++)n.write8(s[t]??0)},...t,validate:n=>{if(t?.validate?.(n),!n||"object"!=typeof n||!("length"in n))throw new TypeError("Expected array, found "+typeof n);if(n.length!==e)throw new TypeError(`Expected array of length ${e}, found ${n.length}`)}}),byteVector:e=>new ya({name:"bytesVector",read:e=>{const t=e.readULEB();return e.readBytes(t)},write:(e,t)=>{const n=new Uint8Array(e);t.writeULEB(n.length);for(let e=0;n.length>e;e++)t.write8(n[e]??0)},...e,serializedSize:e=>{const t="length"in e?e.length:null;return null==t?null:sa(t).length+t},validate:t=>{if(e?.validate?.(t),!t||"object"!=typeof t||!("length"in t))throw new TypeError("Expected array, found "+typeof t)}}),string:e=>function({toBytes:e,fromBytes:t,...n}){return new ya({...n,read:e=>{const n=e.readULEB(),s=e.readBytes(n);return t(s)},write:(t,n)=>{const s=e(t);n.writeULEB(s.length);for(let e=0;s.length>e;e++)n.write8(s[e])},serialize:t=>{const n=e(t),s=sa(n.length),r=new Uint8Array(s.length+n.length);return r.set(s,0),r.set(n,s.length),r},validate:e=>{if("string"!=typeof e)throw new TypeError(`Invalid ${n.name} value: ${e}. Expected string`);n.validate?.(e)}})}({name:"string",toBytes:e=>(new TextEncoder).encode(e),fromBytes:e=>(new TextDecoder).decode(e),...e}),fixedArray:(e,t,n)=>new ya({name:`${t.name}[${e}]`,read:n=>{const s=Array(e);for(let r=0;e>r;r++)s[r]=t.read(n);return s},write:(e,n)=>{for(const s of e)t.write(s,n)},...n,validate:t=>{if(n?.validate?.(t),!t||"object"!=typeof t||!("length"in t))throw new TypeError("Expected array, found "+typeof t);if(t.length!==e)throw new TypeError(`Expected array of length ${e}, found ${t.length}`)}}),option:e=>Ea.enum(`Option<${e.name}>`,{None:null,Some:e}).transform({input:e=>null==e?{None:!0}:{Some:e},output:e=>"Some"===e.$kind?e.Some:null}),vector:(e,t)=>new ya({name:`vector<${e.name}>`,read:t=>{const n=t.readULEB(),s=Array(n);for(let r=0;n>r;r++)s[r]=e.read(t);return s},write:(t,n)=>{n.writeULEB(t.length);for(const s of t)e.write(s,n)},...t,validate:e=>{if(t?.validate?.(e),!e||"object"!=typeof e||!("length"in e))throw new TypeError("Expected array, found "+typeof e)}}),tuple:(e,t)=>new ya({name:`(${e.map((e=>e.name)).join(", ")})`,serializedSize:t=>{let n=0;for(let s=0;e.length>s;s++){const r=e[s].serializedSize(t[s]);if(null==r)return null;n+=r}return n},read:t=>{const n=[];for(const s of e)n.push(s.read(t));return n},write:(t,n)=>{for(let s=0;e.length>s;s++)e[s].write(t[s],n)},...t,validate:n=>{if(t?.validate?.(n),!Array.isArray(n))throw new TypeError("Expected array, found "+typeof n);if(n.length!==e.length)throw new TypeError(`Expected array of length ${e.length}, found ${n.length}`)}}),struct(e,t,n){const s=Object.entries(t);return new ya({name:e,serializedSize:e=>{let t=0;for(const[n,r]of s){const s=r.serializedSize(e[n]);if(null==s)return null;t+=s}return t},read:e=>{const t={};for(const[n,r]of s)t[n]=r.read(e);return t},write:(e,t)=>{for(const[n,r]of s)r.write(e[n],t)},...n,validate:e=>{if(n?.validate?.(e),"object"!=typeof e||null==e)throw new TypeError("Expected object, found "+typeof e)}})},enum(e,t,n){const s=Object.entries(t);return new ya({name:e,read:t=>{const n=t.readULEB(),r=s[n];if(!r)throw new TypeError(`Unknown value ${n} for enum ${e}`);const[a,i]=r;return{[a]:i?.read(t)??!0,$kind:a}},write:(e,n)=>{const[r,a]=Object.entries(e).filter((([e])=>Object.hasOwn(t,e)))[0];for(let e=0;s.length>e;e++){const[t,i]=s[e];if(t===r)return n.writeULEB(e),void i?.write(a,n)}},...n,validate:s=>{if(n?.validate?.(s),"object"!=typeof s||null==s)throw new TypeError("Expected object, found "+typeof s);const r=Object.keys(s).filter((e=>void 0!==s[e]&&Object.hasOwn(t,e)));if(1!==r.length)throw new TypeError(`Expected object with one key, but found ${r.length} for type ${e}}`);const[a]=r;if(!Object.hasOwn(t,a))throw new TypeError("Invalid enum variant "+a)}})},map:(e,t)=>Ea.vector(Ea.tuple([e,t])).transform({name:`Map<${e.name}, ${t.name}>`,input:e=>[...e.entries()],output:e=>{const t=new Map;for(const[n,s]of e)t.set(n,s);return t}}),lazy:e=>function(e){let t=null;function n(){return t||(t=e()),t}return new ya({name:"lazy",read:e=>n().read(e),serializedSize:e=>n().serializedSize(e),write:(e,t)=>n().write(e,t),serialize:(e,t)=>n().serialize(e,t).toBytes()})}(e)},Pa=/^(?!.*(^(?!@)|[-.@])($|[-.@]))(?:[a-z0-9-]{0,63}(?:\.[a-z0-9-]{0,63})*)?@[a-z0-9-]{0,63}$/i,Ta=/^(?!.*(^|[-.])($|[-.]))(?:[a-z0-9-]{0,63}\.)+sui$/i;const Sa=/^([a-z0-9]+(?:-[a-z0-9]+)*)$/,Ca=/^\d+$/,Oa=e=>{const t=e.split("/");if(2>t.length||t.length>3)return!1;const[n,s,r]=t;return!(void 0!==r&&!Ca.test(r))&&(!!function(e){return 235>=e.length&&(e.includes("@")?Pa.test(e):Ta.test(e))}(n)&&(Sa.test(s)&&64>s.length))};function ja(e){try{return 32===Xr(e).length}catch(e){return!1}}function Aa(e){return function(e){return/^(0x|0X)?[a-fA-F0-9]+$/.test(e)&&e.length%2==0}(e)&&32===function(e){return/^(0x|0X)/.test(e)?(e.length-2)/2:e.length/2}(e)}function Ba(e){return Aa(e)}function Ua(e){const[t,n]=e.split("::"),s=Oa(t),r=e.slice(t.length+n.length+4),a=r.includes("<")?r.slice(0,r.indexOf("<")):r,i=r.includes("<")?aa(r.slice(r.indexOf("<")+1,r.lastIndexOf(">"))).map((e=>function(e){return e.includes("::")?Ua(e):e}(e.trim()))):[];return{address:s?t:$a(t),module:n,name:a,typeParams:i}}function Ma(e){const{address:t,module:n,name:s,typeParams:r}="string"==typeof e?Ua(e):e;return`${t}::${n}::${s}${r?.length>0?`<${r.map((e=>"string"==typeof e?e:Ma(e))).join(",")}>`:""}`}function $a(e,t=!1){let n=e.toLowerCase();return!t&&n.startsWith("0x")&&(n=n.slice(2)),"0x"+n.padStart(64,"0")}function za(e,t=!1){return $a(e,t)}BigInt(1e9);za("0x6");const Da="0x2::sui::SUI";za("0x5");const Ra=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Fa=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),La=new Uint32Array(32);function Na(e,t,n,s,r,a){const i=r[a+1];let o=La[2*e],c=La[2*e+1],u=La[2*t],l=La[2*t+1],d=La[2*n],h=La[2*n+1],p=La[2*s],m=La[2*s+1],g=ut(o,u,r[a]);var f,y;c=lt(g,c,l,i),o=0|g,({Dh:m,Dl:p}={Dh:m^c,Dl:p^o}),({Dh:m,Dl:p}={Dh:(y=p,y),Dl:(f=m,f)}),({h:h,l:d}=ct(h,d,m,p)),({Bh:l,Bl:u}={Bh:l^h,Bl:u^d}),({Bh:l,Bl:u}={Bh:at(l,u,24),Bl:it(l,u,24)}),La[2*e]=o,La[2*e+1]=c,La[2*t]=u,La[2*t+1]=l,La[2*n]=d,La[2*n+1]=h,La[2*s]=p,La[2*s+1]=m}function Ga(e,t,n,s,r,a){const i=r[a+1];let o=La[2*e],c=La[2*e+1],u=La[2*t],l=La[2*t+1],d=La[2*n],h=La[2*n+1],p=La[2*s],m=La[2*s+1],g=ut(o,u,r[a]);var f,y,b;c=lt(g,c,l,i),o=0|g,({Dh:m,Dl:p}={Dh:m^c,Dl:p^o}),({Dh:m,Dl:p}={Dh:at(m,p,16),Dl:it(m,p,16)}),({h:h,l:d}=ct(h,d,m,p)),({Bh:l,Bl:u}={Bh:l^h,Bl:u^d}),({Bh:l,Bl:u}={Bh:(f=l,y=u,b=63,f<<64-b|y>>>b-32),Bl:ot(l,u,63)}),La[2*e]=o,La[2*e+1]=c,La[2*t]=u,La[2*t+1]=l,La[2*n]=d,La[2*n+1]=h,La[2*s]=p,La[2*s+1]=m}class _a extends Ze{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,De(e),De(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=Ne(this.buffer)}update(e){Fe(this),Re(e=Je(e));const{blockLen:t,buffer:n,buffer32:s}=this,r=e.length,a=e.byteOffset,i=e.buffer;for(let o=0;r>o;){this.pos===t&&(Ke(s),this.compress(s,0,!1),Ke(s),this.pos=0);const c=Math.min(t-this.pos,r-o),u=a+o;if(c!==t||u%4||o+c>=r)n.set(e.subarray(o,o+c),this.pos),this.pos+=c,this.length+=c,o+=c;else{const e=new Uint32Array(i,u,Math.floor((r-o)/4));Ke(e);for(let n=0;r>o+t;n+=s.length,o+=t)this.length+=t,this.compress(e,n,!1);Ke(e)}}return this}digestInto(e){Fe(this),Le(e,this);const{pos:t,buffer32:n}=this;this.finished=!0,Ge(this.buffer.subarray(t)),Ke(n),this.compress(n,0,!0),Ke(n);const s=Ne(e);this.get().forEach(((e,t)=>s[t]=He(e)))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){const{buffer:t,length:n,finished:s,destroyed:r,outputLen:a,pos:i}=this;return e||(e=new this.constructor({dkLen:a})),e.set(...this.get()),e.buffer.set(t),e.destroyed=r,e.finished=s,e.length=n,e.pos=i,e.outputLen=a,e}clone(){return this._cloneInto()}}class Va extends _a{constructor(e={}){const t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|Fa[0],this.v0h=0|Fa[1],this.v1l=0|Fa[2],this.v1h=0|Fa[3],this.v2l=0|Fa[4],this.v2h=0|Fa[5],this.v3l=0|Fa[6],this.v3h=0|Fa[7],this.v4l=0|Fa[8],this.v4h=0|Fa[9],this.v5l=0|Fa[10],this.v5h=0|Fa[11],this.v6l=0|Fa[12],this.v6h=0|Fa[13],this.v7l=0|Fa[14],this.v7h=0|Fa[15],function(e,t={},n,s,r){if(De(n),0>e||e>n)throw Error("outputLen bigger than keyLen");const{key:a,salt:i,personalization:o}=t;if(void 0!==a&&(1>a.length||a.length>n))throw Error("key length must be undefined or 1.."+n);if(void 0!==i&&i.length!==s)throw Error("salt must be undefined or "+s);if(void 0!==o&&o.length!==r)throw Error("personalization must be undefined or "+r)}(t,e,64,16,16);let{key:n,personalization:s,salt:r}=e,a=0;if(void 0!==n&&(n=Je(n),a=n.length),this.v0l^=this.outputLen|a<<8|65536|1<<24,void 0!==r){r=Je(r);const e=Ne(r);this.v4l^=He(e[0]),this.v4h^=He(e[1]),this.v5l^=He(e[2]),this.v5h^=He(e[3])}if(void 0!==s){s=Je(s);const e=Ne(s);this.v6l^=He(e[0]),this.v6h^=He(e[1]),this.v7l^=He(e[2]),this.v7h^=He(e[3])}if(void 0!==n){const e=new Uint8Array(this.blockLen);e.set(n),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:n,v1h:s,v2l:r,v2h:a,v3l:i,v3h:o,v4l:c,v4h:u,v5l:l,v5h:d,v6l:h,v6h:p,v7l:m,v7h:g}=this;return[e,t,n,s,r,a,i,o,c,u,l,d,h,p,m,g]}set(e,t,n,s,r,a,i,o,c,u,l,d,h,p,m,g){this.v0l=0|e,this.v0h=0|t,this.v1l=0|n,this.v1h=0|s,this.v2l=0|r,this.v2h=0|a,this.v3l=0|i,this.v3h=0|o,this.v4l=0|c,this.v4h=0|u,this.v5l=0|l,this.v5h=0|d,this.v6l=0|h,this.v6h=0|p,this.v7l=0|m,this.v7h=0|g}compress(e,t,n){this.get().forEach(((e,t)=>La[t]=e)),La.set(Fa,16);let{h:s,l:r}=rt(BigInt(this.length));La[24]=Fa[8]^r,La[25]=Fa[9]^s,n&&(La[28]=~La[28],La[29]=~La[29]);let a=0;const i=Ra;for(let n=0;12>n;n++)Na(0,4,8,12,e,t+2*i[a++]),Ga(0,4,8,12,e,t+2*i[a++]),Na(1,5,9,13,e,t+2*i[a++]),Ga(1,5,9,13,e,t+2*i[a++]),Na(2,6,10,14,e,t+2*i[a++]),Ga(2,6,10,14,e,t+2*i[a++]),Na(3,7,11,15,e,t+2*i[a++]),Ga(3,7,11,15,e,t+2*i[a++]),Na(0,5,10,15,e,t+2*i[a++]),Ga(0,5,10,15,e,t+2*i[a++]),Na(1,6,11,12,e,t+2*i[a++]),Ga(1,6,11,12,e,t+2*i[a++]),Na(2,7,8,13,e,t+2*i[a++]),Ga(2,7,8,13,e,t+2*i[a++]),Na(3,4,9,14,e,t+2*i[a++]),Ga(3,4,9,14,e,t+2*i[a++]);this.v0l^=La[0]^La[16],this.v0h^=La[1]^La[17],this.v1l^=La[2]^La[18],this.v1h^=La[3]^La[19],this.v2l^=La[4]^La[20],this.v2h^=La[5]^La[21],this.v3l^=La[6]^La[22],this.v3h^=La[7]^La[23],this.v4l^=La[8]^La[24],this.v4h^=La[9]^La[25],this.v5l^=La[10]^La[26],this.v5h^=La[11]^La[27],this.v6l^=La[12]^La[28],this.v6h^=La[13]^La[29],this.v7l^=La[14]^La[30],this.v7h^=La[15]^La[31],Ge(La)}destroy(){this.destroyed=!0,Ge(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const qa=Ye((e=>new Va(e))),Wa=/^vector<(.+)>$/,Ha=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/;class Ka{static parseFromStr(e,t=!1){if("address"===e)return{address:null};if("bool"===e)return{bool:null};if("u8"===e)return{u8:null};if("u16"===e)return{u16:null};if("u32"===e)return{u32:null};if("u64"===e)return{u64:null};if("u128"===e)return{u128:null};if("u256"===e)return{u256:null};if("signer"===e)return{signer:null};const n=e.match(Wa);if(n)return{vector:Ka.parseFromStr(n[1],t)};const s=e.match(Ha);if(s){return{struct:{address:t?$a(s[1]):s[1],module:s[2],name:s[3],typeParams:void 0===s[5]?[]:Ka.parseStructTypeArgs(s[5],t)}}}throw Error("Encountered unexpected token when parsing type args for "+e)}static parseStructTypeArgs(e,t=!1){return aa(e).map((e=>Ka.parseFromStr(e,t)))}static tagToString(e){if("bool"in e)return"bool";if("u8"in e)return"u8";if("u16"in e)return"u16";if("u32"in e)return"u32";if("u64"in e)return"u64";if("u128"in e)return"u128";if("u256"in e)return"u256";if("address"in e)return"address";if("signer"in e)return"signer";if("vector"in e)return`vector<${Ka.tagToString(e.vector)}>`;if("struct"in e){const t=e.struct,n=t.typeParams.map(Ka.tagToString).join(", ");return`${t.address}::${t.module}::${t.name}${n?`<${n}>`:""}`}throw Error("Invalid TypeTag")}}const Ja=Ea.bytes(32).transform({validate:e=>{const t="string"==typeof e?e:na(e);if(!t||!Aa($a(t)))throw Error("Invalid Sui address "+t)},input:e=>"string"==typeof e?ta($a(e)):e,output:e=>$a(na(e))}),Za=Ea.vector(Ea.u8()).transform({name:"ObjectDigest",input:e=>Xr(e),output:e=>Zr(new Uint8Array(e)),validate:e=>{if(32!==Xr(e).length)throw Error("ObjectDigest must be 32 bytes")}}),Xa=Ea.struct("SuiObjectRef",{objectId:Ja,version:Ea.u64(),digest:Za}),Ya=Ea.struct("SharedObjectRef",{objectId:Ja,initialSharedVersion:Ea.u64(),mutable:Ea.bool()}),Qa=Ea.enum("ObjectArg",{ImmOrOwnedObject:Xa,SharedObject:Ya,Receiving:Xa}),ei=Ea.enum("Owner",{AddressOwner:Ja,ObjectOwner:Ja,Shared:Ea.struct("Shared",{initialSharedVersion:Ea.u64()}),Immutable:null,ConsensusV2:Ea.struct("ConsensusV2",{authenticator:Ea.enum("Authenticator",{SingleOwner:Ja}),startVersion:Ea.u64()})}),ti=Ea.enum("CallArg",{Pure:Ea.struct("Pure",{bytes:Ea.vector(Ea.u8()).transform({input:e=>"string"==typeof e?Yr(e):e,output:e=>ea(new Uint8Array(e))})}),Object:Qa}),ni=Ea.enum("TypeTag",{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:Ea.lazy((()=>ni)),struct:Ea.lazy((()=>hi)),u16:null,u32:null,u256:null}),si=ni.transform({input:e=>"string"==typeof e?Ka.parseFromStr(e,!0):e,output:e=>Ka.tagToString(e)}),ri=Ea.enum("Argument",{GasCoin:null,Input:Ea.u16(),Result:Ea.u16(),NestedResult:Ea.tuple([Ea.u16(),Ea.u16()])}),ai=Ea.struct("ProgrammableMoveCall",{package:Ja,module:Ea.string(),function:Ea.string(),typeArguments:Ea.vector(si),arguments:Ea.vector(ri)}),ii=Ea.enum("Command",{MoveCall:ai,TransferObjects:Ea.struct("TransferObjects",{objects:Ea.vector(ri),address:ri}),SplitCoins:Ea.struct("SplitCoins",{coin:ri,amounts:Ea.vector(ri)}),MergeCoins:Ea.struct("MergeCoins",{destination:ri,sources:Ea.vector(ri)}),Publish:Ea.struct("Publish",{modules:Ea.vector(Ea.vector(Ea.u8()).transform({input:e=>"string"==typeof e?Yr(e):e,output:e=>ea(new Uint8Array(e))})),dependencies:Ea.vector(Ja)}),MakeMoveVec:Ea.struct("MakeMoveVec",{type:(oi=si,Ea.enum("Option",{None:null,Some:oi})).transform({input:e=>null===e?{None:!0}:{Some:e},output:e=>e.Some??null}),elements:Ea.vector(ri)}),Upgrade:Ea.struct("Upgrade",{modules:Ea.vector(Ea.vector(Ea.u8()).transform({input:e=>"string"==typeof e?Yr(e):e,output:e=>ea(new Uint8Array(e))})),dependencies:Ea.vector(Ja),package:Ja,ticket:ri})});var oi;const ci=Ea.struct("ProgrammableTransaction",{inputs:Ea.vector(ti),commands:Ea.vector(ii)}),ui=Ea.enum("TransactionKind",{ProgrammableTransaction:ci,ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null}),li=Ea.enum("TransactionExpiration",{None:null,Epoch:Ea.u64({name:"unsafe_u64",...di}).transform({input:e=>e,output:e=>Number(e)})});var di;const hi=Ea.struct("StructTag",{address:Ja,module:Ea.string(),name:Ea.string(),typeParams:Ea.vector(ni)}),pi=Ea.struct("GasData",{payment:Ea.vector(Xa),owner:Ja,price:Ea.u64(),budget:Ea.u64()}),mi=Ea.struct("TransactionDataV1",{kind:ui,sender:Ja,gasData:pi,expiration:li}),gi=Ea.enum("TransactionData",{V1:mi}),fi=Ea.enum("IntentScope",{TransactionData:null,TransactionEffects:null,CheckpointSummary:null,PersonalMessage:null}),yi=Ea.enum("IntentVersion",{V0:null}),bi=Ea.enum("AppId",{Sui:null}),wi=Ea.struct("Intent",{scope:fi,version:yi,appId:bi});function vi(e){return Ea.struct(`IntentMessage<${e.name}>`,{intent:wi,value:e})}const xi=Ea.enum("CompressedSignature",{ED25519:Ea.fixedArray(64,Ea.u8()),Secp256k1:Ea.fixedArray(64,Ea.u8()),Secp256r1:Ea.fixedArray(64,Ea.u8()),ZkLogin:Ea.vector(Ea.u8())}),ki=Ea.enum("PublicKey",{ED25519:Ea.fixedArray(32,Ea.u8()),Secp256k1:Ea.fixedArray(33,Ea.u8()),Secp256r1:Ea.fixedArray(33,Ea.u8()),ZkLogin:Ea.vector(Ea.u8())}),Ii=Ea.struct("MultiSigPkMap",{pubKey:ki,weight:Ea.u8()}),Ei=Ea.struct("MultiSigPublicKey",{pk_map:Ea.vector(Ii),threshold:Ea.u16()}),Pi=Ea.struct("MultiSig",{sigs:Ea.vector(xi),bitmap:Ea.u16(),multisig_pk:Ei}),Ti=Ea.vector(Ea.u8()).transform({input:e=>"string"==typeof e?Yr(e):e,output:e=>ea(new Uint8Array(e))}),Si=Ea.struct("SenderSignedTransaction",{intentMessage:vi(gi),txSignatures:Ea.vector(Ti)}),Ci=Ea.vector(Si,{name:"SenderSignedData"}),Oi=Ea.struct("PasskeyAuthenticator",{authenticatorData:Ea.vector(Ea.u8()),clientDataJson:Ea.string(),userSignature:Ea.vector(Ea.u8())}),ji=Ea.enum("PackageUpgradeError",{UnableToFetchPackage:Ea.struct("UnableToFetchPackage",{packageId:Ja}),NotAPackage:Ea.struct("NotAPackage",{objectId:Ja}),IncompatibleUpgrade:null,DigestDoesNotMatch:Ea.struct("DigestDoesNotMatch",{digest:Ea.vector(Ea.u8())}),UnknownUpgradePolicy:Ea.struct("UnknownUpgradePolicy",{policy:Ea.u8()}),PackageIDDoesNotMatch:Ea.struct("PackageIDDoesNotMatch",{packageId:Ja,ticketId:Ja})}),Ai=Ea.struct("ModuleId",{address:Ja,name:Ea.string()}),Bi=Ea.struct("MoveLocation",{module:Ai,function:Ea.u16(),instruction:Ea.u16(),functionName:Ea.option(Ea.string())}),Ui=Ea.enum("CommandArgumentError",{TypeMismatch:null,InvalidBCSBytes:null,InvalidUsageOfPureArg:null,InvalidArgumentToPrivateEntryFunction:null,IndexOutOfBounds:Ea.struct("IndexOutOfBounds",{idx:Ea.u16()}),SecondaryIndexOutOfBounds:Ea.struct("SecondaryIndexOutOfBounds",{resultIdx:Ea.u16(),secondaryIdx:Ea.u16()}),InvalidResultArity:Ea.struct("InvalidResultArity",{resultIdx:Ea.u16()}),InvalidGasCoinUsage:null,InvalidValueUsage:null,InvalidObjectByValue:null,InvalidObjectByMutRef:null,SharedObjectOperationNotAllowed:null}),Mi=Ea.enum("TypeArgumentError",{TypeNotFound:null,ConstraintNotSatisfied:null}),$i=Ea.enum("ExecutionFailureStatus",{InsufficientGas:null,InvalidGasObject:null,InvariantViolation:null,FeatureNotYetSupported:null,MoveObjectTooBig:Ea.struct("MoveObjectTooBig",{objectSize:Ea.u64(),maxObjectSize:Ea.u64()}),MovePackageTooBig:Ea.struct("MovePackageTooBig",{objectSize:Ea.u64(),maxObjectSize:Ea.u64()}),CircularObjectOwnership:Ea.struct("CircularObjectOwnership",{object:Ja}),InsufficientCoinBalance:null,CoinBalanceOverflow:null,PublishErrorNonZeroAddress:null,SuiMoveVerificationError:null,MovePrimitiveRuntimeError:Ea.option(Bi),MoveAbort:Ea.tuple([Bi,Ea.u64()]),VMVerificationOrDeserializationError:null,VMInvariantViolation:null,FunctionNotFound:null,ArityMismatch:null,TypeArityMismatch:null,NonEntryFunctionInvoked:null,CommandArgumentError:Ea.struct("CommandArgumentError",{argIdx:Ea.u16(),kind:Ui}),TypeArgumentError:Ea.struct("TypeArgumentError",{argumentIdx:Ea.u16(),kind:Mi}),UnusedValueWithoutDrop:Ea.struct("UnusedValueWithoutDrop",{resultIdx:Ea.u16(),secondaryIdx:Ea.u16()}),InvalidPublicFunctionReturnType:Ea.struct("InvalidPublicFunctionReturnType",{idx:Ea.u16()}),InvalidTransferObject:null,EffectsTooLarge:Ea.struct("EffectsTooLarge",{currentSize:Ea.u64(),maxSize:Ea.u64()}),PublishUpgradeMissingDependency:null,PublishUpgradeDependencyDowngrade:null,PackageUpgradeError:Ea.struct("PackageUpgradeError",{upgradeError:ji}),WrittenObjectsTooLarge:Ea.struct("WrittenObjectsTooLarge",{currentSize:Ea.u64(),maxSize:Ea.u64()}),CertificateDenied:null,SuiMoveVerificationTimedout:null,SharedObjectOperationNotAllowed:null,InputObjectDeleted:null,ExecutionCancelledDueToSharedObjectCongestion:Ea.struct("ExecutionCancelledDueToSharedObjectCongestion",{congestedObjects:Ea.vector(Ja)}),AddressDeniedForCoin:Ea.struct("AddressDeniedForCoin",{address:Ja,coinType:Ea.string()}),CoinTypeGlobalPause:Ea.struct("CoinTypeGlobalPause",{coinType:Ea.string()}),ExecutionCancelledDueToRandomnessUnavailable:null}),zi=Ea.enum("ExecutionStatus",{Success:null,Failed:Ea.struct("ExecutionFailed",{error:$i,command:Ea.option(Ea.u64())})}),Di=Ea.struct("GasCostSummary",{computationCost:Ea.u64(),storageCost:Ea.u64(),storageRebate:Ea.u64(),nonRefundableStorageFee:Ea.u64()}),Ri=Ea.struct("TransactionEffectsV1",{status:zi,executedEpoch:Ea.u64(),gasUsed:Di,modifiedAtVersions:Ea.vector(Ea.tuple([Ja,Ea.u64()])),sharedObjects:Ea.vector(Xa),transactionDigest:Za,created:Ea.vector(Ea.tuple([Xa,ei])),mutated:Ea.vector(Ea.tuple([Xa,ei])),unwrapped:Ea.vector(Ea.tuple([Xa,ei])),deleted:Ea.vector(Xa),unwrappedThenDeleted:Ea.vector(Xa),wrapped:Ea.vector(Xa),gasObject:Ea.tuple([Xa,ei]),eventsDigest:Ea.option(Za),dependencies:Ea.vector(Za)}),Fi=Ea.tuple([Ea.u64(),Za]),Li=Ea.enum("ObjectIn",{NotExist:null,Exist:Ea.tuple([Fi,ei])}),Ni=Ea.enum("ObjectOut",{NotExist:null,ObjectWrite:Ea.tuple([Za,ei]),PackageWrite:Fi}),Gi=Ea.enum("IDOperation",{None:null,Created:null,Deleted:null}),_i=Ea.struct("EffectsObjectChange",{inputState:Li,outputState:Ni,idOperation:Gi}),Vi=Ea.enum("UnchangedSharedKind",{ReadOnlyRoot:Fi,MutateDeleted:Ea.u64(),ReadDeleted:Ea.u64(),Cancelled:Ea.u64(),PerEpochConfig:null}),qi=Ea.struct("TransactionEffectsV2",{status:zi,executedEpoch:Ea.u64(),gasUsed:Di,transactionDigest:Za,gasObjectIndex:Ea.option(Ea.u32()),eventsDigest:Ea.option(Za),dependencies:Ea.vector(Za),lamportVersion:Ea.u64(),changedObjects:Ea.vector(Ea.tuple([Ja,_i])),unchangedSharedObjects:Ea.vector(Ea.tuple([Ja,Vi])),auxDataDigest:Ea.option(Za)}),Wi=Ea.enum("TransactionEffects",{V1:Ri,V2:qi});function Hi(e){switch(e){case"u8":return Ea.u8();case"u16":return Ea.u16();case"u32":return Ea.u32();case"u64":return Ea.u64();case"u128":return Ea.u128();case"u256":return Ea.u256();case"bool":return Ea.bool();case"string":return Ea.string();case"id":case"address":return Ja}const t=e.match(/^(vector|option)<(.+)>$/);if(t){const[e,n]=t.slice(1);return"vector"===e?Ea.vector(Hi(n)):Ea.option(Hi(n))}throw Error("Invalid Pure type name: "+e)}const Ki={...Ea,U8:Ea.u8(),U16:Ea.u16(),U32:Ea.u32(),U64:Ea.u64(),U128:Ea.u128(),U256:Ea.u256(),ULEB128:Ea.uleb128(),Bool:Ea.bool(),String:Ea.string(),Address:Ja,AppId:bi,Argument:ri,CallArg:ti,Command:ii,CompressedSignature:xi,GasData:pi,Intent:wi,IntentMessage:vi,IntentScope:fi,IntentVersion:yi,MultiSig:Pi,MultiSigPkMap:Ii,MultiSigPublicKey:Ei,ObjectArg:Qa,ObjectDigest:Za,Owner:ei,PasskeyAuthenticator:Oi,ProgrammableMoveCall:ai,ProgrammableTransaction:ci,PublicKey:ki,SenderSignedData:Ci,SenderSignedTransaction:Si,SharedObjectRef:Ya,StructTag:hi,SuiObjectRef:Xa,TransactionData:gi,TransactionDataV1:mi,TransactionEffects:Wi,TransactionExpiration:li,TransactionKind:ui,TypeTag:si};let Ji;const Zi=async()=>{if(Ji)return Ji;const e=await Promise.resolve().then((function(){return Ml}));return Ji=new e.SuiClient({url:"https://fullnode.mainnet.sui.io:443"}),Ji},Xi=async({transaction:e,txRaw:t,address:n})=>{let s,r;const a=await Zi();try{s=h.from(e),JSON.parse(e).sender||s.setSender(n),r=await s.build({client:a})}catch(e){t.setSenderIfNotSet(n),r=await t.build({client:a})}return r};class Yi{address;core=null;constructor(){}async getAddress(){try{const e=await ar(this.core.clientId);if(!e.result||!e.result.suiAddress)throw Error("Get address key failed.");return this.address=e.result.suiAddress,this.address}catch(e){throw e}}setCore(e){this.core=e}signTransaction=async e=>{try{this.address||await this.getAddress();let n=await e.transaction.toJSON();try{if(!JSON.parse(n).sender){const e=h.from(n);e.setSender(this.address),n=await e.toJSON()}}catch(e){}const s=((e,n)=>{const{reqType:s,address:r}=n;return{eventId:t(),chainType:"sui",origin:window.location.origin,accessToken:Ks(e),address:r,reqType:s,txMeta:n.params}})(this.core.clientId,{reqType:Fs,address:this.address,params:{type:"sign",transaction:n}}),r=await fr(s,this.core);if(!r||"cancel"===r.toLowerCase())throw"user cancel";const a=await(async e=>{const{data:t}=await kr.post("socialLogin/projectWallet/sui/signTransaction",e,{headers:{mfa:e.mfa}}).catch((e=>{const t=e?.response?.data?.message;return Promise.reject(t||"Failed to sign transaction")}));return t})({tx:n,url:"https://fullnode.mainnet.sui.io:443",mfa:r}),{result:i}=a;return{bytes:ea(await Xi({transaction:n,address:this.address,txRaw:e.transaction})),signature:i}}catch(e){throw e}};signAndExecuteTransaction=async e=>{try{const t=await this.signTransaction(e),n=await e.transaction.toJSON(),s={bytes:await Xi({transaction:n,address:this.address,txRaw:e.transaction}),signature:t.signature},r=await(async({bytes:e,signature:t})=>{const n=await Zi();return await n.executeTransactionBlock({transactionBlock:e,signature:t})})(s),a=JSON.stringify(r.effects),i=(new TextEncoder).encode(a);return{digest:r.digest,effects:btoa(String.fromCharCode(...i)),...t}}catch(e){throw e}};async signMessage(e){return await this.signPersonalMessage(e)}async signPersonalMessage(e){try{const t=(new TextDecoder).decode(e.message),n=cr(this.core.clientId,{chainType:"sui",reqType:zs,address:this.address,message:t}),s=await fr(n,this.core);if(!s||"cancel"===s.toLowerCase())return"user cancel";const r=await(async e=>{const{data:t}=await kr.post("socialLogin/projectWallet/sui/signPersonalMessage",e,{headers:{mfa:e.mfa}}).catch((e=>{const t=e?.response?.data?.message;return Promise.reject(t||"Failed to sign message")}));return t})({message:t,mfa:s});return{bytes:ea(e.message),signature:r.result}}catch(e){throw e}}}class Qi{address=null;tronWeb;tronWebPromise;core=null;constructor(){}setCore(e){this.core=e}async getAddress(){try{const e=await ar(this.core.clientId);if(!e.result||!e.result.tronAddress)throw Error("Get address key failed.");return this.address=e.result.tronAddress,this.address}catch(e){throw e}}async signMessage(e,t){this.address||await this.getAddress();const n=cr(this.core.clientId,{chainType:"tron",reqType:zs,address:this.address,message:e});return await fr(n,this.core)}async signTransaction(e){this.address||await this.getAddress();const n=((e,n)=>{const{reqType:s,address:r}=n;return{eventId:t(),chainType:"tron",origin:window.location.origin,accessToken:Ks(e),address:r,reqType:s,txMeta:n.params}})(this.core.clientId,{reqType:Rs,address:this.address,params:{type:"sign",transaction:e}});return await fr(n,this.core)}}async function eo(){const{AccountAddress:e,Aptos:t,APTOS_COIN:n,AptosConfig:s,Serializer:r,SimpleTransaction:a,Ed25519Signature:i,Ed25519PublicKey:o,AccountAuthenticatorEd25519:c,Network:u,AccountAuthenticator:l}=await import("@aptos-labs/ts-sdk");return{AccountAddress:e,Aptos:t,APTOS_COIN:n,AptosConfig:s,Serializer:r,SimpleTransaction:a,Ed25519Signature:i,Ed25519PublicKey:o,AccountAuthenticatorEd25519:c,Network:u,AccountAuthenticator:l}}const to=(()=>{let e=null;return async(t=!1)=>{if(!e){const{AptosConfig:n,Aptos:s,Network:r}=await eo(),a=new n(t?{fullnode:"https://testnet.bardock.movementnetwork.xyz/v1",faucet:"https://faucet.testnet.bardock.movementnetwork.xyz/"}:{fullnode:"https://mainnet.movementnetwork.xyz/v1",network:r.CUSTOM});e=new s(a)}return e}})();var no,so;!function(e){e.APPROVED="Approved",e.REJECTED="Rejected"}(no||(no={}));class ro{address=null;publicKey=null;connected=!1;isConnected=!1;connection;core=null;chainId=126;constructor(){}setCore(e){this.core=e}signTransaction=async(e,n)=>{this.address||await this.getAddress();const s=await(async e=>{const{Serializer:t}=await eo(),n=new t;e.serialize(n);const s=n.toUint8Array();return Buffer.from(s).toString("hex")})(e),r=((e,n)=>{const{reqType:s,address:r}=n;return{eventId:t(),chainType:"movement",origin:window.location.origin,accessToken:Ks(e),address:r,reqType:s,txMeta:n.params}})(this.core.clientId,{reqType:Rs,address:this.address,params:{type:"sign",transaction:e,rawTransaction:s}}),a=await fr(r,this.core);if(!a||"cancel"===a.toLowerCase())throw Error("Sign transaction failed.");const i=await(async e=>{const{data:t}=await kr.post("socialLogin/projectWallet/movement/signTransaction",{rawTransaction:e.rawTransaction},{headers:{mfa:e.mfa}});return t})({rawTransaction:s,mfa:a}),o=await(async e=>{try{const{Ed25519Signature:t,Ed25519PublicKey:n,AccountAuthenticatorEd25519:s}=await eo(),r=JSON.parse(e),{publicKey:a,sig:i}=r,o=new t(i);return new s(new n(a),o)}catch(e){throw Error("sign error")}})(i.result);return{status:no.APPROVED,args:o}};signMessage=async e=>{const{message:t,nonce:n}=e,s=`${t}${n}`,r=cr(this.core.clientId,{chainType:"movement",reqType:zs,address:this.address,message:t}),a=await fr(r,this.core);if(!a||"cancel"===a.toLowerCase())return{status:no.REJECTED};const i=await(async e=>{const{data:t}=await kr.post("socialLogin/projectWallet/movement/signMessage",{message:e.message},{headers:{mfa:e.mfa}});return t})({message:s,mfa:a});return{status:no.APPROVED,args:{address:this.address,fullMessage:s,message:t,nonce:n,prefix:"APTOS",signature:i.result}}};signAndSubmitTransaction=async e=>{this.address||await this.getAddress();const t=e.payload,n=250===this.chainId,s=await to(n),{AccountAddress:r}=await eo(),a=await s.transaction.build.simple({sender:r.fromString(this.address),data:t}),i=await this.signTransaction(a),o=await(async({txn:e,senderAuthenticator:t,isTestnet:n=!1})=>{const s=await to(n);return await s.transaction.submit.simple({transaction:e,senderAuthenticator:t})})({txn:a,senderAuthenticator:i.args,isTestnet:n});return await(async(e,t=!1)=>{const n=await to(t);return await n.waitForTransaction({transactionHash:e})})(o.hash,n),{status:no.APPROVED,args:o}};getAddress=async()=>{try{const e=await ar(this.core.clientId);if(!e.result||!e.result.movementAddress)throw Error("Get address key failed.");return this.address=e.result.movementAddress,this.address}catch(e){throw e}};switchChain=async e=>{this.chainId=e};connect=async()=>{};disconnect=async()=>{}}function ao(e){return!Ns.includes(e)&&(Ns.push(e),!0)}function io(e){var t;t=Ns.filter((t=>t!==e)),Ns=t}!function(e){e.Login="login",e.Link="link"}(so||(so={}));const oo={[Cs.signReq]:({data:e},t)=>{ao(e.eventId)&&(t.events.emit(`${As}#${e.eventId}`,e),io(e.eventId))},[Cs.mfaCreate]:({data:e},t)=>{ao(e.eventId)&&(t.events.emit(`${Us}#${e.eventId}`,e),io(e.eventId))},[Cs.normalReq]:({data:e},t)=>{ao(e.eventId)&&(t.events.emit(`${Bs}#${e.eventId}`,e),io(e.eventId))},[Cs.telegramAuth]:async({data:e,action:t},n)=>{if(e&&ao(n.telegramAuthEventId))try{let s;s=t===so.Link?await n.linkTelegram(e):await n.loginByTelegram(e),n.events.emit(`${$s}#${n.telegramAuthEventId}`,s)}catch(e){n.events.emit(`${$s}#${n.telegramAuthEventId}`,!1)}finally{io(n.telegramAuthEventId)}},[Cs.googleAuth]:async({data:e,action:t},n)=>{if(e?.code&&ao(n.googleAuthEventId))try{let s;s=t===so.Link?await n.linkGoogle(e.code):await n.loginByGoogle(e.code),n.events.emit(`${Os}#${n.googleAuthEventId}`,s)}catch(e){n.events.emit(`${Os}#${n.googleAuthEventId}`,!1)}finally{io(n.googleAuthEventId)}},[Cs.xAuth]:async({data:e,action:t},n)=>{if(e&&ao(e.eventId)){Gs.debug("xEvents:",Ns);try{if(e?.code){let s;s=t===so.Link?await n.linkTwitter(e.code):await n.loginByTwitter(e.code),n.events.emit(`${js}#${e.eventId}`,s)}else e?.error&&n.events.emit(`${js}#${e.eventId}`,!1)}catch(t){n.events.emit(`${js}#${e.eventId}`,!1)}finally{io(e.eventId)}}},[Cs.kakaoAuth]:async({data:e},t)=>{if(!e.code)return;if(!ao(t.kakaoAuthEventId))return;const s=p.stringify({grant_type:"authorization_code",client_id:Ps,redirect_uri:Ts,code:e.code});try{const e=await n.post("https://kauth.kakao.com/oauth/token",s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!e?.data?.access_token)throw Error("access_token is empty");const r=await t.loginByKakao(e.data.access_token);t.events.emit(`${Ms}#${t.kakaoAuthEventId}`,r)}catch(e){t.events.emit(`${Ms}#${t.kakaoAuthEventId}`,!1)}finally{io(t.kakaoAuthEventId)}}};let co;function uo(){return co||(co=new u("https://rpc.ankr.com/solana/c2d7e8a3db5dce62e202db3d28cca25e74da5028abbf20764e2961918ba34dfc","finalized"),co)}async function lo(e,t,n,s){try{uo();const r=new l,a=new c(e),i=new c(t);if(r.feePayer||(r.feePayer=a),s){const o=new c(s),u=await f(o,new c(e)),l=await f(o,new c(t));let d;r.recentBlockhash=(await co.getLatestBlockhash()).blockhash;try{d=await y(co,l)}catch(e){if(!(e instanceof b||e instanceof w))throw e;try{r.add(v(a,l,i,o))}catch(e){}}r.add(x(u,l,a,n,[],k))}else r.recentBlockhash=(await co.getLatestBlockhash()).blockhash,r.add(d.transfer({fromPubkey:a,toPubkey:i,lamports:n}));return r}catch(e){return null}}async function ho(e){let t,n="",s="",r=0;const a=uo();for(const i of e.instructions)if(i.programId.equals(k)&&3===i.data[0]){const e=i.data.slice(1,9);r=Number(new E(e,"le"));const o=i.keys[0]?.pubkey,c=i.keys[1]?.pubkey;try{const e=await y(a,c);t=""+e.mint,s=""+e.owner}catch(e){}if(!n&&o)try{n=""+(await y(a,o)).owner}catch(e){}}for(const n of e.instructions)if(n.programId.equals(I)){const e=n.keys[3]?.pubkey,r=n.keys[2]?.pubkey;e&&r&&(t=""+e,s=""+r)}for(const t of e.instructions)if(t.programId.equals(d.programId)&&2===t.data[0]){const e=t.keys[0]?.pubkey.toString(),a=t.keys[1]?.pubkey.toString(),i=t.data.slice(4);r=Number(new E(i,"le")),n=e,s=a}return{from:n,to:s,value:r,mintAddress:t}}const po="https://social-relay-dev.tomo.inc",mo=ks,go=["google","twitter","kakao","telegram"];class fo{connectUrl=xr;relayBase=ks;events=new e;clientId="";chainConfig={chainId:1,rpcUrl:Zn.rpcUrls.default.http[0]};ethereumProvider;bitcoinProvider;solanaProvider;tronProvider;movementProvider;suiProvider;googleAuthEventId=""+Date.now();kakaoAuthEventId=""+Date.now();telegramAuthEventId=""+Date.now();walletDomain;constructor({clientId:e,connect:t,relayBase:n,ethereumProvider:s,walletDomain:r}){if(!e)throw Error("clientId is required");this.clientId=e,this.connectUrl=t||xr,this.relayBase=n||ks,this.walletDomain=r||"https://tomotg.tomo.inc",s&&(this.ethereumProvider=s,this.ethereumProvider.setCore(this)),this._initialize(),"undefined"!=typeof window&&(window.onmessage=this.msgProcessor.bind(this))}_initialize(){Er(this),Gs.setLevel("silent"),Gs.debug("relay base url:",this.relayBase),this.solanaProvider=new Lr,this.solanaProvider.setCore(this),this.tronProvider=new Qi,this.tronProvider.setCore(this),this.movementProvider=new ro,this.movementProvider.setCore(this),this.suiProvider=new Yi,this.suiProvider.setCore(this),this.bitcoinProvider=new $r,this.bitcoinProvider.setCore(this),this.ethereumProvider||(this.ethereumProvider=new Fr,this.ethereumProvider.setCore(this))}msgProcessor({origin:e,data:{type:t,data:n,action:s}}){return(({origin:e,data:{type:t,data:n,action:s}},r)=>{if(Gs.debug("messageProcessor:",e,t,n,s,r.relayBase),e!==r.relayBase&&e!==ks)return;const a=oo[t];a&&a({data:n,action:s},r)})({origin:e,data:{type:t,data:n,action:s}},this)}login(e,n={}){if(!go.includes(e))throw Error("Unsupported login type: "+e);const s=n?.action||so.Login,r=window.location.origin;return"google"===e?new Promise(((e,t)=>{const n=JSON.stringify({origin:r,action:s}),a=hr({url:`https://accounts.google.com/o/oauth2/v2/auth?response_type=id_token&client_id=479465761311-5da6b2ic7io7odr9jnrldai20046vk4t.apps.googleusercontent.com&scope=openid&access_type=offline&state=${encodeURIComponent(n)}&nonce=testnonce&prompt=select_account&redirect_uri=${Ss}`,name:s===so.Link?"Link Google":"Google login"});this.googleAuthEventId=""+Date.now(),gr(a,this.events,Os,this.googleAuthEventId),this.events.once(`${Os}#${this.googleAuthEventId}`,(async n=>{Gs.debug("google login data:",n,s),n?e(!0):t(!1)}))})):"twitter"===e?new Promise(((e,n)=>{const a=s===so.Link?"Link X":"X login",i=js,o=t=>{t?e(!0):n(!1)},c=t();gr(hr({url:`${Es}?target=${r}&eventId=${c}&action=${s}`,name:a}),this.events,i,c),this.events.once(`${i}#${c}`,o)})):"kakao"===e?new Promise(((e,t)=>{const n=hr({url:`https://kauth.kakao.com/oauth/authorize?client_id=${Ps}&redirect_uri=${encodeURIComponent(Ts)}&response_type=code`,name:"Kakao Login",width:800});this.kakaoAuthEventId=""+Date.now(),gr(n,this.events,Ms,this.kakaoAuthEventId),this.events.once(`${Ms}#${this.kakaoAuthEventId}`,(n=>{Gs.debug("kakao login data:",n),n?e(!0):t(!1)}))})):"telegram"===e?new Promise(((e,t)=>{const n=hr({url:`${this.relayBase}/telegram?action=${s}`,name:s===so.Link?"Link Telegram":"Telegram Login"});this.telegramAuthEventId=""+Date.now(),gr(n,this.events,$s,this.telegramAuthEventId),this.events.once(`${$s}#${this.telegramAuthEventId}`,(n=>{Gs.debug("telegram login data:",n),n?e(!0):t(!1)}))})):void 0}linkSocial(e){return this.login(e,{action:so.Link})}async getLinkSocialInfo(){const e=await(async()=>{const{data:e}=await kr.get("socialLogin/projectUser/bound/status");return e})();if(!e.result)throw Error("get linked social info failed");return e.result}async loginByGoogle(e){try{const t=await(async(e,t)=>{try{const{data:n}=await kr.post("socialLogin/projectUser/loginByGoogle",{code:e,clientId:t});return n}catch(e){}})(e,this.clientId),n=t.result.token;if(!n)throw Error("Login failed");Js(this.clientId,n);const s=t.result?.userInfoDTO?.id;return Xs(this.clientId,""+s),Qs(this.clientId,"google"),sr(),ir(),!0}catch(e){return!1}}async linkGoogle(e){try{if(!(await Tr({googleCode:e})).result)throw Error("Link failed");return!0}catch(e){return!1}}async loginByKakao(e){try{const t=await(async(e,t)=>{try{const{data:n}=await kr.post("socialLogin/projectUser/loginByKakao",{accessToken:e,clientId:t});return n}catch(e){}})(e,this.clientId),n=t.result.token;if(!n)throw Error("Login failed");Js(this.clientId,n);const s=t.result?.userInfoDTO?.id;return Xs(this.clientId,""+s),Qs(this.clientId,"kakao"),sr(),ir(),!0}catch(e){return!1}}async loginByTelegram(e){try{const t=await(async(e,t)=>{try{const{data:n}=await kr.post("socialLogin/projectUser/loginByTelegram",{telegramAuthData:e,clientId:t});return n}catch(e){}})(e,this.clientId),n=t.result.token;if(!n)throw Error("Login failed");Js(this.clientId,n);const s=t.result?.userInfoDTO?.id;return Xs(this.clientId,""+s),Qs(this.clientId,"telegram"),sr(),ir(),!0}catch(e){return!1}}async linkTelegram(e){try{if(!(await Tr({telegramAuthData:e})).result)throw Error("Link failed");return!0}catch(e){return!1}}async loginByTwitter(e){try{const t=await(async(e,t)=>{try{const{data:n}=await kr.post("socialLogin/projectUser/loginByTwitter",{code:e,redirectUri:Is,clientId:t});return n}catch(e){}})(e,this.clientId),n=t.result.token;if(!n)throw Error("Login failed");Js(this.clientId,n);const s=t.result?.userInfoDTO?.id;return Xs(this.clientId,""+s),Qs(this.clientId,"twitter"),sr(),ir(),!0}catch(e){return!1}}async linkTwitter(e){try{if(!(await Tr({twitterCode:e,twitterRedirectUri:Is})).result)throw Error("Link failed");return!0}catch(e){return!1}}async sendCode(e){try{const t=await(async e=>{try{const{data:t}=await n.get(`${Ir}login/emailCheck?email=${e}`);return t}catch(e){}})(e);if(t.result){await(async(e,t)=>{try{const{data:n}=await kr.get(`socialLogin/projectUser/email/sendRegister?email=${e}&clientId=${t}`);return n}catch(e){}})(e,this.clientId);nr(JSON.stringify({type:"signup",email:e}))}else{await(async(e,t)=>{try{const{data:n}=await kr.get(`socialLogin/projectUser/email/loginCode?email=${e}&clientId=${t}`);return n}catch(e){}})(e,this.clientId);nr(JSON.stringify({type:"signin",email:e}))}return!0}catch(e){return!1}}async verifyCode(e){try{const t=tr();if(!t||!t.email||"signup"!==t.type&&"signin"!==t.type)throw Error("Invalid request");let n;n="signup"===t.type?await(async(e,t,n)=>{try{const{data:s}=await kr.post("socialLogin/projectUser/email/verifyRegister",{email:e,code:t,clientId:n});return s}catch(e){}})(t.email,e,this.clientId):await(async(e,t,n)=>{try{const{data:s}=await kr.post("socialLogin/projectUser/email/loginVerify",{email:e,code:t,clientId:n});return s}catch(e){}})(t.email,e,this.clientId);const s=n.result.token,r=n.result?.userInfoDTO?.id;if(!s)throw Error("Login failed");return Js(this.clientId,s),Xs(this.clientId,""+r),Qs(this.clientId,"email"),sr(),ir(),!0}catch(e){return!1}}handleLoginByEmailSuccess(e){Js(this.clientId,e),sr(),ir()}async getEthAddress(){try{const e=await ar(this.clientId);if(!e.result)throw Error("Get address failed.");return e.result.evmAddress}catch(e){return null}}async getPrices(e){try{const t=await(async e=>{try{const{data:t}=await n.get(`${Ir}extension/price?symbol=${e}`);return t}catch(e){}})(e);return t.result}catch(e){return null}}async logout(){Ws(this.clientId,"token",null),(e=>{Ws(e,"userId",null)})(this.clientId),(e=>{Ws(e,"loginType",null)})(this.clientId),sr(),ir()}async tradePaswordStatus(){try{return!!(await(async()=>{const{data:e}=await kr.get("/socialLogin/teleGram/user/tradePaswordStatus");return e})()).result}catch(e){throw Error("Failed to send bind email code")}}async requestAccounts(e){try{const n=await this.getCustomization(),s=n?.theme?.projectName,r=function(){const e=document.getElementsByTagName("link");for(let t=0;e.length>t;t++)if("icon"===e[t].rel||"shortcut icon"===e[t].rel)return e[t].href;return null}(),a={eventId:t(),origin:window.location.origin,icon:r,projectName:s,accessToken:Ks(this.clientId),reqType:"requestAccounts",chainType:e||"evm"},i=await br(a,this);return await async function(e){const{clientId:t}=e,n=Ks(t),s=document.createElement("iframe");s.style.display="none",s.src=e.relayBase+"/normal",document.body.appendChild(s);try{return await new Promise((e=>{const r=a=>{if("READY"===a.data.status){const e={auth:{userId:Zs(t),clientId:t,jwt:n,setIframeToken:!0}};s.contentWindow?.postMessage(e,"*")}else a.data.setTokenSuccess&&(window.removeEventListener("message",r),e(""))};window.addEventListener("message",r)}))}catch(e){}finally{document.body.removeChild(s)}}(this),i}catch(e){throw Error("Failed to request accounts",e)}}async verifyLoginEmail(e){const n=tr();if(!n||!n.email||"signup"!==n.type&&"signin"!==n.type)throw Error("Invalid request");try{const s={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"verifyLoginEmail",email:e,clientId:this.clientId,type:n.type};return await br(s,this)}catch(e){throw Error("Failed to get code")}}async setPayPinAndEmail(){try{const e={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"setPayPinAndEmail"};return await br(e,this)}catch(e){throw Error("Failed to set pay pin")}}async setPayPin(){try{const e={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"setPayPin"};return await br(e,this)}catch(e){throw Error("Failed to set pay pin")}}async changePayPin(){try{const e={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"changePayPin"};return await br(e,this)}catch(e){throw Error("Failed to change pay pin")}}async bindEmail(){try{const e={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"bindEmail"};return await br(e,this)}catch(e){throw Error("Failed to bind Email")}}async addRecoveryEmail(e){try{const n={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"addRecoveryEmail",type:e};return await br(n,this)}catch(e){throw Error("Failed to add recovery Email")}}async hasEmail(){try{return!!(await(async()=>{const{data:e}=await kr.get("socialLogin/projectUser/email");return e})()).result}catch(e){throw Error("Failed to get result")}}async bindEmailCode(e){try{const t=await(async e=>{const{data:t}=await kr.get("socialLogin/projectUser/bindEmailCode?email="+e);return t})(e);return!!t.result}catch(e){throw Error("Failed to send bind email code")}}async bindEmailCodeVerify(e,t){try{const n=await(async(e,t)=>{const{data:n}=await kr.post("socialLogin/projectUser/bindEmailCodeVerify",{email:e,code:t});return n})(e,t);return!!n.result}catch(e){throw Error("Failed to verify bind email code")}}async getDefaultTokens(){try{return(await(async()=>{const{data:e}=await n.get(Ir+"wallet/defaultTokens");return e})()).result}catch(e){throw Error("Failed to get default tokens")}}async getDashboardTokens(e,t){try{const n=await(async(e,t)=>{const{data:n}=await kr.get(`${Ir}socialLogin/projectUser/getTokensOnClientId?clientId=${e}&chainId=${t}`);return n})(e,t);return n.result}catch(e){throw Error("Failed to get default tokens")}}async searchToken(e){try{const t=await(async e=>{const{data:t}=await n.get(`${Ir}wallet/tokens/search?content=${e}`);return t})(e);return t.result}catch(e){throw Error("Failed to search token")}}async getHoldEvmTokens(e){try{const t=await(async e=>{const{data:t}=await n.get(`${Ir}wallet/holdingTokensOnEthereum?address=${e}`);return t})(e);return t.result}catch(e){throw Error("Failed to get hold evm tokens")}}async getHoldSolTokens(e){try{const t=await(async e=>{const{data:t}=await n.get(`${Ir}wallet/holdingTokensOnSolana?address=${e}`);return t})(e);return t.result}catch(e){throw Error("Failed to get hold solana tokens")}}async getUserWalletTokens(e){try{const t=await(async e=>{const{data:t}=await kr.get("socialLogin/projectWallet/userWalletTokens?address="+e);return t})(e);return t.result}catch(e){throw Error("Failed to get tokens")}}async userWalletTokensUpdate(e){try{const t=await(async e=>{const{data:t}=await kr.post("socialLogin/projectWallet/userWalletTokens",{tokens:e});return t})(e);return t.result}catch(e){throw Error("Failed to update tokens")}}async userWalletTokenAdd(e,t){try{const n=await(async(e,t)=>{const{data:n}=await kr.post("socialLogin/projectWallet/userWalletTokens/add",{token:e,walletAddress:t});return n})(e,t);return n.result}catch(e){throw Error("Failed to add token")}}async userWalletTokenRemove(e,t){try{const n=await(async(e,t)=>{const{data:n}=await kr.post("socialLogin/projectWallet/userWalletTokens/remove",{token:e,walletAddress:t});return n})(e,t);return n.result}catch(e){throw Error("Failed to remove token")}}async createPasskey(){try{const e={eventId:t(),origin:window.location.origin,accessToken:Ks(this.clientId),reqType:"passkey"};return await(async(e,t)=>{const n=Ys(t.clientId);e.loginType=n;const s=or(r.stringify(e)),a=hr({url:`${t.relayBase}/mfa?req=${s}`,name:"mfa Request"});return new Promise(((n,s)=>{gr(a,t.events,Us,e.eventId),t.events.once(`${Us}#${e.eventId}`,(e=>{Gs.debug("result:",e),t.getEthAddress().then((t=>{e.error?(er(t,!1),s(e.error)):(er(t,!0),n(e.result))})).catch((e=>{s(e)}))}))}))})(e,this)}catch(e){throw Error("Failed to create passkey")}}async getPasskeyStatus(){try{const e=(e=>{try{const t=qs();return t?.[e]?.localPasskey}catch(e){return}})(await this.getEthAddress());return{localCreated:e,remoteExised:(await(async()=>{const{data:e}=await kr.get("socialLogin/mfa/passkey/existence");return e})()).result}}catch(e){throw Error("Failed to get passkey status")}}async getJwtToken(){try{return await getAuth(this)}catch(e){throw Error("Failed to get jwt token")}}async getUserSocialInfo(){try{const e=await(async()=>{const{data:e}=await kr.get("socialLogin/projectUser/socialInfo");return e})(),t=e.result?.inviterBound,n=Date.now();if(!t&&18e4>=n-e?.result?.createTime){const e=await(async e=>{const{data:t}=await kr.get("socialLogin/projectUser/ownerUid?clientId="+e);return t})(this.clientId);e.result&&(async e=>{const{data:t}=await kr.post("socialLogin/projectUser/bindInviter",{inviter:e})})(e.result)}return e.result}catch(e){throw Error("Failed to get user social info")}}async getSwapTokens(e){try{const t=await(async e=>{const{data:t}=await kr.get("socialLogin/projectWallet/token/swapList?chain="+e);return t})(e);return t.result}catch(e){throw Error("Failed to get swap tokens")}}async getCustomization(){return(await Cr(this.clientId)).result}static async getCustomization(e){return(await Cr(e)).result}async onboarding(e){try{return await wr(g.ONBOARDING,this,e)}catch(e){throw Error("Failed to onboarding: "+e)}}async openSwap(e){try{return await wr(g.SWAP,this,e)}catch(e){throw Error("Failed to swap: "+e)}}async openChangePayPin(e){try{return await wr(g.CHANGE_PAY_PIN,this,e)}catch(e){throw Error("Failed to change pay pin: "+e)}}async openOnramp(e){try{return await wr(g.ONRAMP,this,e)}catch(e){throw Error("Failed to onramp: "+e)}}async openSend(e){try{return await wr(g.SEND,this,e)}catch(e){throw Error("Failed to send: "+e)}}async openReceive(e){try{return await wr(g.RECEIVE,this,e)}catch(e){throw Error("Failed to receive: "+e)}}closeAllRelayWindow(){dr.forEach((e=>e?.close())),dr.length=0}handleWebWalletInvoke=async(e,t)=>{try{switch(this.closeAllRelayWindow(),e){case g.ONRAMP:this.openOnramp(t);break;case g.SWAP:this.openSwap(t);break;case g.SEND:this.openSend(t);break;case g.RECEIVE:this.openReceive(t);break;case g.CHANGE_PAY_PIN:this.openChangePayPin(t)}}catch(e){}}}const yo={"-32700":"ParseError","-32701":"OversizedRequest","-32702":"OversizedResponse","-32600":"InvalidRequest","-32601":"MethodNotFound","-32602":"InvalidParams","-32603":"InternalError","-32604":"ServerBusy","-32000":"CallExecutionFailed","-32001":"UnknownError","-32003":"SubscriptionClosed","-32004":"SubscriptionClosedWithError","-32005":"BatchesNotSupported","-32006":"TooManySubscriptions","-32050":"TransientError","-32002":"TransactionExecutionClientError"};class bo extends Error{}class wo extends bo{constructor(e,t){super(e),this.code=t,this.type=yo[t]??"ServerError"}}class vo extends bo{constructor(e,t,n){super(e),this.status=t,this.statusText=n}}var xo,ko,Io,Eo,Po,To,So,Co,Oo,jo=e=>{throw TypeError(e)},Ao=(e,t,n)=>t.has(e)||jo("Cannot "+n),Bo=(e,t,n)=>(Ao(e,t,"read from private field"),n?n.call(e):t.get(e)),Uo=(e,t,n)=>t.has(e)?jo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Mo=(e,t,n,s)=>(Ao(e,t,"write to private field"),t.set(e,n),n),$o=(e,t,n)=>(Ao(e,t,"access private method"),n);const zo={WebSocketConstructor:"undefined"!=typeof WebSocket?WebSocket:void 0,callTimeout:3e4,reconnectTimeout:3e3,maxReconnects:5};class Do{constructor(e,t={}){if(Uo(this,So),Uo(this,xo,0),Uo(this,ko,0),Uo(this,Io,null),Uo(this,Eo,null),Uo(this,Po,new Set),Uo(this,To,new Map),this.endpoint=e,this.options={...zo,...t},!this.options.WebSocketConstructor)throw Error("Missing WebSocket constructor");this.endpoint.startsWith("http")&&(this.endpoint=function(e){const t=new URL(e);return t.protocol=t.protocol.replace("http","ws"),""+t}(this.endpoint))}async makeRequest(e,t,n){const s=await $o(this,So,Co).call(this);return new Promise(((r,a)=>{Mo(this,xo,Bo(this,xo)+1),Bo(this,To).set(Bo(this,xo),{resolve:r,reject:a,timeout:setTimeout((()=>{Bo(this,To).delete(Bo(this,xo)),a(Error("Request timeout: "+e))}),this.options.callTimeout)}),n?.addEventListener("abort",(()=>{Bo(this,To).delete(Bo(this,xo)),a(n.reason)})),s.send(JSON.stringify({jsonrpc:"2.0",id:Bo(this,xo),method:e,params:t}))})).then((({error:e,result:t})=>{if(e)throw new wo(e.message,e.code);return t}))}async subscribe(e){const t=new Ro(e);return Bo(this,Po).add(t),await t.subscribe(this),()=>t.unsubscribe(this)}}xo=new WeakMap,ko=new WeakMap,Io=new WeakMap,Eo=new WeakMap,Po=new WeakMap,To=new WeakMap,So=new WeakSet,Co=function(){return Bo(this,Eo)||Mo(this,Eo,new Promise((e=>{Bo(this,Io)?.close(),Mo(this,Io,new this.options.WebSocketConstructor(this.endpoint)),Bo(this,Io).addEventListener("open",(()=>{Mo(this,ko,0),e(Bo(this,Io))})),Bo(this,Io).addEventListener("close",(()=>{var e,t,n;(e=this,t=ko,{set _(n){Mo(e,t,n)},get _(){return Bo(e,t,n)}})._++,Bo(this,ko)>this.options.maxReconnects||setTimeout((()=>{$o(this,So,Oo).call(this)}),this.options.reconnectTimeout)})),Bo(this,Io).addEventListener("message",(({data:e})=>{let t;try{t=JSON.parse(e)}catch(e){return}if("id"in t&&null!=t.id&&Bo(this,To).has(t.id)){const{resolve:e,timeout:n}=Bo(this,To).get(t.id);clearTimeout(n),e(t)}else if("params"in t){const{params:e}=t;Bo(this,Po).forEach((t=>{t.subscriptionId===e.subscription&&e.subscription===t.subscriptionId&&t.onMessage(e.result)}))}}))}))),Bo(this,Eo)},Oo=async function(){return Bo(this,Io)?.close(),Mo(this,Eo,null),Promise.allSettled([...Bo(this,Po)].map((e=>e.subscribe(this))))};class Ro{constructor(e){this.subscriptionId=null,this.subscribed=!1,this.input=e}onMessage(e){this.subscribed&&this.input.onMessage(e)}async unsubscribe(e){const{subscriptionId:t}=this;return this.subscribed=!1,null!=t&&(this.subscriptionId=null,e.makeRequest(this.input.unsubscribe,[t]))}async subscribe(e){this.subscriptionId=null,this.subscribed=!0;const t=await e.makeRequest(this.input.method,this.input.params,this.input.signal);this.subscribed&&(this.subscriptionId=t)}}var Fo,Lo,No,Go,_o,Vo=e=>{throw TypeError(e)},qo=(e,t,n)=>t.has(e)||Vo("Cannot "+n),Wo=(e,t,n)=>(qo(e,t,"read from private field"),n?n.call(e):t.get(e)),Ho=(e,t,n)=>t.has(e)?Vo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ko=(e,t,n,s)=>(qo(e,t,"write to private field"),t.set(e,n),n);class Jo{constructor(e){Ho(this,Go),Ho(this,Fo,0),Ho(this,Lo),Ho(this,No),Ko(this,Lo,e)}fetch(e,t){const n=Wo(this,Lo).fetch??fetch;if(!n)throw Error("The current environment does not support fetch, you can provide a fetch implementation in the options for SuiHTTPTransport.");return n(e,t)}async request(e){Ko(this,Fo,Wo(this,Fo)+1);const t=await this.fetch(Wo(this,Lo).rpc?.url??Wo(this,Lo).url,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json","Client-Sdk-Type":"typescript","Client-Sdk-Version":"1.30.2","Client-Target-Api-Version":"1.50.0","Client-Request-Method":e.method,...Wo(this,Lo).rpc?.headers},body:JSON.stringify({jsonrpc:"2.0",id:Wo(this,Fo),method:e.method,params:e.params})});if(!t.ok)throw new vo("Unexpected status code: "+t.status,t.status,t.statusText);const n=await t.json();if("error"in n&&null!=n.error)throw new wo(n.error.message,n.error.code);return n.result}async subscribe(e){const t=await(n=this,s=Go,r=_o,qo(n,s,"access private method"),r).call(this).subscribe(e);var n,s,r;return e.signal&&(e.signal.throwIfAborted(),e.signal.addEventListener("abort",(()=>{t()}))),async()=>!!await t()}}Fo=new WeakMap,Lo=new WeakMap,No=new WeakMap,Go=new WeakSet,_o=function(){if(!Wo(this,No)){const e=Wo(this,Lo).WebSocketConstructor??WebSocket;if(!e)throw Error("The current environment does not support WebSocket, you can provide a WebSocketConstructor in the options for SuiHTTPTransport.");Ko(this,No,new Do(Wo(this,Lo).websocket?.url??Wo(this,Lo).url,{WebSocketConstructor:e,...Wo(this,Lo).websocket}))}return Wo(this,No)};var Zo,Xo,Yo=e=>{throw TypeError(e)},Qo=(e,t,n)=>t.has(e)||Yo("Cannot "+n),ec=(e,t,n)=>(Qo(e,t,"read from private field"),t.get(e)),tc=(e,t,n)=>t.has(e)?Yo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),nc=(e,t,n,s)=>(Qo(e,t,"write to private field"),t.set(e,n),n);Zo=new WeakMap,Xo=new WeakMap;let sc=class e{constructor({prefix:e,cache:t}={}){tc(this,Zo),tc(this,Xo),nc(this,Zo,e??[]),nc(this,Xo,t??new Map)}read(e,t){const n=[ec(this,Zo),...e].join(":");if(ec(this,Xo).has(n))return ec(this,Xo).get(n);const s=t();return ec(this,Xo).set(n,s),"object"==typeof s&&null!==s&&"then"in s?Promise.resolve(s).then((e=>(ec(this,Xo).set(n,e),e))).catch((e=>{throw ec(this,Xo).delete(n),e})):s}clear(e){const t=[...ec(this,Zo),...e??[]].join(":");if(t)for(const e of ec(this,Xo).keys())e.startsWith(t)&&ec(this,Xo).delete(e);else ec(this,Xo).clear()}scope(t){return new e({prefix:[...ec(this,Zo),...Array.isArray(t)?t:[t]],cache:ec(this,Xo)})}};class rc{constructor({network:e}){this.cache=new sc,this.network=e}$extend(...e){return Object.create(this,Object.fromEntries(e.map((e=>{if("experimental_asClientExtension"in e){const{name:t,register:n}=e.experimental_asClientExtension();return[t,{value:n(this)}]}return[e.name,{value:e.register(this)}]}))))}}function ac(e){const t=typeof e;return"string"===t?`"${e}"`:"number"===t||"bigint"===t||"boolean"===t?""+e:"object"===t||"function"===t?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function ic(e,t,n,s,r){const a=r&&"input"in r?r.input:n.value,i=r?.expected??e.expects??null,o=r?.received??ac(a),c={kind:e.kind,type:e.type,input:a,expected:i,received:o,message:`Invalid ${t}: ${i?`Expected ${i} but r`:"R"}eceived ${o}`,requirement:e.requirement,path:r?.path,issues:r?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},u="schema"===e.kind,l=r?.message??e.message??void 0??(u?void 0:null)??s.message??void 0;l&&(c.message="function"==typeof l?l(c):l),u&&(n.typed=!1),n.issues?n.issues.push(c):n.issues=[c]}function oc(e,t){return Object.hasOwn(e,t)&&"__proto__"!==t&&"prototype"!==t&&"constructor"!==t}var cc=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function uc(e,t){return{kind:"validation",type:"check",reference:uc,async:!1,expects:null,requirement:e,message:t,_run(e,t){return e.typed&&!this.requirement(e.value)&&ic(this,"input",e,t),e}}}function lc(e){return{kind:"validation",type:"integer",reference:lc,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(e,t){return e.typed&&!this.requirement(e.value)&&ic(this,"integer",e,t),e}}}function dc(e){return{kind:"transformation",type:"transform",reference:dc,async:!1,operation:e,_run(e){return e.value=this.operation(e.value),e}}}function hc(e,t,n){return"function"==typeof e.default?e.default(t,n):e.default}function pc(e,t){return!e._run({typed:!1,value:t},{abortEarly:!0}).issues}function mc(e,t){return{kind:"schema",type:"array",reference:mc,expects:"Array",async:!1,item:e,message:t,_run(e,t){const n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(let s=0;n.length>s;s++){const r=n[s],a=this.item._run({typed:!1,value:r},t);if(a.issues){const i={type:"array",origin:"value",input:n,key:s,value:r};for(const t of a.issues)t.path?t.path.unshift(i):t.path=[i],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}a.typed||(e.typed=!1),e.value.push(a.value)}}else ic(this,"type",e,t);return e}}}function gc(e){return{kind:"schema",type:"bigint",reference:gc,expects:"bigint",async:!1,message:e,_run(e,t){return"bigint"==typeof e.value?e.typed=!0:ic(this,"type",e,t),e}}}function fc(e){return{kind:"schema",type:"boolean",reference:fc,expects:"boolean",async:!1,message:e,_run(e,t){return"boolean"==typeof e.value?e.typed=!0:ic(this,"type",e,t),e}}}function yc(e){return{kind:"schema",type:"lazy",reference:yc,expects:"unknown",async:!1,getter:e,_run(e,t){return this.getter(e.value)._run(e,t)}}}function bc(e,t){return{kind:"schema",type:"literal",reference:bc,expects:ac(e),async:!1,literal:e,message:t,_run(e,t){return e.value===this.literal?e.typed=!0:ic(this,"type",e,t),e}}}function wc(e,...t){const n={kind:"schema",type:"nullable",reference:wc,expects:e.expects+" | null",async:!1,wrapped:e,_run(e,t){return null===e.value&&("default"in this&&(e.value=hc(this,e,t)),null===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function vc(e,...t){const n={kind:"schema",type:"nullish",reference:vc,expects:e.expects+" | null | undefined",async:!1,wrapped:e,_run(e,t){return null==e.value&&("default"in this&&(e.value=hc(this,e,t)),null==e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function xc(e){return{kind:"schema",type:"number",reference:xc,expects:"number",async:!1,message:e,_run(e,t){return"number"!=typeof e.value||isNaN(e.value)?ic(this,"type",e,t):e.typed=!0,e}}}function kc(e,t){return{kind:"schema",type:"object",reference:kc,expects:"Object",async:!1,entries:e,message:t,_run(e,t){const n=e.value;if(n&&"object"==typeof n){e.typed=!0,e.value={};for(const s in this.entries){const r=n[s],a=this.entries[s]._run({typed:!1,value:r},t);if(a.issues){const i={type:"object",origin:"value",input:n,key:s,value:r};for(const t of a.issues)t.path?t.path.unshift(i):t.path=[i],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}a.typed||(e.typed=!1),(void 0!==a.value||s in n)&&(e.value[s]=a.value)}}else ic(this,"type",e,t);return e}}}function Ic(e,...t){const n={kind:"schema",type:"optional",reference:Ic,expects:e.expects+" | undefined",async:!1,wrapped:e,_run(e,t){return void 0===e.value&&("default"in this&&(e.value=hc(this,e,t)),void 0===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function Ec(e,t,n){return{kind:"schema",type:"record",reference:Ec,expects:"Object",async:!1,key:e,value:t,message:n,_run(e,t){const n=e.value;if(n&&"object"==typeof n){e.typed=!0,e.value={};for(const s in n)if(oc(n,s)){const r=n[s],a=this.key._run({typed:!1,value:s},t);if(a.issues){const i={type:"object",origin:"key",input:n,key:s,value:r};for(const t of a.issues)t.path=[i],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}const i=this.value._run({typed:!1,value:r},t);if(i.issues){const a={type:"object",origin:"value",input:n,key:s,value:r};for(const t of i.issues)t.path?t.path.unshift(a):t.path=[a],e.issues?.push(t);if(e.issues||(e.issues=i.issues),t.abortEarly){e.typed=!1;break}}a.typed&&i.typed||(e.typed=!1),a.typed&&(e.value[a.value]=i.value)}}else ic(this,"type",e,t);return e}}}function Pc(e){return{kind:"schema",type:"string",reference:Pc,expects:"string",async:!1,message:e,_run(e,t){return"string"==typeof e.value?e.typed=!0:ic(this,"type",e,t),e}}}function Tc(e,t){return{kind:"schema",type:"tuple",reference:Tc,expects:"Array",async:!1,items:e,message:t,_run(e,t){const n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(let s=0;this.items.length>s;s++){const r=n[s],a=this.items[s]._run({typed:!1,value:r},t);if(a.issues){const i={type:"array",origin:"value",input:n,key:s,value:r};for(const t of a.issues)t.path?t.path.unshift(i):t.path=[i],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}a.typed||(e.typed=!1),e.value.push(a.value)}}else ic(this,"type",e,t);return e}}}function Sc(e){let t;if(e)for(const n of e)t?t.push(...n.issues):t=n.issues;return t}function Cc(e,t){return{kind:"schema",type:"union",reference:Cc,expects:[...new Set(e.map((e=>e.expects)))].join(" | ")||"never",async:!1,options:e,message:t,_run(e,t){let n,s,r;for(const a of this.options){const i=a._run({typed:!1,value:e.value},t);if(i.typed){if(!i.issues){n=i;break}s?s.push(i):s=[i]}else r?r.push(i):r=[i]}if(n)return n;if(s){if(1===s.length)return s[0];ic(this,"type",e,t,{issues:Sc(s)}),e.typed=!0}else{if(1===r?.length)return r[0];ic(this,"type",e,t,{issues:Sc(r)})}return e}}}function Oc(){return{kind:"schema",type:"unknown",reference:Oc,expects:"unknown",async:!1,_run:e=>(e.typed=!0,e)}}function jc(e,t,n){const s=e._run({typed:!1,value:t},function(e){return{lang:e?.lang??void 0,message:e?.message,abortEarly:e?.abortEarly??void 0,abortPipeEarly:e?.abortPipeEarly??void 0}}(n));if(s.issues)throw new cc(s.issues);return s.value}function Ac(...e){return{...e[0],pipe:e,_run(t,n){for(let s=0;e.length>s;s++){if(t.issues&&("schema"===e[s].kind||"transformation"===e[s].kind)){t.typed=!1;break}t.issues&&(n.abortEarly||n.abortPipeEarly)||(t=e[s]._run(t,n))}return t}}}function Bc(e){return Ac(Cc(Object.entries(e).map((([e,t])=>kc({[e]:t})))),dc((e=>({...e,$kind:Object.keys(e)[0]}))))}const Uc=Ac(Pc(),dc((e=>$a(e))),uc(Aa)),Mc=Uc,$c=Pc(),zc=Ac(Cc([Pc(),Ac(xc(),lc())]),uc((e=>{try{return BigInt(e),BigInt(e)>=0&&18446744073709551615n>=BigInt(e)}catch{return!1}}),"Invalid u64")),Dc=kc({objectId:Uc,version:zc,digest:Pc()}),Rc=Ac(Cc([kc({GasCoin:bc(!0)}),kc({Input:Ac(xc(),lc()),type:Ic(bc("pure"))}),kc({Input:Ac(xc(),lc()),type:Ic(bc("object"))}),kc({Result:Ac(xc(),lc())}),kc({NestedResult:Tc([Ac(xc(),lc()),Ac(xc(),lc())])})]),dc((e=>({...e,$kind:Object.keys(e)[0]})))),Fc=kc({budget:wc(zc),price:wc(zc),owner:wc(Uc),payment:wc(mc(Dc))}),Lc=Cc([bc("address"),bc("bool"),bc("u8"),bc("u16"),bc("u32"),bc("u64"),bc("u128"),bc("u256"),kc({vector:yc((()=>Lc))}),kc({datatype:kc({package:Pc(),module:Pc(),type:Pc(),typeParameters:mc(yc((()=>Lc)))})}),kc({typeParameter:Ac(xc(),lc())})]),Nc=kc({ref:wc(Cc([bc("&"),bc("&mut")])),body:Lc}),Gc=kc({package:Mc,module:Pc(),function:Pc(),typeArguments:mc(Pc()),arguments:mc(Rc),_argumentTypes:Ic(wc(mc(Nc)))}),_c=kc({name:Pc(),inputs:Ec(Pc(),Cc([Rc,mc(Rc)])),data:Ec(Pc(),Oc())}),Vc=Bc({MoveCall:Gc,TransferObjects:kc({objects:mc(Rc),address:Rc}),SplitCoins:kc({coin:Rc,amounts:mc(Rc)}),MergeCoins:kc({destination:Rc,sources:mc(Rc)}),Publish:kc({modules:mc($c),dependencies:mc(Mc)}),MakeMoveVec:kc({type:wc(Pc()),elements:mc(Rc)}),Upgrade:kc({modules:mc($c),dependencies:mc(Mc),package:Mc,ticket:Rc}),$Intent:_c}),qc=Bc({ImmOrOwnedObject:Dc,SharedObject:kc({objectId:Mc,initialSharedVersion:zc,mutable:fc()}),Receiving:Dc}),Wc=Bc({Object:qc,Pure:kc({bytes:$c}),UnresolvedPure:kc({value:Oc()}),UnresolvedObject:kc({objectId:Mc,version:Ic(wc(zc)),digest:Ic(wc(Pc())),initialSharedVersion:Ic(wc(zc))})}),Hc=Bc({Object:qc,Pure:kc({bytes:$c})}),Kc=Bc({None:bc(!0),Epoch:zc}),Jc=kc({version:bc(2),sender:vc(Uc),expiration:vc(Kc),gasData:Fc,inputs:mc(Wc),commands:mc(Vc)}),Zc={MoveCall(e){const[t,n="",s=""]="target"in e?e.target.split("::"):[e.package,e.module,e.function];return{$kind:"MoveCall",MoveCall:{package:t,module:n,function:s,typeArguments:e.typeArguments??[],arguments:e.arguments??[]}}},TransferObjects:(e,t)=>({$kind:"TransferObjects",TransferObjects:{objects:e.map((e=>jc(Rc,e))),address:jc(Rc,t)}}),SplitCoins:(e,t)=>({$kind:"SplitCoins",SplitCoins:{coin:jc(Rc,e),amounts:t.map((e=>jc(Rc,e)))}}),MergeCoins:(e,t)=>({$kind:"MergeCoins",MergeCoins:{destination:jc(Rc,e),sources:t.map((e=>jc(Rc,e)))}}),Publish:({modules:e,dependencies:t})=>({$kind:"Publish",Publish:{modules:e.map((e=>"string"==typeof e?e:ea(new Uint8Array(e)))),dependencies:t.map((e=>za(e)))}}),Upgrade:({modules:e,dependencies:t,package:n,ticket:s})=>({$kind:"Upgrade",Upgrade:{modules:e.map((e=>"string"==typeof e?e:ea(new Uint8Array(e)))),dependencies:t.map((e=>za(e))),package:n,ticket:jc(Rc,s)}}),MakeMoveVec:({type:e,elements:t})=>({$kind:"MakeMoveVec",MakeMoveVec:{type:e??null,elements:t.map((e=>jc(Rc,e)))}}),Intent:({name:e,inputs:t={},data:n={}})=>({$kind:"$Intent",$Intent:{name:e,inputs:Object.fromEntries(Object.entries(t).map((([e,t])=>[e,Array.isArray(t)?t.map((e=>jc(Rc,e))):jc(Rc,t)]))),data:n}})},Xc=kc({digest:Pc(),objectId:Pc(),version:Cc([Ac(xc(),lc()),Pc(),gc()])}),Yc=Bc({ImmOrOwned:Xc,Shared:kc({objectId:Mc,initialSharedVersion:zc,mutable:fc()}),Receiving:Xc}),Qc=Bc({Object:Yc,Pure:mc(Ac(xc(),lc()))}),eu=Cc([kc({kind:bc("Input"),index:Ac(xc(),lc()),value:Oc(),type:Ic(bc("object"))}),kc({kind:bc("Input"),index:Ac(xc(),lc()),value:Oc(),type:bc("pure")})]),tu=Cc([kc({Epoch:Ac(xc(),lc())}),kc({None:wc(bc(!0))})]),nu=Ac(Cc([xc(),Pc(),gc()]),uc((e=>{if(!["string","number","bigint"].includes(typeof e))return!1;try{return BigInt(e),!0}catch{return!1}}))),su=Cc([kc({bool:wc(bc(!0))}),kc({u8:wc(bc(!0))}),kc({u64:wc(bc(!0))}),kc({u128:wc(bc(!0))}),kc({address:wc(bc(!0))}),kc({signer:wc(bc(!0))}),kc({vector:yc((()=>su))}),kc({struct:yc((()=>ru))}),kc({u16:wc(bc(!0))}),kc({u32:wc(bc(!0))}),kc({u256:wc(bc(!0))})]),ru=kc({address:Pc(),module:Pc(),name:Pc(),typeParams:mc(su)}),au=kc({budget:Ic(nu),price:Ic(nu),payment:Ic(mc(Xc)),owner:Ic(Pc())}),iu=Cc([...[eu,kc({kind:bc("GasCoin")}),kc({kind:bc("Result"),index:Ac(xc(),lc())}),kc({kind:bc("NestedResult"),index:Ac(xc(),lc()),resultIndex:Ac(xc(),lc())})]]),ou=kc({kind:bc("MoveCall"),target:Ac(Pc(),uc((e=>3===e.split("::").length))),typeArguments:mc(Pc()),arguments:mc(iu)}),cu=kc({kind:bc("TransferObjects"),objects:mc(iu),address:iu}),uu=kc({kind:bc("SplitCoins"),coin:iu,amounts:mc(iu)}),lu=kc({kind:bc("MergeCoins"),destination:iu,sources:mc(iu)}),du=kc({kind:bc("MakeMoveVec"),type:Cc([kc({Some:su}),kc({None:wc(bc(!0))})]),objects:mc(iu)}),hu=Cc([...[ou,cu,uu,lu,kc({kind:bc("Publish"),modules:mc(mc(Ac(xc(),lc()))),dependencies:mc(Pc())}),kc({kind:bc("Upgrade"),modules:mc(mc(Ac(xc(),lc()))),dependencies:mc(Pc()),packageId:Pc(),ticket:iu}),du]]);function pu(e){const t=e.inputs.map(((e,t)=>{if(e.Object)return{kind:"Input",index:t,value:{Object:e.Object.ImmOrOwnedObject?{ImmOrOwned:e.Object.ImmOrOwnedObject}:e.Object.Receiving?{Receiving:{digest:e.Object.Receiving.digest,version:e.Object.Receiving.version,objectId:e.Object.Receiving.objectId}}:{Shared:{mutable:e.Object.SharedObject.mutable,initialSharedVersion:e.Object.SharedObject.initialSharedVersion,objectId:e.Object.SharedObject.objectId}}},type:"object"};if(e.Pure)return{kind:"Input",index:t,value:{Pure:Array.from(Yr(e.Pure.bytes))},type:"pure"};if(e.UnresolvedPure)return{kind:"Input",type:"pure",index:t,value:e.UnresolvedPure.value};if(e.UnresolvedObject)return{kind:"Input",type:"object",index:t,value:e.UnresolvedObject.objectId};throw Error("Invalid input")}));return{version:1,sender:e.sender??void 0,expiration:"Epoch"===e.expiration?.$kind?{Epoch:Number(e.expiration.Epoch)}:e.expiration?{None:!0}:null,gasConfig:{owner:e.gasData.owner??void 0,budget:e.gasData.budget??void 0,price:e.gasData.price??void 0,payment:e.gasData.payment??void 0},inputs:t,transactions:e.commands.map((e=>{if(e.MakeMoveVec)return{kind:"MakeMoveVec",type:null===e.MakeMoveVec.type?{None:!0}:{Some:Ka.parseFromStr(e.MakeMoveVec.type)},objects:e.MakeMoveVec.elements.map((e=>mu(e,t)))};if(e.MergeCoins)return{kind:"MergeCoins",destination:mu(e.MergeCoins.destination,t),sources:e.MergeCoins.sources.map((e=>mu(e,t)))};if(e.MoveCall)return{kind:"MoveCall",target:`${e.MoveCall.package}::${e.MoveCall.module}::${e.MoveCall.function}`,typeArguments:e.MoveCall.typeArguments,arguments:e.MoveCall.arguments.map((e=>mu(e,t)))};if(e.Publish)return{kind:"Publish",modules:e.Publish.modules.map((e=>Array.from(Yr(e)))),dependencies:e.Publish.dependencies};if(e.SplitCoins)return{kind:"SplitCoins",coin:mu(e.SplitCoins.coin,t),amounts:e.SplitCoins.amounts.map((e=>mu(e,t)))};if(e.TransferObjects)return{kind:"TransferObjects",objects:e.TransferObjects.objects.map((e=>mu(e,t))),address:mu(e.TransferObjects.address,t)};if(e.Upgrade)return{kind:"Upgrade",modules:e.Upgrade.modules.map((e=>Array.from(Yr(e)))),dependencies:e.Upgrade.dependencies,packageId:e.Upgrade.package,ticket:mu(e.Upgrade.ticket,t)};throw Error("Unknown transaction "+Object.keys(e))}))}}function mu(e,t){if("GasCoin"===e.$kind)return{kind:"GasCoin"};if("Result"===e.$kind)return{kind:"Result",index:e.Result};if("NestedResult"===e.$kind)return{kind:"NestedResult",index:e.NestedResult[0],resultIndex:e.NestedResult[1]};if("Input"===e.$kind)return t[e.Input];throw Error("Invalid argument "+Object.keys(e))}function gu(e){switch(e.kind){case"GasCoin":return{GasCoin:!0};case"Result":return{Result:e.index};case"NestedResult":return{NestedResult:[e.index,e.resultIndex]};case"Input":return{Input:e.index}}}function fu(e){return Cc(Object.entries(e).map((([e,t])=>kc({[e]:t}))))}kc({version:bc(1),sender:Ic(Pc()),expiration:vc(tu),gasConfig:au,inputs:mc(eu),transactions:mc(hu)});const yu=fu({GasCoin:bc(!0),Input:Ac(xc(),lc()),Result:Ac(xc(),lc()),NestedResult:Tc([Ac(xc(),lc()),Ac(xc(),lc())])}),bu=kc({budget:wc(zc),price:wc(zc),owner:wc(Uc),payment:wc(mc(Dc))}),wu=kc({package:Mc,module:Pc(),function:Pc(),typeArguments:mc(Pc()),arguments:mc(yu)}),vu=kc({name:Pc(),inputs:Ec(Pc(),Cc([yu,mc(yu)])),data:Ec(Pc(),Oc())}),xu=fu({MoveCall:wu,TransferObjects:kc({objects:mc(yu),address:yu}),SplitCoins:kc({coin:yu,amounts:mc(yu)}),MergeCoins:kc({destination:yu,sources:mc(yu)}),Publish:kc({modules:mc($c),dependencies:mc(Mc)}),MakeMoveVec:kc({type:wc(Pc()),elements:mc(yu)}),Upgrade:kc({modules:mc($c),dependencies:mc(Mc),package:Mc,ticket:yu}),$Intent:vu}),ku=fu({ImmOrOwnedObject:Dc,SharedObject:kc({objectId:Mc,initialSharedVersion:zc,mutable:fc()}),Receiving:Dc}),Iu=fu({Object:ku,Pure:kc({bytes:$c}),UnresolvedPure:kc({value:Oc()}),UnresolvedObject:kc({objectId:Mc,version:Ic(wc(zc)),digest:Ic(wc(Pc())),initialSharedVersion:Ic(wc(zc))})}),Eu=fu({None:bc(!0),Epoch:zc}),Pu=kc({version:bc(2),sender:vc(Uc),expiration:vc(Eu),gasData:bu,inputs:mc(Iu),commands:mc(xu)});const Tu={Pure:function(e){return{$kind:"Pure",Pure:{bytes:e instanceof Uint8Array?ea(e):e.toBase64()}}},ObjectRef:({objectId:e,digest:t,version:n})=>({$kind:"Object",Object:{$kind:"ImmOrOwnedObject",ImmOrOwnedObject:{digest:t,version:n,objectId:$a(e)}}}),SharedObjectRef:({objectId:e,mutable:t,initialSharedVersion:n})=>({$kind:"Object",Object:{$kind:"SharedObject",SharedObject:{mutable:t,initialSharedVersion:n,objectId:$a(e)}}}),ReceivingRef:({objectId:e,digest:t,version:n})=>({$kind:"Object",Object:{$kind:"Receiving",Receiving:{digest:t,version:n,objectId:$a(e)}}})};async function Su(e,t,n){if(function(e){for(const t of e.commands)switch(t.$kind){case"SplitCoins":t.SplitCoins.amounts.forEach((t=>{Ou(t,Ki.U64,e)}));break;case"TransferObjects":Ou(t.TransferObjects.address,Ki.Address,e)}}(e),!function(e,t){return!!e.inputs.some((e=>e.UnresolvedObject||e.UnresolvedPure))||!(t.onlyTransactionKind||e.gasConfig.price&&e.gasConfig.budget&&e.gasConfig.payment)}(e,t))return await Cu(e),n();const s=function(e){if(!e.client)throw Error("No sui client passed to Transaction#build, but transaction data was not sufficient to build offline.");return e.client}(t);return s.core.resolveTransactionPlugin()(e,t,(async()=>{await Cu(e),await n()}))}function Cu(e){e.inputs.forEach(((e,t)=>{if("Object"!==e.$kind&&"Pure"!==e.$kind)throw Error(`Input at index ${t} has not been resolved.  Expected a Pure or Object input, but found ${JSON.stringify(e)}`)}))}function Ou(e,t,n){if("Input"!==e.$kind)return;const s=n.inputs[e.Input];"UnresolvedPure"===s.$kind&&(n.inputs[e.Input]=Tu.Pure(t.serialize(s.UnresolvedPure.value)))}function ju(e){function t(t,n){if("string"==typeof t)return e(Hi(t).serialize(n));if(t instanceof Uint8Array||wa(t))return e(t);throw Error("tx.pure must be called either a bcs type name, or a serialized bcs value")}return t.u8=t=>e(Ki.U8.serialize(t)),t.u16=t=>e(Ki.U16.serialize(t)),t.u32=t=>e(Ki.U32.serialize(t)),t.u64=t=>e(Ki.U64.serialize(t)),t.u128=t=>e(Ki.U128.serialize(t)),t.u256=t=>e(Ki.U256.serialize(t)),t.bool=t=>e(Ki.Bool.serialize(t)),t.string=t=>e(Ki.String.serialize(t)),t.id=t.address=t=>e(Ki.Address.serialize(t)),t.vector=(t,n)=>e(Ki.vector(Hi(t)).serialize(n)),t.option=(t,n)=>e(Ki.option(Hi(t)).serialize(n)),t}function Au(e){return $a(e).replace("0x","")}class Bu{constructor(e){this.version=2,this.sender=e?.sender??null,this.expiration=e?.expiration??null,this.inputs=e?.inputs??[],this.commands=e?.commands??[],this.gasData=e?.gasData??{budget:null,price:null,owner:null,payment:null}}static fromKindBytes(e){const t=Ki.TransactionKind.parse(e).ProgrammableTransaction;if(!t)throw Error("Unable to deserialize from bytes.");return Bu.restore({version:2,sender:null,expiration:null,gasData:{budget:null,owner:null,payment:null,price:null},inputs:t.inputs,commands:t.commands})}static fromBytes(e){const t=Ki.TransactionData.parse(e),n=t?.V1,s=n.kind.ProgrammableTransaction;if(!n||!s)throw Error("Unable to deserialize from bytes.");return Bu.restore({version:2,sender:n.sender,expiration:n.expiration,gasData:n.gasData,inputs:s.inputs,commands:s.commands})}static restore(e){return new Bu(jc(Jc,2===e.version?e:function(e){return jc(Jc,{version:2,sender:e.sender??null,expiration:e.expiration?"Epoch"in e.expiration?{Epoch:e.expiration.Epoch}:{None:!0}:null,gasData:{owner:e.gasConfig.owner??null,budget:e.gasConfig.budget?.toString()??null,price:e.gasConfig.price?.toString()??null,payment:e.gasConfig.payment?.map((e=>({digest:e.digest,objectId:e.objectId,version:""+e.version})))??null},inputs:e.inputs.map((e=>{if("Input"===e.kind){if(pc(Qc,e.value)){const t=jc(Qc,e.value);if(t.Object){if(t.Object.ImmOrOwned)return{Object:{ImmOrOwnedObject:{objectId:t.Object.ImmOrOwned.objectId,version:t.Object.ImmOrOwned.version+"",digest:t.Object.ImmOrOwned.digest}}};if(t.Object.Shared)return{Object:{SharedObject:{mutable:t.Object.Shared.mutable??null,initialSharedVersion:t.Object.Shared.initialSharedVersion,objectId:t.Object.Shared.objectId}}};if(t.Object.Receiving)return{Object:{Receiving:{digest:t.Object.Receiving.digest,version:t.Object.Receiving.version+"",objectId:t.Object.Receiving.objectId}}};throw Error("Invalid object input")}return{Pure:{bytes:ea(new Uint8Array(t.Pure))}}}return"object"===e.type?{UnresolvedObject:{objectId:e.value}}:{UnresolvedPure:{value:e.value}}}throw Error("Invalid input")})),commands:e.transactions.map((e=>{switch(e.kind){case"MakeMoveVec":return{MakeMoveVec:{type:"Some"in e.type?Ka.tagToString(e.type.Some):null,elements:e.objects.map((e=>gu(e)))}};case"MergeCoins":return{MergeCoins:{destination:gu(e.destination),sources:e.sources.map((e=>gu(e)))}};case"MoveCall":{const[t,n,s]=e.target.split("::");return{MoveCall:{package:t,module:n,function:s,typeArguments:e.typeArguments,arguments:e.arguments.map((e=>gu(e)))}}}case"Publish":return{Publish:{modules:e.modules.map((e=>ea(Uint8Array.from(e)))),dependencies:e.dependencies}};case"SplitCoins":return{SplitCoins:{coin:gu(e.coin),amounts:e.amounts.map((e=>gu(e)))}};case"TransferObjects":return{TransferObjects:{objects:e.objects.map((e=>gu(e))),address:gu(e.address)}};case"Upgrade":return{Upgrade:{modules:e.modules.map((e=>ea(Uint8Array.from(e)))),dependencies:e.dependencies,package:e.packageId,ticket:gu(e.ticket)}}}throw Error("Unknown transaction "+Object.keys(e))}))})}(e)))}static getDigestFromBytes(e){const t=function(e,t){const n=Array.from(e+"::").map((e=>e.charCodeAt(0))),s=new Uint8Array(n.length+t.length);return s.set(n),s.set(t,n.length),qa(s,{dkLen:32})}("TransactionData",e);return Zr(t)}get gasConfig(){return this.gasData}set gasConfig(e){this.gasData=e}build({maxSizeBytes:e=1/0,overrides:t,onlyTransactionKind:n}={}){const s=this.inputs,r=this.commands;if(n)return Ki.TransactionKind.serialize({ProgrammableTransaction:{inputs:s,commands:r}},{maxSize:e}).toBytes();const a=t?.expiration??this.expiration,i=t?.sender??this.sender,o={...this.gasData,...t?.gasConfig,...t?.gasData};if(!i)throw Error("Missing transaction sender");if(!o.budget)throw Error("Missing gas budget");if(!o.payment)throw Error("Missing gas payment");if(!o.price)throw Error("Missing gas price");const c={sender:Au(i),expiration:a||{None:!0},gasData:{payment:o.payment,owner:Au(this.gasData.owner??i),price:BigInt(o.price),budget:BigInt(o.budget)},kind:{ProgrammableTransaction:{inputs:s,commands:r}}};return Ki.TransactionData.serialize({V1:c},{maxSize:e}).toBytes()}addInput(e,t){const n=this.inputs.length;return this.inputs.push(t),{Input:n,type:e,$kind:"Input"}}getInputUses(e,t){this.mapArguments(((n,s)=>("Input"===n.$kind&&n.Input===e&&t(n,s),n)))}mapCommandArguments(e,t){const n=this.commands[e];switch(n.$kind){case"MoveCall":n.MoveCall.arguments=n.MoveCall.arguments.map((s=>t(s,n,e)));break;case"TransferObjects":n.TransferObjects.objects=n.TransferObjects.objects.map((s=>t(s,n,e))),n.TransferObjects.address=t(n.TransferObjects.address,n,e);break;case"SplitCoins":n.SplitCoins.coin=t(n.SplitCoins.coin,n,e),n.SplitCoins.amounts=n.SplitCoins.amounts.map((s=>t(s,n,e)));break;case"MergeCoins":n.MergeCoins.destination=t(n.MergeCoins.destination,n,e),n.MergeCoins.sources=n.MergeCoins.sources.map((s=>t(s,n,e)));break;case"MakeMoveVec":n.MakeMoveVec.elements=n.MakeMoveVec.elements.map((s=>t(s,n,e)));break;case"Upgrade":n.Upgrade.ticket=t(n.Upgrade.ticket,n,e);break;case"$Intent":const s=n.$Intent.inputs;n.$Intent.inputs={};for(const[r,a]of Object.entries(s))n.$Intent.inputs[r]=Array.isArray(a)?a.map((s=>t(s,n,e))):t(a,n,e);break;case"Publish":break;default:throw Error("Unexpected transaction kind: "+n.$kind)}}mapArguments(e){for(const t of this.commands.keys())this.mapCommandArguments(t,e)}replaceCommand(e,t,n=e){if(!Array.isArray(t))return void(this.commands[e]=t);const s=t.length-1;this.commands.splice(e,1,...t),0!==s&&this.mapArguments(((r,a,i)=>{if(e+t.length>i)return r;switch(r.$kind){case"Result":r.Result===e&&(r.Result=n),r.Result>e&&(r.Result+=s);break;case"NestedResult":r.NestedResult[0]===e&&(r.NestedResult[0]=n),r.NestedResult[0]>e&&(r.NestedResult[0]+=s)}return r}))}getDigest(){const e=this.build({onlyTransactionKind:!1});return Bu.getDigestFromBytes(e)}snapshot(){return jc(Jc,this)}shallowClone(){return new Bu({version:this.version,sender:this.sender,expiration:this.expiration,gasData:{...this.gasData},inputs:[...this.inputs],commands:[...this.commands]})}}function Uu(e){return"string"==typeof e?$a(e):e.Object?$a(e.Object.ImmOrOwnedObject?e.Object.ImmOrOwnedObject.objectId:e.Object.Receiving?e.Object.Receiving.objectId:e.Object.SharedObject.objectId):e.UnresolvedObject?$a(e.UnresolvedObject.objectId):void 0}var Mu,$u,zu,Du,Ru,Fu,Lu,Nu,Gu,_u,Vu,qu,Wu,Hu,Ku,Ju,Zu,Xu,Yu,Qu=e=>{throw TypeError(e)},el=(e,t,n)=>t.has(e)||Qu("Cannot "+n),tl=(e,t,n)=>(el(e,t,"read from private field"),n?n.call(e):t.get(e)),nl=(e,t,n)=>t.has(e)?Qu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),sl=(e,t,n,s)=>(el(e,t,"write to private field"),t.set(e,n),n),rl=(e,t,n)=>(el(e,t,"access private method"),n);function al(e,t=1/0){const n=[],s=t=>n[t]??(n[t]={$kind:"NestedResult",NestedResult:[e,t]});return new Proxy({$kind:"Result",Result:e},{set(){throw Error("The transaction result is a proxy, and does not support setting properties directly")},get(e,n){if(n in e)return Reflect.get(e,n);if(n===Symbol.iterator)return function*(){let e=0;for(;t>e;)yield s(e),e++};if("symbol"==typeof n)return;const r=parseInt(n,10);return Number.isNaN(r)||0>r?void 0:s(r)}})}const il=Symbol.for("@mysten/transaction");function ol(e){return!!e&&"object"==typeof e&&!0===e[il]}const cl={buildPlugins:new Map,serializationPlugins:new Map},ul=Symbol.for("@mysten/transaction/registry");function ll(){try{const e=globalThis;return e[ul]||(e[ul]=cl),e[ul]}catch(e){return cl}}const dl=class e{constructor(){nl(this,_u),nl(this,Mu),nl(this,$u),nl(this,zu,new Map),nl(this,Du,[]),nl(this,Ru,[]),nl(this,Fu,new Set),nl(this,Lu,new Set),nl(this,Nu,new Map),nl(this,Gu),this.object=function(e){function t(t){return e(t)}return t.system=()=>t("0x5"),t.clock=()=>t("0x6"),t.random=()=>t("0x8"),t.denyList=()=>t("0x403"),t.option=({type:e,value:t})=>n=>n.moveCall({typeArguments:[e],target:"0x1::option::"+(null===t?"none":"some"),arguments:null===t?[]:[n.object(t)]}),t}((e=>{if("function"==typeof e)return this.object(this.add(e));if("object"==typeof e&&pc(Rc,e))return e;const t=Uu(e),n=tl(this,Gu).inputs.find((e=>t===Uu(e)));return n?.Object?.SharedObject&&"object"==typeof e&&e.Object?.SharedObject&&(n.Object.SharedObject.mutable=n.Object.SharedObject.mutable||e.Object.SharedObject.mutable),n?{$kind:"Input",Input:tl(this,Gu).inputs.indexOf(n),type:"object"}:rl(this,_u,Wu).call(this,"object","string"==typeof e?{$kind:"UnresolvedObject",UnresolvedObject:{objectId:$a(e)}}:e)}));const e=ll();sl(this,Gu,new Bu),sl(this,$u,[...e.buildPlugins.values()]),sl(this,Mu,[...e.serializationPlugins.values()])}static fromKind(t){const n=new e;return sl(n,Gu,Bu.fromKindBytes("string"==typeof t?Yr(t):t)),sl(n,Du,tl(n,Gu).inputs.slice()),sl(n,Ru,tl(n,Gu).commands.slice()),n}static from(t){const n=new e;return ol(t)?sl(n,Gu,new Bu(t.getData())):"string"==typeof t&&t.startsWith("{")?sl(n,Gu,Bu.restore(JSON.parse(t))):sl(n,Gu,Bu.fromBytes("string"==typeof t?Yr(t):t)),sl(n,Du,tl(n,Gu).inputs.slice()),sl(n,Ru,tl(n,Gu).commands.slice()),n}static registerGlobalSerializationPlugin(e,t){ll().serializationPlugins.set(e,t??e)}static unregisterGlobalSerializationPlugin(e){ll().serializationPlugins.delete(e)}static registerGlobalBuildPlugin(e,t){ll().buildPlugins.set(e,t??e)}static unregisterGlobalBuildPlugin(e){ll().buildPlugins.delete(e)}addSerializationPlugin(e){tl(this,Mu).push(e)}addBuildPlugin(e){tl(this,$u).push(e)}addIntentResolver(e,t){if(tl(this,zu).has(e)&&tl(this,zu).get(e)!==t)throw Error(`Intent resolver for ${e} already exists`);tl(this,zu).set(e,t)}setSender(e){tl(this,Gu).sender=e}setSenderIfNotSet(e){tl(this,Gu).sender||(tl(this,Gu).sender=e)}setExpiration(e){tl(this,Gu).expiration=e?jc(Kc,e):null}setGasPrice(e){tl(this,Gu).gasConfig.price=e+""}setGasBudget(e){tl(this,Gu).gasConfig.budget=e+""}setGasBudgetIfNotSet(e){null==tl(this,Gu).gasData.budget&&(tl(this,Gu).gasConfig.budget=e+"")}setGasOwner(e){tl(this,Gu).gasConfig.owner=e}setGasPayment(e){tl(this,Gu).gasConfig.payment=e.map((e=>jc(Dc,e)))}get blockData(){return pu(tl(this,Gu).snapshot())}getData(){return tl(this,Gu).snapshot()}get[il](){return!0}get pure(){return Object.defineProperty(this,"pure",{enumerable:!1,value:ju((e=>wa(e)?rl(this,_u,Wu).call(this,"pure",{$kind:"Pure",Pure:{bytes:e.toBase64()}}):rl(this,_u,Wu).call(this,"pure",pc(Hc,e)?jc(Hc,e):e instanceof Uint8Array?Tu.Pure(e):{$kind:"UnresolvedPure",UnresolvedPure:{value:e}})))}),this.pure}get gas(){return{$kind:"GasCoin",GasCoin:!0}}objectRef(...e){return this.object(Tu.ObjectRef(...e))}receivingRef(...e){return this.object(Tu.ReceivingRef(...e))}sharedObjectRef(...e){return this.object(Tu.SharedObjectRef(...e))}add(e){if("function"==typeof e){if(tl(this,Nu).has(e))return tl(this,Nu).get(e);const t=rl(this,_u,Vu).call(this),n=e(t);if(!n||"object"!=typeof n||!("then"in n))return sl(this,Fu,tl(t,Fu)),tl(this,Nu).set(e,n),n;const s=rl(this,_u,qu).call(this,{$kind:"$Intent",$Intent:{name:"AsyncTransactionThunk",inputs:{},data:{result:null}}});tl(this,Lu).add(Promise.resolve(n).then((e=>{s.$Intent.data.result=e})));const r=al(tl(this,Gu).commands.length-1);return tl(this,Nu).set(e,r),r}return rl(this,_u,qu).call(this,e),al(tl(this,Gu).commands.length-1)}splitCoins(e,t){const n=Zc.SplitCoins("string"==typeof e?this.object(e):rl(this,_u,Ku).call(this,e),t.map((e=>"number"==typeof e||"bigint"==typeof e||"string"==typeof e?this.pure.u64(e):rl(this,_u,Hu).call(this,e))));return rl(this,_u,qu).call(this,n),al(tl(this,Gu).commands.length-1,t.length)}mergeCoins(e,t){return this.add(Zc.MergeCoins(this.object(e),t.map((e=>this.object(e)))))}publish({modules:e,dependencies:t}){return this.add(Zc.Publish({modules:e,dependencies:t}))}upgrade({modules:e,dependencies:t,package:n,ticket:s}){return this.add(Zc.Upgrade({modules:e,dependencies:t,package:n,ticket:this.object(s)}))}moveCall({arguments:e,...t}){return this.add(Zc.MoveCall({...t,arguments:e?.map((e=>rl(this,_u,Hu).call(this,e)))}))}transferObjects(e,t){return this.add(Zc.TransferObjects(e.map((e=>this.object(e))),"string"==typeof t?this.pure.address(t):rl(this,_u,Hu).call(this,t)))}makeMoveVec({type:e,elements:t}){return this.add(Zc.MakeMoveVec({type:e,elements:t.map((e=>this.object(e)))}))}serialize(){return JSON.stringify(pu(tl(this,Gu).snapshot()))}async toJSON(e={}){return await this.prepareForSerialization(e),JSON.stringify(jc(Pu,tl(this,Gu).snapshot()),((e,t)=>"bigint"==typeof t?""+t:t),2)}async sign(e){const{signer:t,...n}=e,s=await this.build(n);return t.signTransaction(s)}async build(e={}){return await this.prepareForSerialization(e),await rl(this,_u,Ju).call(this,e),tl(this,Gu).build({onlyTransactionKind:e.onlyTransactionKind})}async getDigest(e={}){return await rl(this,_u,Ju).call(this,e),tl(this,Gu).getDigest()}async prepareForSerialization(e){await rl(this,_u,Xu).call(this),rl(this,_u,Yu).call(this);const t=new Set;for(const e of tl(this,Gu).commands)e.$Intent&&t.add(e.$Intent.name);const n=[...tl(this,Mu)];for(const s of t)if(!e.supportedIntents?.includes(s)){if(!tl(this,zu).has(s))throw Error("Missing intent resolver for "+s);n.push(tl(this,zu).get(s))}await rl(this,_u,Zu).call(this,n,e)}};Mu=new WeakMap,$u=new WeakMap,zu=new WeakMap,Du=new WeakMap,Ru=new WeakMap,Fu=new WeakMap,Lu=new WeakMap,Nu=new WeakMap,Gu=new WeakMap,_u=new WeakSet,Vu=function(){const e=new dl;return sl(e,Gu,tl(this,Gu)),sl(e,Mu,tl(this,Mu)),sl(e,$u,tl(this,$u)),sl(e,zu,tl(this,zu)),sl(e,Lu,tl(this,Lu)),sl(e,Fu,new Set(tl(this,Fu))),sl(e,Nu,tl(this,Nu)),tl(this,Du).push(tl(e,Du)),tl(this,Ru).push(tl(e,Ru)),e},qu=function(e){const t=tl(this,Gu).commands.length;return tl(this,Ru).push(e),tl(this,Fu).add(t),tl(this,Gu).commands.push(e),tl(this,Gu).mapCommandArguments(t,(e=>{if("Result"===e.$kind&&!tl(this,Fu).has(e.Result))throw Error(`Result { Result: ${e.Result} } is not available to use the current transaction`);if("NestedResult"===e.$kind&&!tl(this,Fu).has(e.NestedResult[0]))throw Error(`Result { NestedResult: [${e.NestedResult[0]}, ${e.NestedResult[1]}] } is not available to use the current transaction`);if("Input"===e.$kind&&e.Input>=tl(this,Gu).inputs.length)throw Error(`Input { Input: ${e.Input} } references an input that does not exist in the current transaction`);return e})),e},Wu=function(e,t){return tl(this,Du).push(t),tl(this,Gu).addInput(e,t)},Hu=function(e){return wa(e)?this.pure(e):rl(this,_u,Ku).call(this,e)},Ku=function(e){if("function"==typeof e){const t=this.add(e);return"function"==typeof t?rl(this,_u,Ku).call(this,t):jc(Rc,t)}return jc(Rc,e)},Ju=async function(e){if(!e.onlyTransactionKind&&!tl(this,Gu).sender)throw Error("Missing transaction sender");await rl(this,_u,Zu).call(this,[...tl(this,$u),Su],e)},Zu=async function(e,t){const n=s=>{if(s>=e.length)return()=>{};const r=e[s];return async()=>{const e=n(s+1);let a=!1,i=!1;if(await r(tl(this,Gu),t,(async()=>{if(a)throw Error("next() was call multiple times in TransactionPlugin "+s);a=!0,await e(),i=!0})),!a)throw Error("next() was not called in TransactionPlugin "+s);if(!i)throw Error("next() was not awaited in TransactionPlugin "+s)}};await n(0)(),sl(this,Du,tl(this,Gu).inputs.slice()),sl(this,Ru,tl(this,Gu).commands.slice())},Xu=async function(){for(;tl(this,Lu).size>0;){const e=Promise.all(tl(this,Lu));tl(this,Lu).clear(),tl(this,Lu).add(e),await e,tl(this,Lu).delete(e)}},Yu=function(){const e=tl(this,Gu).commands,t=tl(this,Gu).inputs,n=tl(this,Ru).flat(1/0),s=tl(this,Du).flat(1/0);if(n.length!==e.length)throw Error("Unexpected number of commands found in transaction data");if(s.length!==t.length)throw Error("Unexpected number of inputs found in transaction data");const r=n.filter((e=>"AsyncTransactionThunk"!==e.$Intent?.name));function a(t){const n=e[t];if("AsyncTransactionThunk"===n.$Intent?.name){const e=n.$Intent.data.result;if(null==e)throw Error("AsyncTransactionThunk has not been resolved");return a(e.Result)}const s=r.indexOf(n);if(-1===s)throw Error("Unable to find original index for command");return s}tl(this,Gu).commands=r,tl(this,Gu).inputs=s,sl(this,Ru,r),sl(this,Du,s),tl(this,Gu).mapArguments((e=>{if("Input"===e.$kind){const n=s.indexOf(t[e.Input]);if(-1===n)throw Error("Input has not been resolved");return{...e,Input:n}}if("Result"===e.$kind){const t=a(e.Result);return{...e,Result:t}}if("NestedResult"===e.$kind){const t=a(e.NestedResult[0]);return{...e,NestedResult:[t,e.NestedResult[1]]}}return e}))};let hl=dl;class pl extends rc{constructor(){super(...arguments),this.core=this}async getObject(e){const{objectId:t}=e,{objects:[n]}=await this.getObjects({objectIds:[t],signal:e.signal});if(n instanceof Error)throw n;return{object:n}}async getDynamicField(e){const t=function(e,t,n){const s=Ki.Address.serialize(e).toBytes(),r=Ki.TypeTag.serialize(t).toBytes(),a=Ki.u64().serialize(n.length).toBytes(),i=qa.create({dkLen:32});return i.update(new Uint8Array([240])),i.update(s),i.update(a),i.update(n),i.update(r),"0x"+na(i.digest().slice(0,32))}(e.parentId,Ka.parseFromStr(e.name.type),e.name.bcs),{objects:[n]}=await this.getObjects({objectIds:[t],signal:e.signal});if(n instanceof Error)throw n;const s=Ua(n.type);return{dynamicField:{id:n.id,digest:n.digest,version:n.version,type:n.type,name:{type:"string"==typeof s.typeParams[0]?s.typeParams[0]:Ma(s.typeParams[0]),bcs:e.name.bcs},value:{type:"string"==typeof s.typeParams[1]?s.typeParams[1]:Ma(s.typeParams[1]),bcs:n.content.slice(32+e.name.bcs.length)}}}}async waitForTransaction({signal:e,timeout:t=6e4,...n}){const s=e?AbortSignal.any([AbortSignal.timeout(t),e]):AbortSignal.timeout(t),r=new Promise(((e,t)=>{s.addEventListener("abort",(()=>t(s.reason)))}));for(r.catch((()=>{}));;){s.throwIfAborted();try{return await this.getTransaction({...n,signal:s})}catch(e){await Promise.race([new Promise((e=>setTimeout(e,2e3))),r])}}}}class ml extends Error{}class gl extends ml{constructor(e,t){super(t),this.code=e}static fromResponse(e,t){switch(e.code){case"notExists":return new gl(e.code,`Object ${e.object_id} does not exist`);case"dynamicFieldNotFound":return new gl(e.code,"Dynamic field not found for object "+e.parent_object_id);case"deleted":return new gl(e.code,`Object ${e.object_id} has been deleted`);case"displayError":return new gl(e.code,"Display error: "+e.error);default:return new gl(e.code,"Unknown error while loading object"+(t?" "+t:""))}}}function fl(e){if("string"==typeof e)switch(e){case"address":return Ki.Address;case"bool":return Ki.Bool;case"u8":return Ki.U8;case"u16":return Ki.U16;case"u32":return Ki.U32;case"u64":return Ki.U64;case"u128":return Ki.U128;case"u256":return Ki.U256;default:throw Error("Unknown type signature "+e)}if("vector"in e){if("u8"===e.vector)return Ki.vector(Ki.U8).transform({input:e=>"string"==typeof e?(new TextEncoder).encode(e):e,output:e=>e});const t=fl(e.vector);return t?Ki.vector(t):null}if("datatype"in e){const t=$a(e.datatype.package);if(t===$a("0x1")){if("ascii"===e.datatype.module&&"String"===e.datatype.type)return Ki.String;if("string"===e.datatype.module&&"String"===e.datatype.type)return Ki.String;if("option"===e.datatype.module&&"Option"===e.datatype.type){const t=fl(e.datatype.typeParameters[0]);return t?Ki.vector(t):null}}if(t===$a("0x2")&&"object"===e.datatype.module&&"ID"===e.datatype.type)return Ki.Address}return null}function yl(e){if("string"==typeof e)switch(e){case"Address":return"address";case"Bool":return"bool";case"U8":return"u8";case"U16":return"u16";case"U32":return"u32";case"U64":return"u64";case"U128":return"u128";case"U256":return"u256";default:throw Error("Unexpected type "+e)}if("Vector"in e)return{vector:yl(e.Vector)};if("Struct"in e)return{datatype:{package:e.Struct.address,module:e.Struct.module,type:e.Struct.name,typeParameters:e.Struct.typeArguments.map(yl)}};if("TypeParameter"in e)return{typeParameter:e.TypeParameter};throw Error("Unexpected type "+JSON.stringify(e))}function bl(e){const t=Ki.TransactionEffects.parse(e);switch(t.$kind){case"V1":return function(){throw Error("V1 effects are not supported yet")}();case"V2":return function({bytes:e,effects:t}){const n=t.changedObjects.map((([e,n])=>({id:e,inputState:"Exist"===n.inputState.$kind?"Exists":"DoesNotExist",inputVersion:n.inputState.Exist?.[0][0]??null,inputDigest:n.inputState.Exist?.[0][1]??null,inputOwner:n.inputState.Exist?.[1]??null,outputState:"NotExist"===n.outputState.$kind?"DoesNotExist":n.outputState.$kind,outputVersion:"PackageWrite"===n.outputState.$kind?n.outputState.PackageWrite?.[0]:n.outputState.ObjectWrite?t.lamportVersion:null,outputDigest:"PackageWrite"===n.outputState.$kind?n.outputState.PackageWrite?.[1]:n.outputState.ObjectWrite?.[0]??null,outputOwner:n.outputState.ObjectWrite?n.outputState.ObjectWrite[1]:null,idOperation:n.idOperation.$kind})));return{bcs:e,digest:t.transactionDigest,version:2,status:"Success"===t.status.$kind?{success:!0,error:null}:{success:!1,error:t.status.Failed.error.$kind},gasUsed:t.gasUsed,transactionDigest:t.transactionDigest,gasObject:null===t.gasObjectIndex?null:n[t.gasObjectIndex]??null,eventsDigest:t.eventsDigest,dependencies:t.dependencies,lamportVersion:t.lamportVersion,changedObjects:n,unchangedSharedObjects:t.unchangedSharedObjects.map((([e,t])=>({kind:t.$kind,objectId:e,version:"ReadOnlyRoot"===t.$kind?t.ReadOnlyRoot[0]:t[t.$kind],digest:"ReadOnlyRoot"===t.$kind?t.ReadOnlyRoot[1]:null}))),auxiliaryDataDigest:t.auxDataDigest}}({bytes:e,effects:t.V2});default:throw Error("Unknown transaction effects version: "+t.$kind)}}const wl=5e10;function vl(e){return async function(t,n,s){return await async function(e,t){const{inputs:n,commands:s}=e,r=[],a=new Set;s.forEach((t=>{if(t.MoveCall){if(t.MoveCall._argumentTypes)return;if(t.MoveCall.arguments.map((t=>"Input"===t.$kind?e.inputs[t.Input]:null)).some((e=>e?.UnresolvedPure||e?.UnresolvedObject))){a.add(`${t.MoveCall.package}::${t.MoveCall.module}::${t.MoveCall.function}`),r.push(t.MoveCall)}}}));const i=new Map;a.size>0&&await Promise.all([...a].map((async e=>{const[n,s,r]=e.split("::"),a=await t.getNormalizedMoveFunction({package:n,module:s,function:r});i.set(e,a.parameters.map((e=>function(e){return"object"==typeof e&&"Reference"in e?{ref:"&",body:yl(e.Reference)}:"object"==typeof e&&"MutableReference"in e?{ref:"&mut",body:yl(e.MutableReference)}:{ref:null,body:yl(e)}}(e))))})));r.length&&await Promise.all(r.map((async e=>{const t=i.get(`${e.package}::${e.module}::${e.function}`);if(!t)return;const n=t.length>0&&function(e){const t="object"==typeof e.body&&"datatype"in e.body?e.body.datatype:null;return!!t&&$a(t.package)===$a("0x2")&&"tx_context"===t.module&&"TxContext"===t.type}(t.at(-1))?t.slice(0,t.length-1):t;e._argumentTypes=n})));s.forEach((e=>{if(!e.MoveCall)return;const t=e.MoveCall,s=t._argumentTypes;if(s){if(s.length!==e.MoveCall.arguments.length)throw Error("Incorrect number of arguments for "+`${t.package}::${t.module}::${t.function}`);s.forEach(((e,s)=>{const r=t.arguments[s];if("Input"!==r.$kind)return;const a=n[r.Input];if(!a.UnresolvedPure&&!a.UnresolvedObject)return;const i=a.UnresolvedPure?.value??a.UnresolvedObject?.objectId,o=fl(e.body);if(o)return r.type="pure",void(n[n.indexOf(a)]=Tu.Pure(o.serialize(i)));if("string"!=typeof i)throw Error("Expect the argument to be an object id string, got "+JSON.stringify(i,null,2));r.type="object";n[r.Input]=a.UnresolvedPure?{$kind:"UnresolvedObject",UnresolvedObject:{objectId:i}}:a}))}}))}(t,e),await async function(e,t){const n=e.inputs.filter((e=>e.UnresolvedObject&&!(e.UnresolvedObject.version||e.UnresolvedObject?.initialSharedVersion))),s=[...new Set(n.map((e=>za(e.UnresolvedObject.objectId))))],r=s.length?function(e,t){return Array.from({length:Math.ceil(e.length/t)},((n,s)=>e.slice(s*t,(s+1)*t)))}(s,50):[],a=(await Promise.all(r.map((e=>t.multiGetObjects({ids:e,options:{showOwner:!0}}))))).flat(),i=new Map(s.map(((e,t)=>[e,a[t]]))),o=Array.from(i).filter((([e,t])=>t.error)).map((([e,t])=>JSON.stringify(t.error)));if(o.length)throw Error("The following input objects are invalid: "+o.join(", "));const c=a.map((e=>{if(e.error||!e.data)throw Error("Failed to fetch object: "+e.error);const t=e.data.owner;return{objectId:e.data.objectId,digest:e.data.digest,version:e.data.version,initialSharedVersion:t&&"object"==typeof t&&"Shared"in t?t.Shared.initial_shared_version:null}})),u=new Map(s.map(((e,t)=>[e,c[t]])));for(const[t,n]of e.inputs.entries()){if(!n.UnresolvedObject)continue;let s;const r=$a(n.UnresolvedObject.objectId),a=u.get(r);n.UnresolvedObject.initialSharedVersion??a?.initialSharedVersion?s=Tu.SharedObjectRef({objectId:r,initialSharedVersion:n.UnresolvedObject.initialSharedVersion||a?.initialSharedVersion,mutable:xl(e,t)}):kl(e,t)&&(s=Tu.ReceivingRef({objectId:r,digest:n.UnresolvedObject.digest??a?.digest,version:n.UnresolvedObject.version??a?.version})),e.inputs[e.inputs.indexOf(n)]=s??Tu.ObjectRef({objectId:r,digest:n.UnresolvedObject.digest??a?.digest,version:n.UnresolvedObject.version??a?.version})}}(t,e),n.onlyTransactionKind||(await async function(e,t){e.gasConfig.price||(e.gasConfig.price=await t.getReferenceGasPrice()+"")}(t,e),await async function(e,t){if(e.gasConfig.budget)return;const n=await t.dryRunTransactionBlock({transactionBlock:e.build({overrides:{gasData:{budget:wl+"",payment:[]}}})});if("success"!==n.effects.status.status)throw Error("Dry run failed, could not automatically determine a budget: "+n.effects.status.error,{cause:n});const s=1000n*BigInt(e.gasConfig.price||1n),r=BigInt(n.effects.gasUsed.computationCost)+s,a=r+BigInt(n.effects.gasUsed.storageCost)-BigInt(n.effects.gasUsed.storageRebate);e.gasConfig.budget=(a>r?a:r)+""}(t,e),await async function(e,t){if(!e.gasConfig.payment){const n=(await t.getCoins({owner:e.gasConfig.owner||e.sender,coinType:Da})).data.filter((t=>!e.inputs.find((e=>!!e.Object?.ImmOrOwnedObject&&t.coinObjectId===e.Object.ImmOrOwnedObject.objectId)))).map((e=>({objectId:e.coinObjectId,digest:e.digest,version:e.version})));if(!n.length)throw Error("No valid gas coins found for the transaction.");e.gasConfig.payment=n.map((e=>jc(Dc,e)))}}(t,e)),await s()}}function xl(e,t){let n=!1;return e.getInputUses(t,((e,t)=>{if(t.MoveCall&&t.MoveCall._argumentTypes){const s=t.MoveCall.arguments.indexOf(e);n="&"!==t.MoveCall._argumentTypes[s].ref||n}"MakeMoveVec"!==t.$kind&&"MergeCoins"!==t.$kind&&"SplitCoins"!==t.$kind||(n=!0)})),n}function kl(e,t){let n=!1;return e.getInputUses(t,((e,t)=>{if(t.MoveCall&&t.MoveCall._argumentTypes){const s=t.MoveCall.arguments.indexOf(e);n=function(e){if("object"!=typeof e.body||!("datatype"in e.body))return!1;return"0x2"===e.body.datatype.package&&"transfer"===e.body.datatype.module&&"Receiving"===e.body.datatype.type}(t.MoveCall._argumentTypes[s])||n}})),n}var Il,El=e=>{throw TypeError(e)},Pl=(e,t,n)=>t.has(e)||El("Cannot "+n),Tl=(e,t,n)=>(Pl(e,t,"read from private field"),n?n.call(e):t.get(e));class Sl extends pl{constructor(e){var t,n,s;super({network:e.network}),(n=Il).has(t=this)?El("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(t):n.set(t,s),((e,t,n)=>{Pl(e,t,"write to private field"),t.set(e,n)})(this,Il,e)}async getObjects(e){const t=function(e,t){const n=[];for(let s=0;e.length>s;s+=t)n.push(e.slice(s,s+t));return n}(e.objectIds,50),n=[];for(const s of t){const t=await Tl(this,Il).multiGetObjects({ids:s,options:{showOwner:!0,showType:!0,showBcs:!0},signal:e.signal});for(const[e,r]of t.entries())n.push(r.error?gl.fromResponse(r.error,s[e]):Cl(r.data))}return{objects:n}}async getOwnedObjects(e){const t=await Tl(this,Il).getOwnedObjects({owner:e.address,limit:e.limit,cursor:e.cursor,options:{showOwner:!0,showType:!0,showBcs:!0},signal:e.signal});return{objects:t.data.map((e=>{if(e.error)throw gl.fromResponse(e.error);return Cl(e.data)})),hasNextPage:t.hasNextPage,cursor:t.nextCursor??null}}async getCoins(e){const t=await Tl(this,Il).getCoins({owner:e.address,coinType:e.coinType,limit:e.limit,cursor:e.cursor,signal:e.signal});return{objects:t.data.map((t=>({id:t.coinObjectId,version:t.version,digest:t.digest,balance:t.balance,type:`0x2::coin::Coin<${t.coinType}>`,content:Bl.serialize({id:t.coinObjectId,balance:{value:t.balance}}).toBytes(),owner:{$kind:"ObjectOwner",ObjectOwner:e.address}}))),hasNextPage:t.hasNextPage,cursor:t.nextCursor??null}}async getBalance(e){const t=await Tl(this,Il).getBalance({owner:e.address,coinType:e.coinType,signal:e.signal});return{balance:{coinType:t.coinType,balance:t.totalBalance}}}async getAllBalances(e){return{balances:(await Tl(this,Il).getAllBalances({owner:e.address,signal:e.signal})).map((e=>({coinType:e.coinType,balance:e.totalBalance}))),hasNextPage:!1,cursor:null}}async getTransaction(e){return{transaction:jl(await Tl(this,Il).getTransactionBlock({digest:e.digest,options:{showRawInput:!0,showObjectChanges:!0,showRawEffects:!0,showEvents:!0},signal:e.signal}))}}async executeTransaction(e){return{transaction:jl(await Tl(this,Il).executeTransactionBlock({transactionBlock:e.transaction,signature:e.signatures,options:{showRawEffects:!0,showEvents:!0,showObjectChanges:!0,showRawInput:!0},signal:e.signal}))}}async dryRunTransaction(e){const t=hl.from(e.transaction),n=await Tl(this,Il).dryRunTransactionBlock({transactionBlock:e.transaction,signal:e.signal}),{effects:s,objectTypes:r}=function({bytes:e,effects:t,objectChanges:n}){const s=[],r=[],a={};return n?.forEach((e=>{switch(e.type){case"published":s.push({id:e.packageId,inputState:"DoesNotExist",inputVersion:null,inputDigest:null,inputOwner:null,outputState:"PackageWrite",outputVersion:e.version,outputDigest:e.digest,outputOwner:null,idOperation:"Created"});break;case"transferred":s.push({id:e.objectId,inputState:"Exists",inputVersion:e.version,inputDigest:e.digest,inputOwner:{$kind:"AddressOwner",AddressOwner:e.sender},outputState:"ObjectWrite",outputVersion:e.version,outputDigest:e.digest,outputOwner:Ol(e.recipient),idOperation:"None"}),a[e.objectId]=e.objectType;break;case"mutated":s.push({id:e.objectId,inputState:"Exists",inputVersion:e.previousVersion,inputDigest:null,inputOwner:Ol(e.owner),outputState:"ObjectWrite",outputVersion:e.version,outputDigest:e.digest,outputOwner:Ol(e.owner),idOperation:"None"}),a[e.objectId]=e.objectType;break;case"deleted":s.push({id:e.objectId,inputState:"Exists",inputVersion:e.version,inputDigest:t.deleted?.find((t=>t.objectId===e.objectId))?.digest??null,inputOwner:null,outputState:"DoesNotExist",outputVersion:null,outputDigest:null,outputOwner:null,idOperation:"Deleted"}),a[e.objectId]=e.objectType;break;case"wrapped":s.push({id:e.objectId,inputState:"Exists",inputVersion:e.version,inputDigest:null,inputOwner:{$kind:"AddressOwner",AddressOwner:e.sender},outputState:"ObjectWrite",outputVersion:e.version,outputDigest:t.wrapped?.find((t=>t.objectId===e.objectId))?.digest??null,outputOwner:{$kind:"ObjectOwner",ObjectOwner:e.sender},idOperation:"None"}),a[e.objectId]=e.objectType;break;case"created":s.push({id:e.objectId,inputState:"DoesNotExist",inputVersion:null,inputDigest:null,inputOwner:null,outputState:"ObjectWrite",outputVersion:e.version,outputDigest:e.digest,outputOwner:Ol(e.owner),idOperation:"Created"}),a[e.objectId]=e.objectType}})),{objectTypes:a,effects:{bcs:e??null,digest:t.transactionDigest,version:2,status:"success"===t.status.status?{success:!0,error:null}:{success:!1,error:t.status.error},gasUsed:t.gasUsed,transactionDigest:t.transactionDigest,gasObject:{id:t.gasObject?.reference.objectId,inputState:"Exists",inputVersion:null,inputDigest:null,inputOwner:null,outputState:"ObjectWrite",outputVersion:t.gasObject.reference.version,outputDigest:t.gasObject.reference.digest,outputOwner:Ol(t.gasObject.owner),idOperation:"None"},eventsDigest:t.eventsDigest??null,dependencies:t.dependencies??[],lamportVersion:t.gasObject.reference.version,changedObjects:s,unchangedSharedObjects:r,auxiliaryDataDigest:null}}}({effects:n.effects,objectChanges:n.objectChanges});return{transaction:{digest:await t.getDigest(),epoch:null,effects:s,objectTypes:Promise.resolve(r),signatures:[],transaction:(a=e.transaction,{...Bu.fromBytes(a).snapshot(),bcs:a})}};var a}async getReferenceGasPrice(e){return{referenceGasPrice:await Tl(this,Il).getReferenceGasPrice({signal:e?.signal})+""}}async getDynamicFields(e){const t=await Tl(this,Il).getDynamicFields({parentId:e.parentId,limit:e.limit,cursor:e.cursor});return{dynamicFields:t.data.map((e=>({id:e.objectId,type:e.objectType,name:{type:e.name.type,bcs:Yr(e.bcsName)}}))),hasNextPage:t.hasNextPage,cursor:t.nextCursor}}async verifyZkLoginSignature(e){const t=await Tl(this,Il).verifyZkLoginSignature({bytes:e.bytes,signature:e.signature,intentScope:e.intentScope,author:e.author});return{success:t.success,errors:t.errors}}resolveTransactionPlugin(){return vl(Tl(this,Il))}}function Cl(e){return{id:e.objectId,version:e.version,digest:e.digest,type:e.type,content:"moveObject"===e.bcs?.dataType?Yr(e.bcs.bcsBytes):new Uint8Array,owner:Ol(e.owner)}}function Ol(e){if("Immutable"===e)return{$kind:"Immutable",Immutable:!0};if("ConsensusV2"in e)return{$kind:"ConsensusV2",ConsensusV2:{authenticator:{$kind:"SingleOwner",SingleOwner:e.ConsensusV2.authenticator.SingleOwner},startVersion:e.ConsensusV2.start_version}};if("AddressOwner"in e)return{$kind:"AddressOwner",AddressOwner:e.AddressOwner};if("ObjectOwner"in e)return{$kind:"ObjectOwner",ObjectOwner:e.ObjectOwner};if("Shared"in e)return{$kind:"Shared",Shared:{initialSharedVersion:e.Shared.initial_shared_version}};throw Error("Unknown owner type: "+JSON.stringify(e))}function jl(e){const t=Ki.SenderSignedData.parse(Yr(e.rawTransaction))[0],n={};e.objectChanges?.forEach((e=>{"published"!==e.type&&(n[e.objectId]=e.objectType)}));const s=Ki.TransactionData.serialize(t.intentMessage.value).toBytes(),r=Bu.restore({version:2,sender:t.intentMessage.value.V1.sender,expiration:t.intentMessage.value.V1.expiration,gasData:t.intentMessage.value.V1.gasData,inputs:t.intentMessage.value.V1.kind.ProgrammableTransaction.inputs,commands:t.intentMessage.value.V1.kind.ProgrammableTransaction.commands});return{digest:e.digest,epoch:e.effects?.executedEpoch??null,effects:bl(new Uint8Array(e.rawEffects)),objectTypes:Promise.resolve(n),transaction:{...r,bcs:s},signatures:t.txSignatures}}Il=new WeakMap;const Al=Ki.struct("Balance",{value:Ki.u64()}),Bl=Ki.struct("Coin",{id:Ki.Address,balance:Al}),Ul=Symbol.for("@mysten/SuiClient");var Ml=Object.freeze({__proto__:null,JsonRpcError:wo,SuiClient:class extends rc{constructor(e){super({network:e.network??"unknown"}),this.core=new Sl(this),this.jsonRpc=this,this.transport=e.transport??new Jo({url:e.url})}get[Ul](){return!0}async getRpcApiVersion({signal:e}={}){return(await this.transport.request({method:"rpc.discover",params:[],signal:e})).info.version}async getCoins(e){if(!e.owner||!Aa($a(e.owner)))throw Error("Invalid Sui address");return await this.transport.request({method:"suix_getCoins",params:[e.owner,e.coinType,e.cursor,e.limit],signal:e.signal})}async getAllCoins(e){if(!e.owner||!Aa($a(e.owner)))throw Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllCoins",params:[e.owner,e.cursor,e.limit],signal:e.signal})}async getBalance(e){if(!e.owner||!Aa($a(e.owner)))throw Error("Invalid Sui address");return await this.transport.request({method:"suix_getBalance",params:[e.owner,e.coinType],signal:e.signal})}async getAllBalances(e){if(!e.owner||!Aa($a(e.owner)))throw Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllBalances",params:[e.owner],signal:e.signal})}async getCoinMetadata(e){return await this.transport.request({method:"suix_getCoinMetadata",params:[e.coinType],signal:e.signal})}async getTotalSupply(e){return await this.transport.request({method:"suix_getTotalSupply",params:[e.coinType],signal:e.signal})}async call(e,t,{signal:n}={}){return await this.transport.request({method:e,params:t,signal:n})}async getMoveFunctionArgTypes(e){return await this.transport.request({method:"sui_getMoveFunctionArgTypes",params:[e.package,e.module,e.function],signal:e.signal})}async getNormalizedMoveModulesByPackage(e){return await this.transport.request({method:"sui_getNormalizedMoveModulesByPackage",params:[e.package],signal:e.signal})}async getNormalizedMoveModule(e){return await this.transport.request({method:"sui_getNormalizedMoveModule",params:[e.package,e.module],signal:e.signal})}async getNormalizedMoveFunction(e){return await this.transport.request({method:"sui_getNormalizedMoveFunction",params:[e.package,e.module,e.function],signal:e.signal})}async getNormalizedMoveStruct(e){return await this.transport.request({method:"sui_getNormalizedMoveStruct",params:[e.package,e.module,e.struct],signal:e.signal})}async getOwnedObjects(e){if(!e.owner||!Aa($a(e.owner)))throw Error("Invalid Sui address");return await this.transport.request({method:"suix_getOwnedObjects",params:[e.owner,{filter:e.filter,options:e.options},e.cursor,e.limit],signal:e.signal})}async getObject(e){if(!e.id||!Ba(za(e.id)))throw Error("Invalid Sui Object id");return await this.transport.request({method:"sui_getObject",params:[e.id,e.options],signal:e.signal})}async tryGetPastObject(e){return await this.transport.request({method:"sui_tryGetPastObject",params:[e.id,e.version,e.options],signal:e.signal})}async multiGetObjects(e){e.ids.forEach((e=>{if(!e||!Ba(za(e)))throw Error("Invalid Sui Object id "+e)}));if(e.ids.length!==new Set(e.ids).size)throw Error("Duplicate object ids in batch call "+e.ids);return await this.transport.request({method:"sui_multiGetObjects",params:[e.ids,e.options],signal:e.signal})}async queryTransactionBlocks(e){return await this.transport.request({method:"suix_queryTransactionBlocks",params:[{filter:e.filter,options:e.options},e.cursor,e.limit,"descending"===(e.order||"descending")],signal:e.signal})}async getTransactionBlock(e){if(!ja(e.digest))throw Error("Invalid Transaction digest");return await this.transport.request({method:"sui_getTransactionBlock",params:[e.digest,e.options],signal:e.signal})}async multiGetTransactionBlocks(e){e.digests.forEach((e=>{if(!ja(e))throw Error("Invalid Transaction digest "+e)}));if(e.digests.length!==new Set(e.digests).size)throw Error("Duplicate digests in batch call "+e.digests);return await this.transport.request({method:"sui_multiGetTransactionBlocks",params:[e.digests,e.options],signal:e.signal})}async executeTransactionBlock({transactionBlock:e,signature:t,options:n,requestType:s,signal:r}){const a=await this.transport.request({method:"sui_executeTransactionBlock",params:["string"==typeof e?e:ea(e),Array.isArray(t)?t:[t],n],signal:r});if("WaitForLocalExecution"===s)try{await this.waitForTransaction({digest:a.digest})}catch(e){}return a}async signAndExecuteTransaction({transaction:e,signer:t,...n}){let s;e instanceof Uint8Array?s=e:(e.setSenderIfNotSet(t.toSuiAddress()),s=await e.build({client:this}));const{signature:r,bytes:a}=await t.signTransaction(s);return this.executeTransactionBlock({transactionBlock:a,signature:r,...n})}async getTotalTransactionBlocks({signal:e}={}){const t=await this.transport.request({method:"sui_getTotalTransactionBlocks",params:[],signal:e});return BigInt(t)}async getReferenceGasPrice({signal:e}={}){const t=await this.transport.request({method:"suix_getReferenceGasPrice",params:[],signal:e});return BigInt(t)}async getStakes(e){if(!e.owner||!Aa($a(e.owner)))throw Error("Invalid Sui address");return await this.transport.request({method:"suix_getStakes",params:[e.owner],signal:e.signal})}async getStakesByIds(e){return e.stakedSuiIds.forEach((e=>{if(!e||!Ba(za(e)))throw Error("Invalid Sui Stake id "+e)})),await this.transport.request({method:"suix_getStakesByIds",params:[e.stakedSuiIds],signal:e.signal})}async getLatestSuiSystemState({signal:e}={}){return await this.transport.request({method:"suix_getLatestSuiSystemState",params:[],signal:e})}async queryEvents(e){return await this.transport.request({method:"suix_queryEvents",params:[e.query,e.cursor,e.limit,"descending"===(e.order||"descending")],signal:e.signal})}async subscribeEvent(e){return this.transport.subscribe({method:"suix_subscribeEvent",unsubscribe:"suix_unsubscribeEvent",params:[e.filter],onMessage:e.onMessage,signal:e.signal})}async subscribeTransaction(e){return this.transport.subscribe({method:"suix_subscribeTransaction",unsubscribe:"suix_unsubscribeTransaction",params:[e.filter],onMessage:e.onMessage,signal:e.signal})}async devInspectTransactionBlock(e){let t;if(ol(e.transactionBlock))e.transactionBlock.setSenderIfNotSet(e.sender),t=ea(await e.transactionBlock.build({client:this,onlyTransactionKind:!0}));else if("string"==typeof e.transactionBlock)t=e.transactionBlock;else{if(!(e.transactionBlock instanceof Uint8Array))throw Error("Unknown transaction block format.");t=ea(e.transactionBlock)}return e.signal?.throwIfAborted(),await this.transport.request({method:"sui_devInspectTransactionBlock",params:[e.sender,t,e.gasPrice?.toString(),e.epoch],signal:e.signal})}async dryRunTransactionBlock(e){return await this.transport.request({method:"sui_dryRunTransactionBlock",params:["string"==typeof e.transactionBlock?e.transactionBlock:ea(e.transactionBlock)]})}async getDynamicFields(e){if(!e.parentId||!Ba(za(e.parentId)))throw Error("Invalid Sui Object id");return await this.transport.request({method:"suix_getDynamicFields",params:[e.parentId,e.cursor,e.limit],signal:e.signal})}async getDynamicFieldObject(e){return await this.transport.request({method:"suix_getDynamicFieldObject",params:[e.parentId,e.name],signal:e.signal})}async getLatestCheckpointSequenceNumber({signal:e}={}){return await this.transport.request({method:"sui_getLatestCheckpointSequenceNumber",params:[],signal:e})+""}async getCheckpoint(e){return await this.transport.request({method:"sui_getCheckpoint",params:[e.id],signal:e.signal})}async getCheckpoints(e){return await this.transport.request({method:"sui_getCheckpoints",params:[e.cursor,e?.limit,e.descendingOrder],signal:e.signal})}async getCommitteeInfo(e){return await this.transport.request({method:"suix_getCommitteeInfo",params:[e?.epoch],signal:e?.signal})}async getNetworkMetrics({signal:e}={}){return await this.transport.request({method:"suix_getNetworkMetrics",params:[],signal:e})}async getAddressMetrics({signal:e}={}){return await this.transport.request({method:"suix_getLatestAddressMetrics",params:[],signal:e})}async getEpochMetrics(e){return await this.transport.request({method:"suix_getEpochMetrics",params:[e?.cursor,e?.limit,e?.descendingOrder],signal:e?.signal})}async getAllEpochAddressMetrics(e){return await this.transport.request({method:"suix_getAllEpochAddressMetrics",params:[e?.descendingOrder],signal:e?.signal})}async getEpochs(e){return await this.transport.request({method:"suix_getEpochs",params:[e?.cursor,e?.limit,e?.descendingOrder],signal:e?.signal})}async getMoveCallMetrics({signal:e}={}){return await this.transport.request({method:"suix_getMoveCallMetrics",params:[],signal:e})}async getCurrentEpoch({signal:e}={}){return await this.transport.request({method:"suix_getCurrentEpoch",params:[],signal:e})}async getValidatorsApy({signal:e}={}){return await this.transport.request({method:"suix_getValidatorsApy",params:[],signal:e})}async getChainIdentifier({signal:e}={}){const t=await this.getCheckpoint({id:"0",signal:e});return na(Xr(t.digest).slice(0,4))}async resolveNameServiceAddress(e){return await this.transport.request({method:"suix_resolveNameServiceAddress",params:[e.name],signal:e.signal})}async resolveNameServiceNames({format:e="dot",...t}){const{nextCursor:n,hasNextPage:s,data:r}=await this.transport.request({method:"suix_resolveNameServiceNames",params:[t.address,t.cursor,t.limit],signal:t.signal});return{hasNextPage:s,nextCursor:n,data:r.map((t=>function(e,t="at"){const n=e.toLowerCase();let s;if(n.includes("@")){if(!Pa.test(n))throw Error("Invalid SuiNS name "+e);const[t,r]=n.split("@");s=[...t?t.split("."):[],r]}else{if(!Ta.test(n))throw Error("Invalid SuiNS name "+e);s=n.split(".").slice(0,-1)}return"dot"===t?s.join(".")+".sui":`${s.slice(0,-1).join(".")}@${s[s.length-1]}`}(t,e)))}}async getProtocolConfig(e){return await this.transport.request({method:"sui_getProtocolConfig",params:[e?.version],signal:e?.signal})}async verifyZkLoginSignature(e){return await this.transport.request({method:"sui_verifyZkLoginSignature",params:[e.bytes,e.signature,e.intentScope,e.author],signal:e.signal})}async waitForTransaction({signal:e,timeout:t=6e4,pollInterval:n=2e3,...s}){const r=AbortSignal.timeout(t),a=new Promise(((e,t)=>{r.addEventListener("abort",(()=>t(r.reason)))}));for(a.catch((()=>{}));!r.aborted;){e?.throwIfAborted();try{return await this.getTransactionBlock(s)}catch(e){await Promise.race([new Promise((e=>setTimeout(e,n))),a])}}throw r.throwIfAborted(),Error("Unexpected error while waiting for transaction block.")}experimental_asClientExtension(){return{name:"jsonRPC",register:()=>this}}},SuiHTTPStatusError:vo,SuiHTTPTransport:Jo,SuiHTTPTransportError:bo});export{xr as BASE_PROD_URL,mo as BASE_RELAY_PROD_URL,po as BASE_RELAY_TEST_URL,vr as BASE_TEST_URL,$r as BitcoinProvider,Fr as EthereumProvider,so as LoginAction,ro as MovementProvider,Lr as SolanaProvider,Yi as SuiProvider,fo as TomoSDK,Qi as TronProvider,lo as createSolTx,uo as getSolConnection,ho as parseSolTx,Pr as setHeaders};
//# sourceMappingURL=index.esm.js.map
